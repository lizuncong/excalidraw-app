"use strict";(self.webpackChunkexcalidraw_app=self.webpackChunkexcalidraw_app||[]).push([[536],{1890:function(n,e,t){t.d(e,{Z:function(){return h}});var r=t(1413),i=t(4925),a=t(9439),o=t(2791),l=t(1350),u=t(1926),c=t(4209),s=t(6571),d=(t(3659),t(184)),f=["node","inline","className","children"];var h=function(n){var e=n.src,t=(0,o.useState)(""),h=(0,a.Z)(t,2),p=h[0],m=h[1];return(0,o.useEffect)((function(){fetch(e).then((function(n){return n.text()})).then((function(n){m(n)}))}),[e]),(0,d.jsx)("div",{className:"markdown-body",children:(0,d.jsx)(l.D,{children:p,rehypePlugins:[s.Z],remarkPlugins:[u.Z],components:{code:function(n){n.node;var e=n.inline,t=n.className,a=n.children,o=(0,i.Z)(n,f),l=/language-(\w+)/.exec(t||"");return!e&&l?(0,d.jsx)(c.Z,(0,r.Z)({children:String(a).replace(/\n$/,""),language:l[1],className:"my-code",PreTag:"div"},o)):(0,d.jsx)("code",(0,r.Z)((0,r.Z)({className:t},o),{},{children:a}))}}})})}},9905:function(n,e,t){t.r(e),t.d(e,{default:function(){return w},elements:function(){return m}});var r=t(1413),i=t(2791),a=t(84),o=t(1890),l=t(6818),u=t(9439),c=t(8943),s=new WeakMap,d=function(n){s.delete(n)},f=function(n,e){m.forEach((function(t){var i=function(n){var e=s.get(n);if(e)return e;var t,i,a=document.createElement("canvas"),o=a.getContext("2d"),l=(0,c.qf)((0,r.Z)((0,r.Z)({},n),{},{points:n.points.map((function(e){return[e[0]-n.x,e[1]-n.y]}))})),d=(0,u.Z)(l,4),f=d[0],h=d[1],p=d[2],m=d[3];return a.width=(0,c.TE)(f,p)*window.devicePixelRatio+40,a.height=(0,c.TE)(h,m)*window.devicePixelRatio+40,t=n.x>f?(0,c.TE)(n.x,f)*window.devicePixelRatio:0,i=n.y>h?(0,c.TE)(n.y,h)*window.devicePixelRatio:0,o.translate(t,i),o.save(),o.translate(20,20),o.scale(window.devicePixelRatio,window.devicePixelRatio),o.lineWidth=3,o.strokeStyle=n.strokeStyle,n.points.forEach((function(e,t){var r=(0,u.Z)(e,2),i=r[0],a=r[1];i-=n.x,a-=n.y,t?o.lineTo(i,a):o.moveTo(i,a)})),o.stroke(),o.restore(),s.set(n,a),a}(t),a=(0,c.qf)((0,r.Z)((0,r.Z)({},t),{},{points:t.points.map((function(n){return[n[0]-t.x,n[1]-t.y]}))})),o=(0,u.Z)(a,4),l=o[0],d=o[1],f=o[2],h=o[3];l=Math.floor(l),f=Math.ceil(f),d=Math.floor(d),h=Math.ceil(h);var p=((l+f)/2+e.scrollX)*window.devicePixelRatio,m=((d+h)/2+e.scrollY)*window.devicePixelRatio;n.save(),n.scale(1/window.devicePixelRatio,1/window.devicePixelRatio),n.translate(p,m),n.drawImage(i,-(f-l)/2*window.devicePixelRatio-20,-(h-d)/2*window.devicePixelRatio-20,i.width,i.height),n.restore()}))},h=function(n,e){var t=n.getContext("2d");t.clearRect(0,0,n.width,n.height),f(t,e),localStorage.setItem("free-draw-elements",JSON.stringify(m))},p=t(184),m=JSON.parse(localStorage.getItem("free-draw-elements"))||[],v={offsetLeft:0,offsetTop:0,scrollX:0,scrollY:0,draggingElement:null},w=(0,i.memo)((function(){var n=(0,i.useRef)(null),e=(0,i.useRef)(null);(0,i.useEffect)((function(){var t=n.current,r=t.getContext("2d"),i=t.offsetWidth,a=t.offsetHeight,o=t.offsetLeft,l=t.offsetTop;t.width=i*window.devicePixelRatio,t.height=a*window.devicePixelRatio,r.scale(window.devicePixelRatio,window.devicePixelRatio),v.offsetLeft=o,v.offsetTop=l,h(t,v);var u=e.current,c=function(n){n.preventDefault()};return u.addEventListener("wheel",c,{passive:!1}),function(){u.removeEventListener("wheel",c)}}),[]);var t=function(e){return(0,c.$9)((function(e){var t=(0,a.dE)(e,v);v.draggingElement.points.push([t.x,t.y]),d(v.draggingElement),h(n.current,v)}))},u=function(n){return function(){console.log("appState...",v),console.log("elements...",m.map((function(n){return n.points.length}))),window.removeEventListener("pointermove",n.eventListeners.onMove),window.removeEventListener("pointerup",n.eventListeners.onUp)}};return(0,p.jsxs)("div",{className:"draw-image",children:[(0,p.jsx)("div",{className:"container",ref:e,children:(0,p.jsx)("canvas",{ref:n,className:"canvas",onPointerDown:function(n){var e=(0,a.dE)(n,v),i={origin:e,lastCoords:(0,r.Z)({},e),eventListeners:{onMove:null,onUp:null}},o={x:i.origin.x,y:i.origin.y,points:[[i.origin.x,i.origin.y]],strokeColor:"#000000",backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:(0,a.B8)()};v.draggingElement=o,d(o),m.push(o);var l=t(i),c=u(i);window.addEventListener("pointermove",l),window.addEventListener("pointerup",c),i.eventListeners.onMove=l,i.eventListeners.onUp=c},children:"\u7ed8\u5236canvas"})}),(0,p.jsx)(o.Z,{src:l})]})}))},8943:function(n,e,t){t.d(e,{$9:function(){return l},TE:function(){return c},eu:function(){return d},qf:function(){return u}});var r=t(9439),i=t(7762),a=t(3433),o=t(4164),l=function(n){return function(n,e){var t=null,r=null,i=null,o=function e(o){t=window.requestAnimationFrame((function(){t=null,n.apply(void 0,(0,a.Z)(o)),r=null,i&&(r=i,i=null,e(r))}))},l=function(){for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];r=a,null===t?o(r):null!==e&&void 0!==e&&e.trailing&&(i=a)};return l.flush=function(){null!==t&&(cancelAnimationFrame(t),t=null),r&&(n.apply(void 0,(0,a.Z)(i||r)),r=i=null)},l.cancel=function(){r=i=null,null!==t&&(cancelAnimationFrame(t),t=null)},l}((function(e){(0,o.unstable_batchedUpdates)(n,e)}))},u=function(n){var e=function(n){var e,t=1/0,a=1/0,o=-1/0,l=-1/0,u=(0,i.Z)(n);try{for(u.s();!(e=u.n()).done;){var c=(0,r.Z)(e.value,2),s=c[0],d=c[1];t=Math.min(t,s),a=Math.min(a,d),o=Math.max(o,s),l=Math.max(l,d)}}catch(f){u.e(f)}finally{u.f()}return[t,a,o,l]}(n.points),t=(0,r.Z)(e,4),a=t[0],o=t[1],l=t[2],u=t[3],c=a+n.x,s=o+n.y,d=l+n.x,f=u+n.y;return[c,s,d,f,(c+d)/2,(s+f)/2]},c=function(n,e){return Math.abs(n-e)},s=0,d=function(){return(JSON.parse(localStorage.getItem("free-draw-elements"))||[]).map((function(n){var e=n.points.map((function(e){return[e[0]-n.x,e[1]-n.y]})),t=function(n){var e=n.map((function(n){return n[0]})),t=n.map((function(n){return n[1]}));return{width:Math.max.apply(Math,(0,a.Z)(e))-Math.min.apply(Math,(0,a.Z)(e)),height:Math.max.apply(Math,(0,a.Z)(t))-Math.min.apply(Math,(0,a.Z)(t))}}(e),r=t.width,i=t.height;return{id:"id".concat(s++),type:"freedraw",x:n.x,y:n.y,width:r,height:i,angle:0,strokeColor:n.strokeStyle,backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",roughness:1,opacity:100,groupIds:[],roundness:null,seed:Math.floor(Math.random()*Math.pow(2,31)),version:1,versionNonce:0,isDeleted:!1,boundElements:null,updated:Date.now(),link:null,locked:!1,points:e,pressures:[],simulatePressure:!0,lastCommittedPoint:e[e.length-1]}}))};window.__generateExcalidrawElements=d},84:function(n,e,t){t.d(e,{$9:function(){return c},B8:function(){return u},KP:function(){return f},TE:function(){return p},dE:function(){return l},kb:function(){return v},qf:function(){return h}});var r=t(9439),i=t(7762),a=t(3433),o=t(4164),l=function(n,e){var t=n.clientX,r=n.clientY,i=e.offsetLeft,a=e.offsetTop;return{x:t-i-e.scrollX,y:r-a-e.scrollY}},u=function(){var n=Math.floor(256*Math.random()),e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random());return"rgb(".concat(n,",").concat(e,",").concat(t,")")},c=function(n){return function(n,e){var t=null,r=null,i=null,o=function e(o){t=window.requestAnimationFrame((function(){t=null,n.apply(void 0,(0,a.Z)(o)),r=null,i&&(r=i,i=null,e(r))}))},l=function(){for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];r=a,null===t?o(r):null!==e&&void 0!==e&&e.trailing&&(i=a)};return l.flush=function(){null!==t&&(cancelAnimationFrame(t),t=null),r&&(n.apply(void 0,(0,a.Z)(i||r)),r=i=null)},l.cancel=function(){r=i=null,null!==t&&(cancelAnimationFrame(t),t=null)},l}((function(e){(0,o.unstable_batchedUpdates)(n,e)}))},s=function(n){var e=1/0,t=1/0,a=-1/0,o=-1/0,l=n.points;"freedraw"===n.type&&(l=n.points.map((function(e){return[e[0]-n.x,e[1]-n.y]})));var u,c=(0,i.Z)(l);try{for(c.s();!(u=c.n()).done;){var s=(0,r.Z)(u.value,2),d=s[0],f=s[1];e=Math.min(e,d),t=Math.min(t,f),a=Math.max(a,d),o=Math.max(o,f)}}catch(h){c.e(h)}finally{c.f()}return[e,t,a,o]},d=function(n,e,t,r,i){return[(n-t)*Math.cos(i)-(e-r)*Math.sin(i)+t,(n-t)*Math.sin(i)+(e-r)*Math.cos(i)+r]},f=function(n){if(!n.length)return[0,0,0,0];var e=1/0,t=-1/0,i=1/0,a=-1/0;return n.forEach((function(n){var o=function(n){var e=h(n),t=(0,r.Z)(e,6),i=t[0],a=t[1],o=t[2],l=t[3],u=t[4],c=t[5];if("freedraw"===n.type){var f=s(n),p=(0,r.Z)(f,4),m=p[0],v=p[1],w=p[2],g=p[3];return[m+n.x,v+n.y,w+n.x,g+n.y]}var x=d(i,a,u,c,n.angle),y=(0,r.Z)(x,2),M=y[0],Z=y[1],E=d(i,l,u,c,n.angle),k=(0,r.Z)(E,2),P=k[0],S=k[1],R=d(o,l,u,c,n.angle),b=(0,r.Z)(R,2),L=b[0],C=b[1],N=d(o,a,u,c,n.angle),T=(0,r.Z)(N,2),j=T[0],A=T[1];return[Math.min(M,P,L,j),Math.min(Z,S,C,A),Math.max(M,P,L,j),Math.max(Z,S,C,A)]}(n),l=(0,r.Z)(o,4),u=l[0],c=l[1],f=l[2],p=l[3];e=Math.min(e,u),i=Math.min(i,c),t=Math.max(t,f),a=Math.max(a,p)})),[e,i,t,a]},h=function(n){if("freedraw"===n.type){var e=s(n),t=(0,r.Z)(e,4),i=t[0],a=t[1],o=t[2],l=t[3],u=i+n.x,c=a+n.y,d=o+n.x,f=l+n.y;return[u,c,d,f,(u+d)/2,(c+f)/2]}return[n.x,n.y,n.x+n.width,n.y+n.height,n.x+n.width/2,n.y+n.height/2]},p=function(n,e){return Math.abs(n-e)},m=0,v=function(){return"id".concat(m++)};window.__generateExcalidrawElements=function(){return(JSON.parse(localStorage.getItem("free-draw-elements"))||[]).map((function(n){var e=n.points.map((function(e){return[e[0]-n.x,e[1]-n.y]})),t=function(n){var e=n.map((function(n){return n[0]})),t=n.map((function(n){return n[1]}));return{width:Math.max.apply(Math,(0,a.Z)(e))-Math.min.apply(Math,(0,a.Z)(e)),height:Math.max.apply(Math,(0,a.Z)(t))-Math.min.apply(Math,(0,a.Z)(t))}}(e),r=t.width,i=t.height;return{id:v(),type:"freedraw",x:n.x,y:n.y,width:r,height:i,angle:0,strokeColor:n.strokeStyle,backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",roughness:1,opacity:100,groupIds:[],roundness:null,seed:Math.floor(Math.random()*Math.pow(2,31)),version:1,versionNonce:0,isDeleted:!1,boundElements:null,updated:Date.now(),link:null,locked:!1,points:e,pressures:[],simulatePressure:!0,lastCommittedPoint:e[e.length-1]}}))}},6818:function(n,e,t){n.exports=t.p+"static/media/\u70b9\u7a00\u91ca.31d6cfe0d16ae931b73c.md"}}]);
//# sourceMappingURL=DrawImage.f936ccf5.chunk.js.map