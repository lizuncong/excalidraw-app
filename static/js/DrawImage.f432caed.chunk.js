"use strict";(self.webpackChunkexcalidraw_app=self.webpackChunkexcalidraw_app||[]).push([[536],{1890:function(e,n,t){t.d(n,{Z:function(){return h}});var r=t(1413),i=t(4925),o=t(9439),a=t(2791),l=t(1350),u=t(1926),c=t(4209),s=t(6571),d=(t(3659),t(184)),f=["node","inline","className","children"];var h=function(e){var n=e.src,t=(0,a.useState)(""),h=(0,o.Z)(t,2),p=h[0],v=h[1];return(0,a.useEffect)((function(){fetch(n).then((function(e){return e.text()})).then((function(e){v(e)}))}),[n]),(0,d.jsx)("div",{className:"markdown-body",children:(0,d.jsx)(l.D,{children:p,rehypePlugins:[s.Z],remarkPlugins:[u.Z],components:{code:function(e){e.node;var n=e.inline,t=e.className,o=e.children,a=(0,i.Z)(e,f),l=/language-(\w+)/.exec(t||"");return!n&&l?(0,d.jsx)(c.Z,(0,r.Z)({children:String(o).replace(/\n$/,""),language:l[1],className:"my-code",PreTag:"div"},a)):(0,d.jsx)("code",(0,r.Z)((0,r.Z)({className:t},a),{},{children:o}))}}})})}},9905:function(e,n,t){t.r(n),t.d(n,{default:function(){return w},elements:function(){return v}});var r=t(1413),i=t(2791),o=t(84),a=t(1890),l=t(6818),u=t(9439),c=t(8943),s=new WeakMap,d=function(e){s.delete(e)},f=function(e,n){v.forEach((function(t){var i=function(e){var n=s.get(e);if(n)return n;var t,i,o=document.createElement("canvas"),a=o.getContext("2d"),l=(0,c.qf)((0,r.Z)((0,r.Z)({},e),{},{points:e.points.map((function(n){return[n[0]-e.x,n[1]-e.y]}))})),d=(0,u.Z)(l,4),f=d[0],h=d[1],p=d[2],v=d[3];return o.width=(0,c.TE)(f,p)*window.devicePixelRatio+40,o.height=(0,c.TE)(h,v)*window.devicePixelRatio+40,t=e.x>f?(0,c.TE)(e.x,f)*window.devicePixelRatio:0,i=e.y>h?(0,c.TE)(e.y,h)*window.devicePixelRatio:0,a.translate(t,i),a.save(),a.translate(20,20),a.scale(window.devicePixelRatio,window.devicePixelRatio),a.lineWidth=3,a.strokeStyle=e.strokeStyle,e.points.forEach((function(n,t){var r=(0,u.Z)(n,2),i=r[0],o=r[1];i-=e.x,o-=e.y,t?a.lineTo(i,o):a.moveTo(i,o)})),a.stroke(),a.restore(),s.set(e,o),o}(t),o=(0,c.qf)((0,r.Z)((0,r.Z)({},t),{},{points:t.points.map((function(e){return[e[0]-t.x,e[1]-t.y]}))})),a=(0,u.Z)(o,4),l=a[0],d=a[1],f=a[2],h=a[3];l=Math.floor(l),f=Math.ceil(f),d=Math.floor(d),h=Math.ceil(h);var p=((l+f)/2+n.scrollX)*window.devicePixelRatio,v=((d+h)/2+n.scrollY)*window.devicePixelRatio;e.save(),e.scale(1/window.devicePixelRatio,1/window.devicePixelRatio),e.translate(p,v),e.drawImage(i,-(f-l)/2*window.devicePixelRatio-20,-(h-d)/2*window.devicePixelRatio-20,i.width,i.height),e.restore()}))},h=function(e,n){var t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),f(t,n),localStorage.setItem("free-draw-elements",JSON.stringify(v))},p=t(184),v=JSON.parse(localStorage.getItem("free-draw-elements"))||[],m={offsetLeft:0,offsetTop:0,scrollX:0,scrollY:0,draggingElement:null},w=(0,i.memo)((function(){var e=(0,i.useRef)(null),n=(0,i.useRef)(null);(0,i.useEffect)((function(){var t=e.current,r=t.getContext("2d"),i=t.offsetWidth,o=t.offsetHeight,a=t.offsetLeft,l=t.offsetTop;t.width=i*window.devicePixelRatio,t.height=o*window.devicePixelRatio,r.scale(window.devicePixelRatio,window.devicePixelRatio),m.offsetLeft=a,m.offsetTop=l,h(t,m);var u=n.current,c=function(e){e.preventDefault()};return u.addEventListener("wheel",c,{passive:!1}),function(){u.removeEventListener("wheel",c)}}),[]);var t=function(n){return(0,c.$9)((function(n){var t=(0,o.dE)(n,m);m.draggingElement.points.push([t.x,t.y]),d(m.draggingElement),h(e.current,m)}))},u=function(e){return function(){console.log("appState...",m),console.log("elements...",v.map((function(e){return e.points.length}))),window.removeEventListener("pointermove",e.eventListeners.onMove),window.removeEventListener("pointerup",e.eventListeners.onUp)}};return(0,p.jsxs)("div",{className:"draw-image",children:[(0,p.jsx)("div",{className:"container",ref:n,children:(0,p.jsx)("canvas",{ref:e,className:"canvas",onPointerDown:function(e){var n=(0,o.dE)(e,m),i={origin:n,lastCoords:(0,r.Z)({},n),eventListeners:{onMove:null,onUp:null}},a={x:i.origin.x,y:i.origin.y,points:[[i.origin.x,i.origin.y]],strokeColor:"#000000",backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:(0,o.B8)()};m.draggingElement=a,d(a),v.push(a);var l=t(i),c=u(i);window.addEventListener("pointermove",l),window.addEventListener("pointerup",c),i.eventListeners.onMove=l,i.eventListeners.onUp=c},children:"\u7ed8\u5236canvas"})}),(0,p.jsx)(a.Z,{src:l})]})}))},8943:function(e,n,t){t.d(n,{$9:function(){return l},TE:function(){return c},eu:function(){return d},qf:function(){return u}});var r=t(9439),i=t(7762),o=t(3433),a=t(4164),l=function(e){return function(e,n){var t=null,r=null,i=null,a=function n(a){t=window.requestAnimationFrame((function(){t=null,e.apply(void 0,(0,o.Z)(a)),r=null,i&&(r=i,i=null,n(r))}))},l=function(){for(var e=arguments.length,o=new Array(e),l=0;l<e;l++)o[l]=arguments[l];r=o,null===t?a(r):null!==n&&void 0!==n&&n.trailing&&(i=o)};return l.flush=function(){null!==t&&(cancelAnimationFrame(t),t=null),r&&(e.apply(void 0,(0,o.Z)(i||r)),r=i=null)},l.cancel=function(){r=i=null,null!==t&&(cancelAnimationFrame(t),t=null)},l}((function(n){(0,a.unstable_batchedUpdates)(e,n)}))},u=function(e){var n=function(e){var n,t=1/0,o=1/0,a=-1/0,l=-1/0,u=(0,i.Z)(e);try{for(u.s();!(n=u.n()).done;){var c=(0,r.Z)(n.value,2),s=c[0],d=c[1];t=Math.min(t,s),o=Math.min(o,d),a=Math.max(a,s),l=Math.max(l,d)}}catch(f){u.e(f)}finally{u.f()}return[t,o,a,l]}(e.points),t=(0,r.Z)(n,4),o=t[0],a=t[1],l=t[2],u=t[3],c=o+e.x,s=a+e.y,d=l+e.x,f=u+e.y;return[c,s,d,f,(c+d)/2,(s+f)/2]},c=function(e,n){return Math.abs(e-n)},s=0,d=function(){return(JSON.parse(localStorage.getItem("free-draw-elements"))||[]).map((function(e){var n=e.points.map((function(n){return[n[0]-e.x,n[1]-e.y]})),t=function(e){var n=e.map((function(e){return e[0]})),t=e.map((function(e){return e[1]}));return{width:Math.max.apply(Math,(0,o.Z)(n))-Math.min.apply(Math,(0,o.Z)(n)),height:Math.max.apply(Math,(0,o.Z)(t))-Math.min.apply(Math,(0,o.Z)(t))}}(n),r=t.width,i=t.height;return{id:"id".concat(s++),type:"freedraw",x:e.x,y:e.y,width:r,height:i,angle:0,strokeColor:e.strokeStyle,backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",roughness:1,opacity:100,groupIds:[],roundness:null,seed:Math.floor(Math.random()*Math.pow(2,31)),version:1,versionNonce:0,isDeleted:!1,boundElements:null,updated:Date.now(),link:null,locked:!1,points:n,pressures:[],simulatePressure:!0,lastCommittedPoint:n[n.length-1]}}))};window.__generateExcalidrawElements=d},84:function(e,n,t){t.d(n,{$9:function(){return c},B8:function(){return u},TE:function(){return d},dE:function(){return l},qf:function(){return s}});var r=t(9439),i=t(7762),o=t(3433),a=t(4164),l=function(e,n){var t=e.clientX,r=e.clientY,i=n.offsetLeft,o=n.offsetTop;return{x:t-i-n.scrollX,y:r-o-n.scrollY}},u=function(){var e=Math.floor(256*Math.random()),n=Math.floor(256*Math.random()),t=Math.floor(256*Math.random());return"rgb(".concat(e,",").concat(n,",").concat(t,")")},c=function(e){return function(e,n){var t=null,r=null,i=null,a=function n(a){t=window.requestAnimationFrame((function(){t=null,e.apply(void 0,(0,o.Z)(a)),r=null,i&&(r=i,i=null,n(r))}))},l=function(){for(var e=arguments.length,o=new Array(e),l=0;l<e;l++)o[l]=arguments[l];r=o,null===t?a(r):null!==n&&void 0!==n&&n.trailing&&(i=o)};return l.flush=function(){null!==t&&(cancelAnimationFrame(t),t=null),r&&(e.apply(void 0,(0,o.Z)(i||r)),r=i=null)},l.cancel=function(){r=i=null,null!==t&&(cancelAnimationFrame(t),t=null)},l}((function(n){(0,a.unstable_batchedUpdates)(e,n)}))},s=function(e){if("freedraw"===e.type){var n=function(e){var n,t=1/0,o=1/0,a=-1/0,l=-1/0,u=(0,i.Z)(e);try{for(u.s();!(n=u.n()).done;){var c=(0,r.Z)(n.value,2),s=c[0],d=c[1];t=Math.min(t,s),o=Math.min(o,d),a=Math.max(a,s),l=Math.max(l,d)}}catch(f){u.e(f)}finally{u.f()}return[t,o,a,l]}(e.points),t=(0,r.Z)(n,4),o=t[0],a=t[1],l=t[2],u=t[3],c=o+e.x,s=a+e.y,d=l+e.x,f=u+e.y;return[c,s,d,f,(c+d)/2,(s+f)/2]}return[e.x,e.y,e.x+e.width,e.y+e.height,e.x+e.width/2,e.y+e.height/2]},d=function(e,n){return Math.abs(e-n)},f=0;window.__generateExcalidrawElements=function(){return(JSON.parse(localStorage.getItem("free-draw-elements"))||[]).map((function(e){var n=e.points.map((function(n){return[n[0]-e.x,n[1]-e.y]})),t=function(e){var n=e.map((function(e){return e[0]})),t=e.map((function(e){return e[1]}));return{width:Math.max.apply(Math,(0,o.Z)(n))-Math.min.apply(Math,(0,o.Z)(n)),height:Math.max.apply(Math,(0,o.Z)(t))-Math.min.apply(Math,(0,o.Z)(t))}}(n),r=t.width,i=t.height;return{id:"id".concat(f++),type:"freedraw",x:e.x,y:e.y,width:r,height:i,angle:0,strokeColor:e.strokeStyle,backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",roughness:1,opacity:100,groupIds:[],roundness:null,seed:Math.floor(Math.random()*Math.pow(2,31)),version:1,versionNonce:0,isDeleted:!1,boundElements:null,updated:Date.now(),link:null,locked:!1,points:n,pressures:[],simulatePressure:!0,lastCommittedPoint:n[n.length-1]}}))}},6818:function(e,n,t){e.exports=t.p+"static/media/\u70b9\u7a00\u91ca.31d6cfe0d16ae931b73c.md"}}]);
//# sourceMappingURL=DrawImage.f432caed.chunk.js.map