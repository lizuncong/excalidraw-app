"use strict";(self.webpackChunkexcalidraw_app=self.webpackChunkexcalidraw_app||[]).push([[536],{1890:function(e,n,t){t.d(n,{Z:function(){return v}});var i=t(1413),o=t(4925),r=t(9439),a=t(2791),l=t(1350),c=t(1926),s=t(4209),u=t(6571),d=(t(3659),t(184)),f=["node","inline","className","children"];var v=function(e){var n=e.src,t=(0,a.useState)(""),v=(0,r.Z)(t,2),w=v[0],h=v[1];return(0,a.useEffect)((function(){fetch(n).then((function(e){return e.text()})).then((function(e){h(e)}))}),[n]),(0,d.jsx)("div",{className:"markdown-body",children:(0,d.jsx)(l.D,{children:w,rehypePlugins:[u.Z],remarkPlugins:[c.Z],components:{code:function(e){e.node;var n=e.inline,t=e.className,r=e.children,a=(0,o.Z)(e,f),l=/language-(\w+)/.exec(t||"");return!n&&l?(0,d.jsx)(s.Z,(0,i.Z)({children:String(r).replace(/\n$/,""),language:l[1],className:"my-code",PreTag:"div"},a)):(0,d.jsx)("code",(0,i.Z)((0,i.Z)({className:t},a),{},{children:r}))}}})})}},2206:function(e,n,t){t.r(n),t.d(n,{default:function(){return P},elements:function(){return y}});var i=t(1413),o=t(2791),r=t(84),a=t(1890),l=t(6818),c=t(9439),s=t(7762),u=t(3433),d=t(4164),f=function(e){return function(e,n){var t=null,i=null,o=null,r=function n(r){t=window.requestAnimationFrame((function(){t=null,e.apply(void 0,(0,u.Z)(r)),i=null,o&&(i=o,o=null,n(i))}))},a=function(){for(var e=arguments.length,a=new Array(e),l=0;l<e;l++)a[l]=arguments[l];i=a,null===t?r(i):null!==n&&void 0!==n&&n.trailing&&(o=a)};return a.flush=function(){null!==t&&(cancelAnimationFrame(t),t=null),i&&(e.apply(void 0,(0,u.Z)(o||i)),i=o=null)},a.cancel=function(){i=o=null,null!==t&&(cancelAnimationFrame(t),t=null)},a}((function(n){(0,d.unstable_batchedUpdates)(e,n)}))},v=function(e){var n=function(e){var n,t=1/0,i=1/0,o=-1/0,r=-1/0,a=(0,s.Z)(e);try{for(a.s();!(n=a.n()).done;){var l=(0,c.Z)(n.value,2),u=l[0],d=l[1];t=Math.min(t,u),i=Math.min(i,d),o=Math.max(o,u),r=Math.max(r,d)}}catch(f){a.e(f)}finally{a.f()}return[t,i,o,r]}(e.points),t=(0,c.Z)(n,4),i=t[0],o=t[1],r=t[2],a=t[3],l=i+e.x,u=o+e.y,d=r+e.x,f=a+e.y;return[l,u,d,f,(l+d)/2,(u+f)/2]},w=function(e,n){return Math.abs(e-n)},h=new WeakMap,m=function(e){h.delete(e)},p=function(e,n){y.forEach((function(t){var o=function(e){var n=h.get(e);if(n)return n;var t,o,r=document.createElement("canvas"),a=r.getContext("2d"),l=v((0,i.Z)((0,i.Z)({},e),{},{points:e.points.map((function(n){return[n[0]-e.x,n[1]-e.y]}))})),s=(0,c.Z)(l,4),u=s[0],d=s[1],f=s[2],m=s[3];return r.width=w(u,f)*window.devicePixelRatio+40,r.height=w(d,m)*window.devicePixelRatio+40,t=e.x>u?w(e.x,u)*window.devicePixelRatio:0,o=e.y>d?w(e.y,d)*window.devicePixelRatio:0,a.translate(t,o),a.save(),a.translate(20,20),a.scale(window.devicePixelRatio,window.devicePixelRatio),a.lineWidth=3,a.strokeStyle=e.strokeStyle,e.points.forEach((function(n,t){var i=(0,c.Z)(n,2),o=i[0],r=i[1];o-=e.x,r-=e.y,t?a.lineTo(o,r):a.moveTo(o,r)})),a.stroke(),a.restore(),h.set(e,r),r}(t),r=v((0,i.Z)((0,i.Z)({},t),{},{points:t.points.map((function(e){return[e[0]-t.x,e[1]-t.y]}))})),a=(0,c.Z)(r,4),l=a[0],s=a[1],u=a[2],d=a[3];l=Math.floor(l),u=Math.ceil(u),s=Math.floor(s),d=Math.ceil(d);var f=((l+u)/2+n.scrollX)*window.devicePixelRatio,m=((s+d)/2+n.scrollY)*window.devicePixelRatio;e.save(),e.scale(1/window.devicePixelRatio,1/window.devicePixelRatio),e.translate(f,m),e.drawImage(o,-(u-l)/2*window.devicePixelRatio-20,-(d-s)/2*window.devicePixelRatio-20,o.width,o.height),e.restore()}))},g=function(e,n){var t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),p(t,n),localStorage.setItem("free-draw-elements",JSON.stringify(y))},x=t(184),y=JSON.parse(localStorage.getItem("free-draw-elements"))||[],Z={offsetLeft:0,offsetTop:0,scrollX:0,scrollY:0,draggingElement:null},P=(0,o.memo)((function(){var e=(0,o.useRef)(null),n=(0,o.useRef)(null);(0,o.useEffect)((function(){var t=e.current,i=t.getContext("2d"),o=t.offsetWidth,r=t.offsetHeight,a=t.offsetLeft,l=t.offsetTop;t.width=o*window.devicePixelRatio,t.height=r*window.devicePixelRatio,i.scale(window.devicePixelRatio,window.devicePixelRatio),Z.offsetLeft=a,Z.offsetTop=l,g(t,Z);var c=n.current,s=function(e){e.preventDefault()};return c.addEventListener("wheel",s,{passive:!1}),function(){c.removeEventListener("wheel",s)}}),[]);var t=function(n){return f((function(n){var t=(0,r.d)(n,Z);Z.draggingElement.points.push([t.x,t.y]),m(Z.draggingElement),g(e.current,Z)}))},c=function(e){return function(){console.log("appState...",Z),console.log("elements...",y.map((function(e){return e.points.length}))),window.removeEventListener("pointermove",e.eventListeners.onMove),window.removeEventListener("pointerup",e.eventListeners.onUp)}};return(0,x.jsxs)("div",{className:"free-draw",children:[(0,x.jsx)("div",{className:"container",ref:n,children:(0,x.jsx)("canvas",{ref:e,className:"canvas",onPointerDown:function(e){var n=(0,r.d)(e,Z),o={origin:n,lastCoords:(0,i.Z)({},n),eventListeners:{onMove:null,onUp:null}},a={x:o.origin.x,y:o.origin.y,points:[[o.origin.x,o.origin.y]],strokeColor:"#000000",backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:(0,r.B)()};Z.draggingElement=a,m(a),y.push(a);var l=t(o),s=c(o);window.addEventListener("pointermove",l),window.addEventListener("pointerup",s),o.eventListeners.onMove=l,o.eventListeners.onUp=s},children:"\u7ed8\u5236canvas"})}),(0,x.jsx)(a.Z,{src:l})]})}))},84:function(e,n,t){t.d(n,{B:function(){return o},d:function(){return i}});var i=function(e,n){var t=e.clientX,i=e.clientY,o=n.offsetLeft,r=n.offsetTop;return{x:t-o-n.scrollX,y:i-r-n.scrollY}},o=function(){var e=Math.floor(256*Math.random()),n=Math.floor(256*Math.random()),t=Math.floor(256*Math.random());return"rgb(".concat(e,",").concat(n,",").concat(t,")")}},6818:function(e,n,t){e.exports=t.p+"static/media/\u70b9\u7a00\u91ca.31d6cfe0d16ae931b73c.md"}}]);
//# sourceMappingURL=DrawImage.35e3f732.chunk.js.map