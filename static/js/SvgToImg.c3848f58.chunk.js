"use strict";(this.webpackChunkexcalidraw_app=this.webpackChunkexcalidraw_app||[]).push([[458],{1370:function(e,t,n){n.r(t),n.d(t,{appState:function(){return ne},default:function(){return oe}});var r,o,i,l,a=n(3433),c=n(1413),s=n(9439),u=n(4519),d=n(5204),f=n(4975),v=n(4925),h=["type","x","y","strokeColor","backgroundColor","fillStyle","strokeWidth","strokeStyle","width","height","angle","points"],m=function(e){var t=e.type,n=e.x,r=e.y,o=e.strokeColor,i=e.backgroundColor,l=e.fillStyle,a=e.strokeWidth,s=void 0===a?3:a,u=e.strokeStyle,f=e.width,m=void 0===f?0:f,g=e.height,p=void 0===g?0:g,x=e.angle,y=void 0===x?0:x,w=e.points,C=void 0===w?[]:w,k=(0,v.Z)(e,h);return(0,c.Z)({id:(0,d.kb)(),type:t,x:n,y:r,width:m,height:p,strokeColor:o,backgroundColor:i,fillStyle:l,strokeWidth:s,strokeStyle:u,angle:y,isDeleted:!1,points:C},k)},g=function(e){var t=e.elementType,n=e.pointerDownState,r=e.appState;return m("freedraw"===t?{type:t,x:n.origin.x,y:n.origin.y,points:[[n.origin.x,n.origin.y]],strokeColor:r.currentItemStrokeColor,backgroundColor:r.currentItemBackgroundColor,fillStyle:r.currentItemFillStyle,strokeWidth:r.currentItemStrokeWidth,strokeStyle:(0,d.B8)()}:{type:t,x:n.origin.x,y:n.origin.y,strokeColor:r.currentItemStrokeColor,backgroundColor:r.currentItemBackgroundColor,fillStyle:r.currentItemFillStyle,strokeWidth:r.currentItemStrokeWidth,strokeStyle:(0,d.B8)()})},p=function(e){return m((0,c.Z)({type:"text",text:e.text,fontSize:e.fontSize,fontFamily:e.fontFamily,textAlign:e.textAlign,verticalAlign:e.verticalAlign,originalText:e.text},e))},x=function(e,t){return Number((Math.random()*(t-e)+e).toFixed(5))},y=function(e,t,n){for(var r,o=[],i=0;i<e;i++){var l=x(-n.scrollX,n.canvasWidth-n.scrollX),a=x(-n.scrollY,n.canvasHeight-n.scrollY);if(r=g({elementType:t,pointerDownState:{origin:{x:l,y:a}},appState:n}),"rectangle"===t){var c=Math.abs(x(-n.scrollX-l,n.canvasWidth-n.scrollX-l))+2,s=Math.abs(x(-n.scrollY-a,n.canvasHeight-n.scrollY-a))+2;r.width=c,r.height=s}else if("freedraw"===t)for(var u=x(20,100),f=0;f<u;f++)l=x(l,l+10),a=x(a,a+10),r.points.push([l,a]);else if("text"===t){var v="".concat(l,", ").concat(a);r=p({x:l,y:a,strokeColor:(0,d.B8)(),backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",text:v,width:20*v.length,height:25,fontSize:20,fontFamily:"Virgil",textAlign:"left",verticalAlign:"top"})}o.push(r)}return o},w={},C=n(2121),k="http://www.w3.org/2000/svg",S=function(e){var t=e.elements,n=e.appState,a=(e.scale,e.svg),c=e.renderConfig,u=e.isTransform,d=c.accelerate,f="\n    transform: translateX(".concat(n.scrollX*n.zoom.value,"px) translateY(").concat(n.scrollY*n.zoom.value,"px) scale(").concat(n.zoom.value,");\n    width: ").concat(30,"px;\n    height: ").concat(30,"px;\n    transform-origin: left top;\n    ").concat(d?"will-change: transform;":"","\n  ");if(a.setAttribute("style",f.replace(/\s+/g," ")),!u){var v=(0,C.Sp)(t,10),h=(0,s.Z)(v,4),m=h[0],g=h[1],p=h[2],x=h[3];r||((r=document.createElementNS(k,"svg")).style.position="absolute",r.style.background="transparent",r.setAttribute("xmlns","http://www.w3.org/2000/svg"),r.setAttribute("version","1.1"),(l=document.createElement("img")).style.position="absolute",a.appendChild(l)),r.setAttribute("width",p),r.setAttribute("height",x),t.map((function(e,t){return function(e,t,n,r){var o,i=r.minX,l=r.minY,a=r.svg;if(r.originChange||!w[e.id]||e===n.draggingElement){switch(e.type){case"rectangle":var c=e.x-i+Math.ceil(e.strokeWidth/2),s=e.y-l;(o=w[e.id]||document.createElementNS(k,"rect")).setAttribute("id",e.id),o.setAttribute("x",c+Math.ceil(e.strokeWidth/2)),o.setAttribute("y",s+Math.ceil(e.strokeWidth/2)),o.setAttribute("width",e.width),o.setAttribute("height",e.height),o.setAttribute("fill","none"),o.setAttribute("stroke-width",e.strokeWidth),o.setAttribute("stroke",e.strokeStyle),o.__x=c,o.__y=s,o.__width=e.width,o.__height=e.height;break;case"freedraw":var u=e.points.map((function(t){return[t[0]-i+Math.ceil(e.strokeWidth/2),t[1]-l+Math.ceil(e.strokeWidth/2)]}));(o=w[e.id]||document.createElementNS(k,"polyline")).setAttribute("id",e.id),o.setAttribute("points",u.join(" ")),o.setAttribute("fill","none"),o.setAttribute("stroke-width",e.strokeWidth),o.setAttribute("stroke",e.strokeStyle)}return w[e.id]||(w[e.id]=o,a.appendChild(o)),o}}(e,0,n,{minX:m,minY:g,svg:r,originChange:o!==m||i!==g})})),o=m,i=g;var y=E(r);l.src=y,l.style.left="".concat(m,"px"),l.style.top="".concat(g,"px")}},E=function(e){var t=(new XMLSerializer).serializeToString(e),n="data:image/svg+xml;base64,"+btoa(t);return document.createElement("img").src=n,n},j=n(5909),b={pointers:new Map,lastCenter:null,initialDistance:null,initialScale:null},z=function(e,t){(0,u.useEffect)((function(){var t=e.current,n=function(e){e.touches.length||b.pointers.clear()};return t.addEventListener("touchend",n),function(){t.removeEventListener("touchend",n)}}),[e]);return{gesture:b,removePointer:function(e){b.pointers.delete(e.pointerId)},updateGestureOnPointerDown:function(e){b.pointers.set(e.pointerId,{x:e.clientX,y:e.clientY}),2===b.pointers.size&&(b.lastCenter=(0,j.q)(b.pointers),b.initialScale=t.zoom.value,b.initialDistance=(0,j.S)(Array.from(b.pointers.values())))},handleCanvasPointerMove:function(e,n){b.pointers.has(e.pointerId)&&b.pointers.set(e.pointerId,{x:e.clientX,y:e.clientY});var r=b.initialScale;if(2===b.pointers.size&&b.lastCenter&&r&&b.initialDistance){var o=(0,j.q)(b.pointers),i=o.x-b.lastCenter.x,l=o.y-b.lastCenter.y;b.lastCenter=o;var a=(0,j.S)(Array.from(b.pointers.values()))/b.initialDistance,c=a?(0,f.j)(r*a):t.zoom.value,s=(0,f.E)({viewportX:o.x,viewportY:o.y,nextZoom:c},t);Object.assign(t,{zoom:s.zoom,scrollX:s.scrollX+i/c,scrollY:s.scrollY+l/c}),n()}else b.lastCenter=b.initialDistance=b.initialScale=null}}},M={tools:"index_tools__uJKGs",item:"index_item__2AP8f",selected:"index_selected__1ona6"},Z=n(2556),X=["width","height","mirror","style"],_=function(e,t){var n="number"===typeof t?{width:t}:t,r=n.width,o=void 0===r?512:r,i=n.height,l=void 0===i?o:i,a=(n.mirror,n.style),s=(0,v.Z)(n,X);return(0,Z.jsx)("svg",(0,c.Z)((0,c.Z)({"aria-hidden":"true",focusable:"false",role:"img",viewBox:"0 0 ".concat(o," ").concat(l),style:a},s),{},{children:"string"===typeof e?(0,Z.jsx)("path",{fill:"currentColor",d:e}):e}))},Y=_((0,Z.jsxs)("g",{strokeWidth:"1.5",children:[(0,Z.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,Z.jsx)("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"})]}),{width:24,height:24,fill:"none",strokeWidth:2,stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),T=_((0,Z.jsxs)("g",{strokeWidth:"1.25",children:[(0,Z.jsx)("path",{clipRule:"evenodd",d:"m7.643 15.69 7.774-7.773a2.357 2.357 0 1 0-3.334-3.334L4.31 12.357a3.333 3.333 0 0 0-.977 2.357v1.953h1.953c.884 0 1.732-.352 2.357-.977Z"}),(0,Z.jsx)("path",{d:"m11.25 5.417 3.333 3.333"})]}),{width:20,height:20,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),A=_((0,Z.jsxs)("g",{strokeWidth:"1.25",children:[(0,Z.jsx)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,Z.jsx)("path",{d:"M15 8h.01"}),(0,Z.jsx)("path",{d:"M12 20h-5a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v5"}),(0,Z.jsx)("path",{d:"M4 15l4 -4c.928 -.893 2.072 -.893 3 0l4 4"}),(0,Z.jsx)("path",{d:"M14 14l1 -1c.617 -.593 1.328 -.793 2.009 -.598"}),(0,Z.jsx)("path",{d:"M19 16v6"}),(0,Z.jsx)("path",{d:"M22 19l-3 3l-3 -3"})]}),{width:24,height:24,fill:"none",strokeWidth:2,stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),R={width:20,height:20,fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"},I=_((0,Z.jsx)("path",{strokeWidth:"1.25",d:"M10 4.167v11.666M4.167 10h11.666"}),R),D=_((0,Z.jsx)("path",{d:"M5 10h10",strokeWidth:"1.25"}),R),W=n(5671),L=n(3144),P=function(){function e(){(0,W.Z)(this,e);var t=JSON.parse(localStorage.getItem("elements"));this.elements=t||[]}return(0,L.Z)(e,[{key:"getElementsIncludingDeleted",value:function(){return this.elements}},{key:"replaceAllElements",value:function(e){this.elements=e}}]),e}(),B=new P,N=[{type:"rectangle",icon:Y},{type:"freedraw",icon:T}],F=(0,u.memo)((function(e){var t=e.activeTool,n=e.onActiveToolChange;return(0,Z.jsxs)("div",{className:M.tools,children:[(0,Z.jsx)("span",{className:[M.item].join(" "),onClick:function(){(0,C.aF)({renderScene:S,elements:B.getElementsIncludingDeleted(),appState:ne})},children:A}),N.map((function(e){var r=t.type===e.type;return(0,Z.jsx)("span",{className:[M.item,r&&M.selected].join(" "),onClick:function(){return n({type:r?"":e.type})},children:e.icon},e.type)}))]})})),O={scale:"index_scale__Gm0Zi",item:"index_item__0PdRb",value:"index_value__UbAZm"},U=(0,u.memo)((function(e){var t=e.appState,n=e.onZoomChange,r="".concat((100*t.zoom.value).toFixed(0),"%");return(0,Z.jsxs)("div",{className:O.scale,children:[(0,Z.jsx)("span",{className:[O.item].join(" "),onClick:function(){return n((0,f.j)(t.zoom.value-.1))},children:D}),(0,Z.jsx)("span",{className:O.value,onClick:function(){return n((0,f.j)(1))},children:r}),(0,Z.jsx)("span",{className:[O.item].join(" "),onClick:function(){return n((0,f.j)(t.zoom.value+.1))},children:I})]})})),H=U,q="index_layer__Cpe5s",K="index_ball_red__VfRx+",G="index_boundceBall__CXRXz",J="index_shadowball__FMJKb",V=(0,u.memo)((function(e){var t=e.activeTool,n=e.onActiveToolChange,r=e.appState,o=e.onZoomChange;return(0,Z.jsxs)("div",{className:q,children:[(0,Z.jsx)(H,{appState:r,onZoomChange:o}),(0,Z.jsx)(F,{activeTool:t,onActiveToolChange:n}),(0,Z.jsxs)("div",{className:G,children:[(0,Z.jsx)("div",{className:K}),(0,Z.jsx)("div",{className:J})]})]})})),$=V,Q={textarea:"index_textarea__vpld+",textarea_copy:"index_textarea_copy__6zBT5"},ee=(0,u.forwardRef)((function(e,t){var n=e.staticCanvasRef,r=(0,u.useRef)(null),o=(0,u.useState)(""),i=(0,s.Z)(o,2),l=i[0],c=i[1];return(0,u.useImperativeHandle)(t,(function(){return{startEditText:function(e){e.preventDefault(),e.stopPropagation();var t=(0,d.dE)(e,ne),n=t.x,o=t.y,i=p({x:n,y:o,strokeColor:(0,d.B8)(),backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",text:"",fontSize:20,fontFamily:"Virgil",textAlign:"left",verticalAlign:"top"});ne.draggingElement=i;var l=r.current;l.focus();var a=e.clientX-ne.offsetLeft,c=e.clientY-ne.offsetTop,s={font:(0,d.mO)(i),left:"".concat(a,"px"),top:"".concat(c,"px"),opacity:1,color:i.strokeColor,fontSize:i.fontSize};Object.assign(l.style,s);var u=document.getElementById("copyText");Object.assign(u.style,s);var f=ne.canvasWidth-a;Object.assign(l.style,{zIndex:1,maxWidth:"".concat(f,"px"),width:"".concat(i.fontSize,"px"),height:"".concat(1.2*i.fontSize,"px")})}}})),(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("textarea",{onChange:function(e){var t=e.target.value,n=r.current,o=parseFloat(n.style.maxWidth),i=document.getElementById("copyText");i.innerText=t;var l=i.getBoundingClientRect().width;if(l>o)if(l-o<30)t=i.innerText=t.slice(0,t.length-1)+"\n"+t.slice(t.length-1);else{var a=t.split("\n"),s=[];a.forEach((function(e){if(i.innerText=e,i.getBoundingClientRect().width<=o)s.push(e);else for(var t=0,n=1;n<e.length;n++){var r=e.slice(t,n);i.innerText=r,i.getBoundingClientRect().width>o?(s.push(e.slice(t,n-1)),t=n-1):n===e.length-1&&s.push(e.slice(t,n))}})),t=s.join("\n"),i.innerText=t}c(t);var u=i.getBoundingClientRect(),d=u.width,f=u.height;n.style.width="".concat(d+30,"px"),n.style.height="".concat(f,"px"),ne.draggingElement.text=t},onBlur:function(){var e=ne.draggingElement,t=r.current,o=document.getElementById("copyText");e.text&&(e.width=o.offsetWidth,e.height=o.offsetHeight,ne.draggingElement,B.replaceAllElements([].concat((0,a.Z)(B.getElementsIncludingDeleted()),[ne.draggingElement])),S({elements:B.getElementsIncludingDeleted(),appState:ne,scale:window.devicePixelRatio,canvas:n.current,renderConfig:{selectionColor:"#6965db",scrollX:ne.scrollX,scrollY:ne.scrollY,viewBackgroundColor:"#ffffff",zoom:ne.zoom}}),setTimeout((function(){o.innerText="",c("")}),200)),Object.assign(t.style,{left:"0px",top:"0px",zIndex:-1,opacity:0})},value:l,className:Q.textarea,ref:r}),(0,Z.jsx)("div",{style:{background:"grey"},id:"copyText",contentEditable:!0,className:[Q.textarea,Q.textarea_copy].join(" ")})]})})),te=(0,u.memo)(ee),ne=JSON.parse(localStorage.getItem("appState"))||{zoom:{value:1},scrollX:0,scrollY:0,offsetLeft:0,offsetTop:0,draggingElement:null,canvasWidth:0,canvasHeight:0},re=(0,u.memo)((function(){var e=(0,u.useRef)(null),t=(0,u.useRef)(null),n=(0,u.useRef)(null),r=(0,u.useRef)(null),o=(0,u.useRef)({}),i=(0,u.useRef)(null),l=(0,u.useRef)(null),v=(0,u.useRef)({}),h=(0,u.useState)(!1),m=(0,s.Z)(h,2),p=m[0],w=m[1],C=(0,u.useState)({type:""}),k=(0,s.Z)(C,2),E=k[0],j=k[1],b=(0,u.useState)({count:"",type:"rectangle"}),M=(0,s.Z)(b,2),X=M[0],_=M[1],Y=(0,u.useState)(!1),T=(0,s.Z)(Y,2),A=T[0],R=T[1],I=(0,u.useRef)(!1),D=(0,u.useRef)(),W=function(){w(!p)};(0,u.useEffect)((function(){var t=function(e){e.width=i*window.devicePixelRatio,e.height=l*window.devicePixelRatio},o=e.current,i=o.offsetWidth,l=o.offsetHeight;t(o),t(n.current);var a=o.getBoundingClientRect(),c=a.x,s=a.y;ne.offsetLeft=c,ne.offsetTop=s,ne.canvasWidth=i,ne.canvasHeight=l,S({elements:B.getElementsIncludingDeleted(),appState:ne,scale:window.devicePixelRatio,canvas:n.current,svg:r.current,renderConfig:{selectionColor:"#6965db",scrollX:ne.scrollX,scrollY:ne.scrollY,viewBackgroundColor:"#ffffff",zoom:ne.zoom,accelerate:I.current}})}),[]),(0,u.useEffect)((function(){var n=t.current,r=function(e){e.preventDefault()};n.addEventListener("wheel",r,{passive:!1});var i=function(e){o.current={cursorX:e.clientX,cursorY:e.clientY}},l=function(e){e.preventDefault()},a=e.current;return a.addEventListener("touchstart",l),document.addEventListener("mousemove",i),function(){a.removeEventListener("touchstart",l),n.removeEventListener("wheel",r),document.removeEventListener("mousemove",i)}}),[]),(0,u.useEffect)((function(){var e=0,t=Date.now();!function n(){var r=Date.now();if(e++,r>1e3+t){var o=Math.round(1e3*e/(r-t));l.current.innerText="FPS\uff1a".concat(o),e=0,t=r}requestAnimationFrame(n)}()}),[]);var L=z(e,ne),P=L.updateGestureOnPointerDown,N=L.handleCanvasPointerMove,F=L.removePointer,O=L.gesture,U=function(){S({elements:B.getElementsIncludingDeleted(),appState:ne,scale:window.devicePixelRatio,canvas:n.current,svg:r.current,isTransform:!0,renderConfig:{selectionColor:"#6965db",scrollX:ne.scrollX,scrollY:ne.scrollY,viewBackgroundColor:"#ffffff",zoom:ne.zoom,accelerate:I.current}}),v.current.zoomTimerId&&clearTimeout(v.current.zoomTimerId),v.current.zoomTimerId=setTimeout((function(){S({elements:B.getElementsIncludingDeleted(),appState:ne,scale:window.devicePixelRatio,canvas:n.current,svg:r.current,isTransform:!0,renderConfig:{selectionColor:"#6965db",scrollX:ne.scrollX,scrollY:ne.scrollY,viewBackgroundColor:"#ffffff",zoom:ne.zoom,accelerate:I.current}})}),300)},H=function(e){return(0,d.$9)((function(t){var o=(0,d.dE)(t,ne);if(e.lastCoords.x=o.x,e.lastCoords.y=o.y,"freedraw"===E.type)ne.draggingElement.points.push([o.x,o.y]);else{var i=e.lastCoords,l=e.origin.x,a=e.origin.y,c=i.x,s=i.y,u=(0,d.TE)(e.origin.x,i.x),f=(0,d.TE)(e.origin.y,i.y),v=c<l?l-u:l,h=s<a?a-f:a;ne.draggingElement.x=v,ne.draggingElement.y=h,ne.draggingElement.width=u,ne.draggingElement.height=f}ne.draggingElement,S({elements:B.getElementsIncludingDeleted(),appState:ne,scale:window.devicePixelRatio,canvas:n.current,svg:r.current,renderConfig:{selectionColor:"#6965db",scrollX:ne.scrollX,scrollY:ne.scrollY,viewBackgroundColor:"#ffffff",zoom:ne.zoom,accelerate:I.current}})}))},q=function(t){return function(o){F(o);var i=e.current;i.getContext("2d").clearRect(0,0,i.width,i.height),S({elements:B.getElementsIncludingDeleted(),appState:ne,scale:window.devicePixelRatio,canvas:n.current,svg:r.current,renderConfig:{selectionColor:"#6965db",scrollX:ne.scrollX,scrollY:ne.scrollY,viewBackgroundColor:"#ffffff",zoom:ne.zoom,accelerate:I.current}}),window.removeEventListener("pointermove",t.eventListeners.onMove),window.removeEventListener("pointerup",t.eventListeners.onUp)}},K=function(e){var t=(0,d.dE)(e,ne);return{origin:t,lastCoords:(0,c.Z)({},t),eventListeners:{onMove:null,onUp:null,onKeyUp:null,onKeyDown:null}}};return(0,Z.jsxs)("div",{className:"svg-base",ref:t,children:[(0,Z.jsxs)("div",{className:"container wrap",children:[(0,Z.jsx)("div",{className:"svg-container",ref:r}),(0,Z.jsx)("canvas",{ref:n,className:"canvas",children:"\u9759\u6001canvas"}),(0,Z.jsx)("canvas",{ref:e,className:"canvas draw",onWheel:function(e){var t=e.deltaX,i=e.deltaY;if(e.metaKey||e.ctrlKey){var l=Math.sign(i),a=Math.abs(i),s=i;a>10&&(s=10*l);var u=ne.zoom.value-s/100;u+=Math.log10(Math.max(1,ne.zoom.value))*-l*Math.min(1,a/20);var d=(0,f.j)(u);return Object.assign(ne,(0,c.Z)({},(0,f.E)({viewportX:o.current.cursorX,viewportY:o.current.cursorY,nextZoom:d},ne))),W(),void U()}ne.scrollX=ne.scrollX-t/ne.zoom.value,ne.scrollY=ne.scrollY-i/ne.zoom.value,S({elements:B.getElementsIncludingDeleted(),isTransform:!0,appState:ne,scale:window.devicePixelRatio,canvas:n.current,svg:r.current,renderConfig:{selectionColor:"#6965db",scrollX:ne.scrollX,scrollY:ne.scrollY,viewBackgroundColor:"#ffffff",zoom:ne.zoom,accelerate:I.current}})},onPointerDown:function(e){if(!(O.pointers.size>1))if(E.type){var t=K(e),n=g({elementType:E.type,pointerDownState:t,appState:ne});ne.draggingElement=n,B.replaceAllElements([].concat((0,a.Z)(B.getElementsIncludingDeleted()),[ne.draggingElement]));var r=H(t),o=q(t);window.addEventListener("pointermove",r),window.addEventListener("pointerup",o),t.eventListeners.onMove=r,t.eventListeners.onUp=o}else P(e)},onDoubleClick:function(e){E.type||i.current.startEditText(e)},onPointerCancel:F,onPointerMove:function(e){N(e,(function(){W(),U()}))},children:"\u52a8\u6001canvas"}),(0,Z.jsx)($,{activeTool:E,onZoomChange:function(e){ne.zoom.value!==e&&(Object.assign(ne,(0,c.Z)({},(0,f.E)({viewportX:ne.canvasWidth/2+ne.offsetLeft,viewportY:ne.canvasHeight/2+ne.offsetTop,nextZoom:e},ne))),W(),U())},appState:(0,c.Z)({},ne),onActiveToolChange:function(e){j(e)}}),(0,Z.jsx)(te,{ref:i,staticCanvasRef:n})]}),(0,Z.jsxs)("div",{children:[(0,Z.jsx)("span",{ref:l,children:"FPS\uff1a--"}),(0,Z.jsx)("span",{className:"total",id:"canvas-total"})]}),(0,Z.jsxs)("div",{className:"row",children:[(0,Z.jsx)("input",{type:"number",value:X.count,onChange:function(e){return _((0,c.Z)((0,c.Z)({},X),{},{count:e.target.value}))}}),(0,Z.jsxs)("select",{value:X.type,onChange:function(e){return _((0,c.Z)((0,c.Z)({},X),{},{type:e.target.value}))},children:[(0,Z.jsx)("option",{value:"freedraw",children:"freedraw"}),(0,Z.jsx)("option",{value:"rectangle",children:"rectangle"}),(0,Z.jsx)("option",{value:"text",children:"text"})]}),(0,Z.jsx)("button",{onClick:function(){var e=y(Number(X.count),X.type,ne);B.replaceAllElements([].concat((0,a.Z)(B.getElementsIncludingDeleted()),(0,a.Z)(e))),S({elements:B.getElementsIncludingDeleted(),appState:ne,scale:window.devicePixelRatio,canvas:n.current,svg:r.current,renderConfig:{selectionColor:"#6965db",scrollX:ne.scrollX,scrollY:ne.scrollY,viewBackgroundColor:"#ffffff",zoom:ne.zoom,accelerate:I.current}})},children:"\u751f\u6210"}),(0,Z.jsx)("button",{onClick:function(){if(R(!A),D.current&&cancelAnimationFrame(D.current),!A){var e=Date.now();D.current=requestAnimationFrame((function t(){var o=Date.now();if(o-e>=100){e=o;var i=function(e,t){return e.forEach((function(e){var n=x(-t.scrollX,t.canvasWidth-t.scrollX),r=x(-t.scrollY,t.canvasHeight-t.scrollY);e.x=n,e.y=r})),e}(B.getElementsIncludingDeleted(),ne);S({elements:i,appState:ne,scale:window.devicePixelRatio,canvas:n.current,svg:r.current,renderConfig:{selectionColor:"#6965db",scrollX:ne.scrollX,scrollY:ne.scrollY,viewBackgroundColor:"#ffffff",zoom:ne.zoom,accelerate:I.current}})}D.current=requestAnimationFrame(t)}))}},children:A?"\u505c\u6b62\u52a8\u753b":"\u52a8\u753b"})]}),(0,Z.jsx)("div",{id:"placeholder"})]})})),oe=re},2121:function(e,t,n){n.d(t,{Sp:function(){return l},aF:function(){return a}});var r=n(1413),o=n(9439),i=n(5204),l=function(e,t){var n=(0,i.KP)(e),r=(0,o.Z)(n,4),l=r[0],a=r[1],c=r[2],s=r[3];return[l,a,(0,i.TE)(l,c)+2*t,(0,i.TE)(a,s)+t+t]},a=function(e){var t=e.renderScene,n=e.isExport,i=void 0===n||n,a=e.notUseCache,c=function(e){var t=e.renderScene,n=e.isExport,i=e.notUseCache,a=e.elements,c=e.appState,s=l(a,10),u=(0,o.Z)(s,4),d=u[0],f=u[1],v=u[2],h=u[3],m=document.createElement("canvas");return m.width=v*window.devicePixelRatio,m.height=h*window.devicePixelRatio,t({elements:a,appState:(0,r.Z)((0,r.Z)({},c),{},{scrollX:10-d,scrollY:10-f}),scale:window.devicePixelRatio,canvas:m,renderConfig:{selectionColor:"#6965db",scrollX:10-d,scrollY:10-f,viewBackgroundColor:"#ffffff",zoom:{value:1},isExport:n,notUseCache:i}}),m.toDataURL()}({renderScene:t,isExport:i,notUseCache:void 0===a||a,elements:e.elements,appState:e.appState}),s=document.createElement("a");s.href=c,s.download="canvas.png",s.click()}},5909:function(e,t,n){n.d(t,{S:function(){return i},q:function(){return o}});var r=n(9439),o=function(e){var t=Array.from(e.values());return{x:l(t,(function(e){return e.x}))/t.length,y:l(t,(function(e){return e.y}))/t.length}},i=function(e){var t=(0,r.Z)(e,2),n=t[0],o=t[1];return Math.hypot(n.x-o.x,n.y-o.y)},l=function(e,t){return e.reduce((function(e,n){return e+t(n)}),0)}},5204:function(e,t,n){n.d(t,{$9:function(){return s},B8:function(){return c},KP:function(){return v},Pi:function(){return f},TE:function(){return m},dE:function(){return a},kb:function(){return p},mO:function(){return x},qf:function(){return h}});var r=n(9439),o=n(7762),i=n(3433),l=n(4453),a=function(e,t){var n=e.clientX,r=e.clientY,o=t.zoom,i=t.offsetLeft,l=t.offsetTop,a=t.scrollX,c=t.scrollY,s=o?o.value:1;return{x:(n-i)/s-a,y:(r-l)/s-c}},c=function(){var e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random()),n=Math.floor(256*Math.random());return"rgb(".concat(e,",").concat(t,",").concat(n,")")},s=function(e){return function(e,t){var n=null,r=null,o=null,l=function t(l){n=window.requestAnimationFrame((function(){n=null,e.apply(void 0,(0,i.Z)(l)),r=null,o&&(r=o,o=null,t(r))}))},a=function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];r=i,null===n?l(r):null!==t&&void 0!==t&&t.trailing&&(o=i)};return a.flush=function(){null!==n&&(cancelAnimationFrame(n),n=null),r&&(e.apply(void 0,(0,i.Z)(o||r)),r=o=null)},a.cancel=function(){r=o=null,null!==n&&(cancelAnimationFrame(n),n=null)},a}((function(t){(0,l.unstable_batchedUpdates)(e,t)}))},u=function(e){var t=1/0,n=1/0,i=-1/0,l=-1/0,a=e.points;"freedraw"===e.type&&(a=e.points.map((function(t){return[t[0]-e.x,t[1]-e.y]})));var c,s=(0,o.Z)(a);try{for(s.s();!(c=s.n()).done;){var u=(0,r.Z)(c.value,2),d=u[0],f=u[1];t=Math.min(t,d),n=Math.min(n,f),i=Math.max(i,d),l=Math.max(l,f)}}catch(v){s.e(v)}finally{s.f()}return[t,n,i,l]},d=function(e,t,n,r,o){return[(e-n)*Math.cos(o)-(t-r)*Math.sin(o)+n,(e-n)*Math.sin(o)+(t-r)*Math.cos(o)+r]},f=function(e){var t=h(e),n=(0,r.Z)(t,6),o=n[0],i=n[1],l=n[2],a=n[3],c=n[4],s=n[5];if("freedraw"===e.type){var f=u(e),v=(0,r.Z)(f,4),m=v[0],g=v[1],p=v[2],x=v[3];return[m+e.x,g+e.y,p+e.x,x+e.y]}var y=d(o,i,c,s,e.angle),w=(0,r.Z)(y,2),C=w[0],k=w[1],S=d(o,a,c,s,e.angle),E=(0,r.Z)(S,2),j=E[0],b=E[1],z=d(l,a,c,s,e.angle),M=(0,r.Z)(z,2),Z=M[0],X=M[1],_=d(l,i,c,s,e.angle),Y=(0,r.Z)(_,2),T=Y[0],A=Y[1];return[Math.min(C,j,Z,T),Math.min(k,b,X,A),Math.max(C,j,Z,T),Math.max(k,b,X,A)]},v=function(e){if(!e.length)return[0,0,0,0];var t=1/0,n=-1/0,o=1/0,i=-1/0;return e.forEach((function(e){var l=f(e),a=(0,r.Z)(l,4),c=a[0],s=a[1],u=a[2],d=a[3];t=Math.min(t,c),o=Math.min(o,s),n=Math.max(n,u),i=Math.max(i,d)})),[t,o,n,i]},h=function(e){if("freedraw"===e.type){var t=u(e),n=(0,r.Z)(t,4),o=n[0],i=n[1],l=n[2],a=n[3],c=o+e.x,s=i+e.y,d=l+e.x,f=a+e.y;return[c,s,d,f,(c+d)/2,(s+f)/2]}return[e.x,e.y,e.x+e.width,e.y+e.height,e.x+e.width/2,e.y+e.height/2]},m=function(e,t){return Math.abs(e-t)},g=0,p=function(){return"id".concat(g++)},x=function(e){var t=e.fontSize,n=e.fontFamily;return"".concat(t,"px ").concat(n,", Segoe UI Emoji")}},4975:function(e,t,n){n.d(t,{E:function(){return o},j:function(){return r}});var r=function(e){return Math.max(.1,Math.min(e,30))},o=function(e,t){var n=e.viewportX,r=e.viewportY,o=e.nextZoom,i=n-t.offsetLeft,l=r-t.offsetTop,a=t.zoom.value;return{scrollX:t.scrollX+i/o-i/a,scrollY:t.scrollY+l/o-l/a,zoom:{value:o}}}}}]);
//# sourceMappingURL=SvgToImg.c3848f58.chunk.js.map