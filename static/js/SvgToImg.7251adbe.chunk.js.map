{"version":3,"file":"static/js/SvgToImg.7251adbe.chunk.js","mappings":"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","sources":["pages/dom-render/svg-to-img/renderer/svg/renderScene.js","pages/dom-render/svg-to-img/element/newElement.js","pages/dom-render/svg-to-img/generateElement.js","pages/dom-render/svg-to-img/renderer/svg/renderElement.js","pages/dom-render/svg-to-img/useGesture.js","webpack://excalidraw-app/./src/pages/dom-render/svg-to-img/components/tools/index.module.less?17b5","pages/dom-render/svg-to-img/components/icons/index.jsx","pages/dom-render/svg-to-img/scene/scene.js","pages/dom-render/svg-to-img/components/tools/index.jsx","webpack://excalidraw-app/./src/pages/dom-render/svg-to-img/components/scale/index.module.less?3637","pages/dom-render/svg-to-img/components/scale/index.jsx","webpack://excalidraw-app/./src/pages/dom-render/svg-to-img/components/layer-ui/index.module.less?23b1","pages/dom-render/svg-to-img/components/layer-ui/index.jsx","webpack://excalidraw-app/./src/pages/dom-render/svg-to-img/components/textarea/index.module.less?24ef","pages/dom-render/svg-to-img/components/textarea/index.jsx","pages/dom-render/svg-to-img/index.jsx","util/export.js","util/gesture.js","util/index.js","util/zoom.js"],"sourcesContent":["import { renderElementToSvg } from \"./renderElement\";\nimport { getCanvasSize } from \"@/util/export\";\nexport const SVG_NS = \"http://www.w3.org/2000/svg\";\n\nconst trimSpace = (str) => {\n  // return str;\n  return str.replace(/\\s+/g, \" \");\n};\n\nlet svg;\nlet timerId;\nlet _minX;\nlet _minY;\nlet img;\nexport const renderScene = ({\n  elements,\n  appState,\n  scale,\n  svg: svgContainer,\n  renderConfig,\n  isTransform,\n}) => {\n  const { accelerate } = renderConfig;\n  const originSize = 30;\n  const constainerStyle = `\n    transform: translateX(${\n      appState.scrollX * appState.zoom.value\n    }px) translateY(${appState.scrollY * appState.zoom.value}px) scale(${\n    appState.zoom.value\n  });\n    width: ${originSize}px;\n    height: ${originSize}px;\n    transform-origin: left top;\n    ${accelerate ? \"will-change: transform;\" : \"\"}\n  `;\n  svgContainer.setAttribute(\"style\", trimSpace(constainerStyle));\n  if (isTransform) {\n    if (timerId) {\n      clearTimeout(timerId);\n    }\n    // if (accelerate) {\n    //   timerId = setTimeout(() => {\n    //     console.log('ddd')\n    //     svgContainer.style.willChange = \"\";\n    //     setTimeout(() => {\n    //       svgContainer.style.willChange = \"transform\";\n    //     }, 0);\n    //   }, 1000);\n    // }\n    return;\n  }\n  const [minX, minY, width, height] = getCanvasSize(elements, 10);\n  if (!svg) {\n    svg = document.createElementNS(SVG_NS, \"svg\");\n    svg.style.position = \"absolute\";\n    svg.style.background = \"transparent\";\n    svg.setAttribute(\"xmlns\", \"http://www.w3.org/2000/svg\");\n    svg.setAttribute(\"version\", \"1.1\");\n    img = document.createElement(\"img\");\n    img.style.position = \"absolute\";\n    svgContainer.appendChild(img);\n    // svgContainer.appendChild(svg);\n  }\n  svg.setAttribute(\"width\", width);\n  svg.setAttribute(\"height\", height);\n  // svg.style.left = `${minX}px`;\n  // svg.style.top = `${minY}px`;\n  elements.map(function renderToSvg(element, index) {\n    return renderElementToSvg(element, renderConfig, appState, {\n      minX,\n      minY,\n      svg,\n      originChange: _minX !== minX || _minY !== minY,\n    });\n  });\n  _minX = minX;\n  _minY = minY;\n  const base64 = svg2img(svg);\n  img.src = base64;\n  img.style.left = `${minX}px`;\n  img.style.top = `${minY}px`;\n};\n\nconst svg2img = (svg) => {\n  const xml = new XMLSerializer().serializeToString(svg);\n  const svg64 = btoa(xml); //for utf8: btoa(unescape(encodeURIComponent(xml)))\n  const b64start = \"data:image/svg+xml;base64,\";\n  const image64 = b64start + svg64;\n  const img = document.createElement(\"img\");\n  img.src = image64;\n  // document.body.appendChild(img);\n  return image64;\n};\n","import { randomId } from \"@/util\";\nimport { rgb } from \"@/util\";\n\nexport const newElement = ({\n  type,\n  x,\n  y,\n  strokeColor,\n  backgroundColor,\n  fillStyle,\n  strokeWidth = 3,\n  strokeStyle,\n  width = 0,\n  height = 0,\n  angle = 0,\n  points = [],\n  ...rest\n}) => {\n  return {\n    id: randomId(),\n    type,\n    x,\n    y,\n    width,\n    height,\n    strokeColor,\n    backgroundColor,\n    fillStyle,\n    strokeWidth,\n    strokeStyle,\n    angle,\n    isDeleted: false,\n    points,\n    ...rest,\n  };\n};\n\nexport const createElement = ({ elementType, pointerDownState, appState }) => {\n  let element;\n  if (elementType === \"freedraw\") {\n    element = newElement({\n      type: elementType,\n      x: pointerDownState.origin.x,\n      y: pointerDownState.origin.y,\n      points: [[pointerDownState.origin.x, pointerDownState.origin.y]],\n      strokeColor: appState.currentItemStrokeColor,\n      backgroundColor: appState.currentItemBackgroundColor,\n      fillStyle: appState.currentItemFillStyle,\n      strokeWidth: appState.currentItemStrokeWidth,\n      strokeStyle: rgb(),\n    });\n  } else {\n    element = newElement({\n      type: elementType,\n      x: pointerDownState.origin.x,\n      y: pointerDownState.origin.y,\n      strokeColor: appState.currentItemStrokeColor,\n      backgroundColor: appState.currentItemBackgroundColor,\n      fillStyle: appState.currentItemFillStyle,\n      strokeWidth: appState.currentItemStrokeWidth,\n      strokeStyle: rgb(),\n    });\n  }\n\n  return element;\n};\n\nexport const newTextElement = (opts) => {\n  const textElement = newElement({\n    type: \"text\",\n    text: opts.text,\n    fontSize: opts.fontSize,\n    fontFamily: opts.fontFamily,\n    textAlign: opts.textAlign,\n    verticalAlign: opts.verticalAlign,\n    originalText: opts.text,\n    ...opts,\n  });\n\n  return textElement;\n};\n","import { createElement, newTextElement } from \"./element/newElement\";\nimport { rgb } from \"@/util\";\n\nconst getRandomValue = (n, m) => {\n  return Number((Math.random() * (m - n) + n).toFixed(5));\n};\nconst generateElements = (count, type, appState) => {\n  const elements = [];\n  let element;\n  for (let i = 0; i < count; i++) {\n    let x = getRandomValue(\n      -appState.scrollX,\n      appState.canvasWidth - appState.scrollX\n    );\n    let y = getRandomValue(\n      -appState.scrollY,\n      appState.canvasHeight - appState.scrollY\n    );\n    element = createElement({\n      elementType: type,\n      pointerDownState: {\n        origin: {\n          x,\n          y,\n        },\n      },\n      appState,\n    });\n    if (type === \"rectangle\") {\n      const width =\n        Math.abs(\n          getRandomValue(\n            -appState.scrollX - x,\n            appState.canvasWidth - appState.scrollX - x\n          )\n        ) + 2;\n      const height =\n        Math.abs(\n          getRandomValue(\n            -appState.scrollY - y,\n            appState.canvasHeight - appState.scrollY - y\n          )\n        ) + 2;\n      element.width = width;\n      element.height = height;\n    } else if (type === \"freedraw\") {\n      const pointsNum = getRandomValue(20, 100);\n      for (let i = 0; i < pointsNum; i++) {\n        x = getRandomValue(x, x + 10);\n        y = getRandomValue(y, y + 10);\n        element.points.push([x, y]);\n      }\n    } else if (type === \"text\") {\n      const text = `${x}, ${y}`;\n      element = newTextElement({\n        x,\n        y,\n        strokeColor: rgb(),\n        backgroundColor: \"transparent\",\n        fillStyle: \"hachure\",\n        strokeWidth: 1,\n        strokeStyle: \"solid\",\n        text,\n        width: text.length * 20,\n        height: 25,\n        fontSize: 20,\n        fontFamily: \"Virgil\", // Helvetica Cascadia\n        textAlign: \"left\",\n        verticalAlign: \"top\",\n      });\n    }\n\n    elements.push(element);\n  }\n\n  return elements;\n};\n\nexport const animateElements = (elements, appState) => {\n  elements.forEach((el) => {\n    const x = getRandomValue(\n      -appState.scrollX,\n      appState.canvasWidth - appState.scrollX\n    );\n    const y = getRandomValue(\n      -appState.scrollY,\n      appState.canvasHeight - appState.scrollY\n    );\n    el.x = x;\n    el.y = y;\n  });\n  return elements;\n};\nexport default generateElements;\n","// import { getElementAbsoluteCoords, distance } from \"@/util\";\nimport { SVG_NS } from \"./renderScene\";\n\nconst elementCache = {};\nexport const deleteElementCache = (element) => {\n  // delete elementCache[element.id];\n};\n\nexport const clearElementCache = () => {};\n\nexport const renderElementToSvg = (\n  element,\n  renderConfig,\n  appState,\n  { minX, minY, svg, originChange }\n) => {\n  let el;\n  if (\n    !originChange &&\n    elementCache[element.id] &&\n    element !== appState.draggingElement\n  ) {\n    return;\n  }\n\n  switch (element.type) {\n    case \"rectangle\": {\n      const x = element.x - minX + Math.ceil(element.strokeWidth / 2);\n      const y = element.y - minY;\n      el = elementCache[element.id] || document.createElementNS(SVG_NS, \"rect\");\n      // if (\n      //   el.__x === x &&\n      //   el.__y === y &&\n      //   el.__width === element.width &&\n      //   el.__height === element.height\n      // )\n      //   return;\n      el.setAttribute(\"id\", element.id);\n      // console.log('x....', element.x, minX)\n      el.setAttribute(\"x\", x + Math.ceil(element.strokeWidth / 2));\n      el.setAttribute(\"y\", y + Math.ceil(element.strokeWidth / 2));\n      el.setAttribute(\"width\", element.width);\n      el.setAttribute(\"height\", element.height);\n      el.setAttribute(\"fill\", \"none\");\n      el.setAttribute(\"stroke-width\", element.strokeWidth);\n      el.setAttribute(\"stroke\", element.strokeStyle);\n      el.__x = x;\n      el.__y = y;\n      el.__width = element.width;\n      el.__height = element.height;\n      break;\n    }\n    case \"freedraw\": {\n      const points = element.points.map((p) => [\n        p[0] - minX + Math.ceil(element.strokeWidth / 2),\n        p[1] - minY + Math.ceil(element.strokeWidth / 2),\n      ]);\n      el =\n        elementCache[element.id] ||\n        document.createElementNS(SVG_NS, \"polyline\");\n      el.setAttribute(\"id\", element.id);\n      el.setAttribute(\"points\", points.join(\" \"));\n      el.setAttribute(\"fill\", \"none\");\n      el.setAttribute(\"stroke-width\", element.strokeWidth);\n      el.setAttribute(\"stroke\", element.strokeStyle);\n      break;\n    }\n    default: {\n    }\n  }\n  if (!elementCache[element.id]) {\n    elementCache[element.id] = el;\n    svg.appendChild(el);\n  }\n\n  return el;\n};\n","import { useEffect } from \"react\";\nimport { getCenter, getDistance } from \"@/util/gesture\";\nimport { getNormalizedZoom, getStateForZoom } from \"@/util/zoom\";\n\nconst gesture = {\n  pointers: new Map(),\n  lastCenter: null,\n  initialDistance: null,\n  initialScale: null,\n};\n\nexport const useGesture = (canvasRef, appState) => {\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const onTouchEnd = (event) => {\n      if (!event.touches.length) {\n        gesture.pointers.clear();\n      }\n    };\n    canvas.addEventListener(\"touchend\", onTouchEnd);\n    return () => {\n      canvas.removeEventListener(\"touchend\", onTouchEnd);\n    };\n  }, [canvasRef]);\n  const removePointer = (event) => {\n    gesture.pointers.delete(event.pointerId);\n  };\n  const updateGestureOnPointerDown = (event) => {\n    gesture.pointers.set(event.pointerId, {\n      x: event.clientX,\n      y: event.clientY,\n    });\n\n    if (gesture.pointers.size === 2) {\n      gesture.lastCenter = getCenter(gesture.pointers);\n      gesture.initialScale = appState.zoom.value;\n      gesture.initialDistance = getDistance(\n        Array.from(gesture.pointers.values())\n      );\n    }\n  };\n  const handleCanvasPointerMove = (event, callback) => {\n    if (gesture.pointers.has(event.pointerId)) {\n      gesture.pointers.set(event.pointerId, {\n        x: event.clientX,\n        y: event.clientY,\n      });\n    }\n    const initialScale = gesture.initialScale;\n\n    if (\n      gesture.pointers.size === 2 &&\n      gesture.lastCenter &&\n      initialScale &&\n      gesture.initialDistance\n    ) {\n      const center = getCenter(gesture.pointers);\n      const deltaX = center.x - gesture.lastCenter.x;\n      const deltaY = center.y - gesture.lastCenter.y;\n      gesture.lastCenter = center;\n\n      const distance = getDistance(Array.from(gesture.pointers.values()));\n      const scaleFactor = distance / gesture.initialDistance;\n\n      const nextZoom = scaleFactor\n        ? getNormalizedZoom(initialScale * scaleFactor)\n        : appState.zoom.value;\n      const zoomState = getStateForZoom(\n        {\n          viewportX: center.x,\n          viewportY: center.y,\n          nextZoom,\n        },\n        appState\n      );\n      Object.assign(appState, {\n        zoom: zoomState.zoom,\n        scrollX: zoomState.scrollX + deltaX / nextZoom,\n        scrollY: zoomState.scrollY + deltaY / nextZoom,\n      });\n      callback();\n    } else {\n      gesture.lastCenter =\n        gesture.initialDistance =\n        gesture.initialScale =\n          null;\n    }\n  };\n  return {\n    gesture,\n    removePointer,\n    updateGestureOnPointerDown,\n    handleCanvasPointerMove,\n  };\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"tools\":\"index_tools__uJKGs\",\"item\":\"index_item__2AP8f\",\"selected\":\"index_selected__1ona6\"};","export const createIcon = (d, opts) => {\n  const {\n    width = 512,\n    height = width,\n    mirror,\n    style,\n    ...rest\n  } = typeof opts === \"number\" ? { width: opts } : opts;\n  return (\n    <svg\n      aria-hidden=\"true\"\n      focusable=\"false\"\n      role=\"img\"\n      viewBox={`0 0 ${width} ${height}`}\n      style={style}\n      {...rest}\n    >\n      {typeof d === \"string\" ? <path fill=\"currentColor\" d={d} /> : d}\n    </svg>\n  );\n};\n\nconst tablerIconProps = {\n  width: 24,\n  height: 24,\n  fill: \"none\",\n  strokeWidth: 2,\n  stroke: \"currentColor\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n};\nexport const RectangleIcon = createIcon(\n  <g strokeWidth=\"1.5\">\n    <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" />\n    <rect x=\"4\" y=\"4\" width=\"16\" height=\"16\" rx=\"2\"></rect>\n  </g>,\n  {\n    width: 24,\n    height: 24,\n    fill: \"none\",\n    strokeWidth: 2,\n    stroke: \"currentColor\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n  }\n);\n\nexport const FreedrawIcon = createIcon(\n  <g strokeWidth=\"1.25\">\n    <path\n      clipRule=\"evenodd\"\n      d=\"m7.643 15.69 7.774-7.773a2.357 2.357 0 1 0-3.334-3.334L4.31 12.357a3.333 3.333 0 0 0-.977 2.357v1.953h1.953c.884 0 1.732-.352 2.357-.977Z\"\n    />\n    <path d=\"m11.25 5.417 3.333 3.333\" />\n  </g>,\n  {\n    width: 20,\n    height: 20,\n    fill: \"none\",\n    stroke: \"currentColor\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n  }\n);\n\nexport const ExportImageIcon = createIcon(\n  <g strokeWidth=\"1.25\">\n    <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path>\n    <path d=\"M15 8h.01\"></path>\n    <path d=\"M12 20h-5a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v5\"></path>\n    <path d=\"M4 15l4 -4c.928 -.893 2.072 -.893 3 0l4 4\"></path>\n    <path d=\"M14 14l1 -1c.617 -.593 1.328 -.793 2.009 -.598\"></path>\n    <path d=\"M19 16v6\"></path>\n    <path d=\"M22 19l-3 3l-3 -3\"></path>\n  </g>,\n  tablerIconProps\n);\n\nconst modifiedTablerIconProps = {\n  width: 20,\n  height: 20,\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n};\nexport const ZoomInIcon = createIcon(\n  <path strokeWidth=\"1.25\" d=\"M10 4.167v11.666M4.167 10h11.666\" />,\n  modifiedTablerIconProps\n);\n\nexport const ZoomOutIcon = createIcon(\n  <path d=\"M5 10h10\" strokeWidth=\"1.25\" />,\n  modifiedTablerIconProps\n);\n","class Scene {\n  constructor() {\n    const elements = JSON.parse(localStorage.getItem('elements'))\n    this.elements = elements || [];\n  }\n  getElementsIncludingDeleted() {\n    return this.elements;\n  }\n  replaceAllElements(nextElements) {\n    this.elements = nextElements;\n  }\n}\n\nexport const scene = new Scene();\n\nexport default Scene;\n","import React, { memo } from \"react\";\nimport styles from \"./index.module.less\";\nimport { RectangleIcon, FreedrawIcon, ExportImageIcon } from \"../icons\";\nimport { exportPng } from \"@/util/export\";\nimport { renderScene } from \"../../renderer\";\nimport { scene } from \"../../scene/scene\";\nimport { appState } from \"../../index\";\n\nconst SHAPES = [\n  {\n    type: \"rectangle\",\n    icon: RectangleIcon,\n  },\n  {\n    type: \"freedraw\",\n    icon: FreedrawIcon,\n  },\n];\nconst Index = memo(({ activeTool, onActiveToolChange }) => {\n  return (\n    <div className={styles.tools}>\n      <span\n        className={[styles.item].join(\" \")}\n        onClick={() => {\n          exportPng({\n            renderScene,\n            elements: scene.getElementsIncludingDeleted(),\n            appState,\n          });\n        }}\n      >\n        {ExportImageIcon}\n      </span>\n      {SHAPES.map((shape) => {\n        const isSelected = activeTool.type === shape.type;\n        return (\n          <span\n            key={shape.type}\n            className={[styles.item, isSelected && styles.selected].join(\" \")}\n            onClick={() =>\n              onActiveToolChange({ type: isSelected ? \"\" : shape.type })\n            }\n          >\n            {shape.icon}\n          </span>\n        );\n      })}\n    </div>\n  );\n});\n\nexport default Index;\n","// extracted by mini-css-extract-plugin\nexport default {\"scale\":\"index_scale__Gm0Zi\",\"item\":\"index_item__0PdRb\",\"value\":\"index_value__UbAZm\"};","import React, { memo } from \"react\";\nimport { ZoomInIcon, ZoomOutIcon } from \"../icons\";\nimport { getNormalizedZoom } from \"@/util/zoom\";\nimport styles from \"./index.module.less\";\n\nconst ZOOM_STEP = 0.1;\nconst Scale = memo(({ appState, onZoomChange }) => {\n  const zoomValue = `${(appState.zoom.value * 100).toFixed(0)}%`;\n\n  return (\n    <div className={styles.scale}>\n      <span\n        className={[styles.item].join(\" \")}\n        onClick={() =>\n          onZoomChange(getNormalizedZoom(appState.zoom.value - ZOOM_STEP))\n        }\n      >\n        {ZoomOutIcon}\n      </span>\n      <span\n        className={styles.value}\n        onClick={() => onZoomChange(getNormalizedZoom(1))}\n      >\n        {zoomValue}\n      </span>\n      <span\n        className={[styles.item].join(\" \")}\n        onClick={() =>\n          onZoomChange(getNormalizedZoom(appState.zoom.value + ZOOM_STEP))\n        }\n      >\n        {ZoomInIcon}\n      </span>\n    </div>\n  );\n});\n\nexport default Scale;\n","// extracted by mini-css-extract-plugin\nexport default {\"layer\":\"index_layer__Cpe5s\",\"ball_red\":\"index_ball_red__VfRx+\",\"move\":\"index_move__-UAWO\",\"boundceBall\":\"index_boundceBall__CXRXz\",\"shadowball\":\"index_shadowball__FMJKb\",\"shadowMove\":\"index_shadowMove__lwd69\"};","import React, { memo } from \"react\";\nimport Tools from \"../tools\";\nimport Scale from \"../scale\";\nimport styles from \"./index.module.less\";\nconst LayerUI = memo(\n  ({ activeTool, onActiveToolChange, appState, onZoomChange }) => {\n    return (\n      <div className={styles.layer}>\n        <Scale appState={appState} onZoomChange={onZoomChange} />\n        <Tools\n          activeTool={activeTool}\n          onActiveToolChange={onActiveToolChange}\n        />\n        <div className={styles.boundceBall}>\n          <div className={styles.ball_red}></div>\n          <div className={styles.shadowball}></div>\n        </div>\n      </div>\n    );\n  }\n);\n\nexport default LayerUI;\n","// extracted by mini-css-extract-plugin\nexport default {\"textarea\":\"index_textarea__vpld+\",\"textarea_copy\":\"index_textarea_copy__6zBT5\"};","import React, {\n  memo,\n  useState,\n  useRef,\n  forwardRef,\n  useImperativeHandle,\n} from \"react\";\nimport { deleteElementCache, renderScene } from \"../../renderer\";\nimport { viewportCoordsToSceneCoords, rgb, getFontString } from \"@/util\";\nimport { newTextElement } from \"../../element/newElement\";\nimport { scene } from \"../../scene/scene\";\nimport { appState } from \"../../index\";\nimport styles from \"./index.module.less\";\n\nconst Index = forwardRef(({ staticCanvasRef }, ref) => {\n  const textareaRef = useRef(null);\n  const [textareaValue, setTextAreaValue] = useState(\"\");\n  useImperativeHandle(ref, () => ({\n    startEditText: (event) => {\n      event.preventDefault();\n      event.stopPropagation();\n      let { x: sceneX, y: sceneY } = viewportCoordsToSceneCoords(\n        event,\n        appState\n      );\n      const element = newTextElement({\n        x: sceneX,\n        y: sceneY,\n        strokeColor: rgb(),\n        backgroundColor: \"transparent\",\n        fillStyle: \"hachure\",\n        strokeWidth: 1,\n        strokeStyle: \"solid\",\n        text: \"\",\n        fontSize: 20,\n        fontFamily: \"Virgil\", // Helvetica Cascadia\n        textAlign: \"left\",\n        verticalAlign: \"top\",\n      });\n      appState.draggingElement = element;\n      const textarea = textareaRef.current;\n      textarea.focus();\n      const left = event.clientX - appState.offsetLeft;\n      const top = event.clientY - appState.offsetTop;\n      const styleObj = {\n        font: getFontString(element),\n        left: `${left}px`,\n        top: `${top}px`,\n        opacity: 1,\n        color: element.strokeColor,\n        fontSize: element.fontSize,\n      };\n      Object.assign(textarea.style, styleObj);\n      const copyTextarea = document.getElementById(\"copyText\");\n      Object.assign(copyTextarea.style, styleObj);\n      // 输入框限制最大宽度，防止输入的文字超出画布宽度\n      const maxWidth = appState.canvasWidth - left;\n      // textarea.style.maxWidth = `${maxWidth}px`;\n      // textarea.style.width = `${element.fontSize}px`;\n      // textarea.style.height = `${element.fontSize * 1.2}px`;\n      Object.assign(textarea.style, {\n        zIndex: 1,\n        maxWidth: `${maxWidth}px`,\n        width: `${element.fontSize}px`,\n        height: `${element.fontSize * 1.2}px`,\n      });\n    },\n  }));\n  return (\n    <>\n      <textarea\n        onChange={(e) => {\n          let text = e.target.value;\n          const textarea = textareaRef.current;\n          const maxWidth = parseFloat(textarea.style.maxWidth);\n\n          const copyTextarea = document.getElementById(\"copyText\");\n          copyTextarea.innerText = text;\n          const copyTextWidth = copyTextarea.getBoundingClientRect().width;\n          if (copyTextWidth > maxWidth) {\n            // 正常输入的情况下，两者的差值不会太大，只有粘贴进来的文本才会导致\n            // copy text宽度突然增大\n            if (copyTextWidth - maxWidth < 30) {\n              text = copyTextarea.innerText =\n                text.slice(0, text.length - 1) +\n                \"\\n\" +\n                text.slice(text.length - 1);\n            } else {\n              let lines = text.split(\"\\n\");\n              const splitResult = [];\n              lines.forEach((line) => {\n                copyTextarea.innerText = line;\n                const copyTextWidth =\n                  copyTextarea.getBoundingClientRect().width;\n                if (copyTextWidth <= maxWidth) {\n                  splitResult.push(line);\n                } else {\n                  let lastIdx = 0;\n                  for (let i = 1; i < line.length; i++) {\n                    const str = line.slice(lastIdx, i);\n                    copyTextarea.innerText = str;\n                    const copyTextWidth =\n                      copyTextarea.getBoundingClientRect().width;\n                    if (copyTextWidth > maxWidth) {\n                      splitResult.push(line.slice(lastIdx, i - 1));\n                      lastIdx = i - 1;\n                    } else if (i === line.length - 1) {\n                      splitResult.push(line.slice(lastIdx, i));\n                    }\n                  }\n                }\n              });\n              text = splitResult.join(\"\\n\");\n              copyTextarea.innerText = text;\n            }\n          }\n\n          setTextAreaValue(text);\n          const { width, height } = copyTextarea.getBoundingClientRect();\n          textarea.style.width = `${width + 30}px`;\n          textarea.style.height = `${height}px`;\n\n          appState.draggingElement.text = text;\n        }}\n        onBlur={() => {\n          const element = appState.draggingElement;\n          const textarea = textareaRef.current;\n          const copyTextarea = document.getElementById(\"copyText\");\n          if (element.text) {\n            element.width = copyTextarea.offsetWidth;\n            element.height = copyTextarea.offsetHeight;\n            deleteElementCache(appState.draggingElement);\n            scene.replaceAllElements([\n              ...scene.getElementsIncludingDeleted(),\n              appState.draggingElement,\n            ]);\n            renderScene({\n              elements: scene.getElementsIncludingDeleted(),\n              appState: appState,\n              scale: window.devicePixelRatio,\n              canvas: staticCanvasRef.current,\n              renderConfig: {\n                selectionColor: \"#6965db\",\n                scrollX: appState.scrollX,\n                scrollY: appState.scrollY,\n                viewBackgroundColor: \"#ffffff\",\n                zoom: appState.zoom,\n              },\n            });\n            setTimeout(() => {\n              copyTextarea.innerText = \"\";\n              setTextAreaValue(\"\");\n            }, 200);\n          }\n          Object.assign(textarea.style, {\n            left: `0px`,\n            top: `0px`,\n            zIndex: -1,\n            opacity: 0,\n          });\n        }}\n        value={textareaValue}\n        className={styles.textarea}\n        ref={textareaRef}\n      ></textarea>\n      <div\n        style={{ background: \"grey\" }}\n        id=\"copyText\"\n        contentEditable={true}\n        className={[styles.textarea, styles.textarea_copy].join(\" \")}\n      ></div>\n    </>\n  );\n});\n\nexport default memo(Index);\n","import React, { memo, useRef, useEffect, useState } from \"react\";\nimport { distance } from \"@/util\";\n// import { isAndroid } from \"@/util/device\";\nimport {\n  withBatchedUpdatesThrottled,\n  viewportCoordsToSceneCoords,\n} from \"@/util\";\nimport { getNormalizedZoom, getStateForZoom } from \"@/util/zoom\";\nimport generateElements, { animateElements } from \"./generateElement\";\nimport { createElement } from \"./element/newElement\";\nimport { renderScene } from \"./renderer\";\nimport { useGesture } from \"./useGesture\";\nimport { \n  deleteElementCache, \n  // clearElementCache\n } from \"./renderer\";\nimport LayerUI from \"./components/layer-ui\";\nimport TextArea from \"./components/textarea\";\nimport { scene } from \"./scene/scene\";\nimport \"./index.less\";\nconst temp = JSON.parse(localStorage.getItem(\"appState\"));\nexport let appState = temp || {\n  zoom: { value: 1 },\n  scrollX: 0,\n  scrollY: 0,\n  offsetLeft: 0,\n  offsetTop: 0,\n  draggingElement: null,\n  canvasWidth: 0,\n  canvasHeight: 0,\n};\nconst ZOOM_STEP = 0.1;\n\nconst Canvas = memo(() => {\n  const canvasRef = useRef(null);\n  const canvasContainer = useRef(null);\n  const staticCanvasRef = useRef(null);\n  const svgContainerRef = useRef(null);\n  const cursorPosition = useRef({});\n  const textareaRef = useRef(null);\n  const rafRef = useRef(null);\n  const globalVarRef = useRef({});\n  const [flag, refreshFlag] = useState(false);\n  const [activeTool, setActiveTool] = useState({ type: \"\" });\n  const [testObj, setTestObj] = useState({ count: \"\", type: \"rectangle\" });\n  const [animate, setAnimate] = useState(false);\n  const willChangeRef = useRef(false);\n  const animateRef = useRef();\n  const refresh = () => {\n    refreshFlag(!flag);\n  };\n  useEffect(() => {\n    const setCanvasSize = (canvas) => {\n      canvas.width = offsetWidth * window.devicePixelRatio;\n      canvas.height = offsetHeight * window.devicePixelRatio;\n    };\n\n    // canvas分辨率矫正\n    const canvas = canvasRef.current;\n    const { offsetWidth, offsetHeight } = canvas;\n    setCanvasSize(canvas);\n    setCanvasSize(staticCanvasRef.current);\n\n    const { x, y } = canvas.getBoundingClientRect();\n    appState.offsetLeft = x;\n    appState.offsetTop = y;\n    appState.canvasWidth = offsetWidth;\n    appState.canvasHeight = offsetHeight;\n\n    // 绘制静态canvas\n    renderScene({\n      elements: scene.getElementsIncludingDeleted(),\n      appState: appState,\n      scale: window.devicePixelRatio,\n      canvas: staticCanvasRef.current,\n      svg: svgContainerRef.current,\n      renderConfig: {\n        selectionColor: \"#6965db\",\n        scrollX: appState.scrollX,\n        scrollY: appState.scrollY,\n        viewBackgroundColor: \"#ffffff\",\n        zoom: appState.zoom,\n        accelerate: willChangeRef.current\n      },\n    });\n  }, []);\n  useEffect(() => {\n    const wrap = canvasContainer.current;\n    const handleWheel = (e) => {\n      e.preventDefault();\n    };\n    // 防止双指滑动时切换页面\n    wrap.addEventListener(\"wheel\", handleWheel, {\n      passive: false,\n    });\n    const updateCurrentCursorPosition = (event) => {\n      cursorPosition.current = {\n        cursorX: event.clientX,\n        cursorY: event.clientY,\n      };\n    };\n    const onTapStart = (e) => {\n      e.preventDefault();\n    };\n    const canvas = canvasRef.current;\n    canvas.addEventListener(\"touchstart\", onTapStart);\n    document.addEventListener(\"mousemove\", updateCurrentCursorPosition);\n    return () => {\n      canvas.removeEventListener(\"touchstart\", onTapStart);\n\n      wrap.removeEventListener(\"wheel\", handleWheel);\n      document.removeEventListener(\"mousemove\", updateCurrentCursorPosition);\n    };\n  }, []);\n  useEffect(() => {\n    let frame = 0;\n    let startTime = Date.now();\n\n    const loop = () => {\n      const currentTime = Date.now();\n      frame++;\n\n      if (currentTime > 1000 + startTime) {\n        const fps = Math.round((frame * 1000) / (currentTime - startTime));\n        rafRef.current.innerText = `FPS：${fps}`;\n        frame = 0;\n        startTime = currentTime;\n      }\n\n      requestAnimationFrame(loop);\n    };\n\n    loop();\n  }, []);\n  const {\n    updateGestureOnPointerDown,\n    handleCanvasPointerMove,\n    removePointer,\n    gesture,\n  } = useGesture(canvasRef, appState);\n  const reDrawAfterZoom = () => {\n    renderScene({\n      elements: scene.getElementsIncludingDeleted(),\n      appState: appState,\n      scale: window.devicePixelRatio,\n      canvas: staticCanvasRef.current,\n      svg: svgContainerRef.current,\n      isTransform: true,\n      renderConfig: {\n        selectionColor: \"#6965db\",\n        scrollX: appState.scrollX,\n        scrollY: appState.scrollY,\n        viewBackgroundColor: \"#ffffff\",\n        zoom: appState.zoom,\n        accelerate: willChangeRef.current\n      },\n    });\n    if (globalVarRef.current.zoomTimerId) {\n      clearTimeout(globalVarRef.current.zoomTimerId);\n    }\n    globalVarRef.current.zoomTimerId = setTimeout(() => {\n      // clearElementCache();\n      renderScene({\n        elements: scene.getElementsIncludingDeleted(),\n        appState: appState,\n        scale: window.devicePixelRatio,\n        canvas: staticCanvasRef.current,\n        svg: svgContainerRef.current,\n        isTransform: true,\n        renderConfig: {\n          selectionColor: \"#6965db\",\n          scrollX: appState.scrollX,\n          scrollY: appState.scrollY,\n          viewBackgroundColor: \"#ffffff\",\n          zoom: appState.zoom,\n          accelerate: willChangeRef.current\n        },\n      });\n    }, 300);\n  };\n  const handleCanvasWheel = (event) => {\n    const { deltaX, deltaY } = event;\n    // 关于缩放：双指放大时，deltaY是负数，缩小时，deltaY是正数\n    // 缩放，本质上就是对某个点的坐标进行变换\n    if (event.metaKey || event.ctrlKey) {\n      const sign = Math.sign(deltaY); // 只有两种情况，要么+1，要么-1\n      const MAX_STEP = ZOOM_STEP * 100; // 10\n      const absDelta = Math.abs(deltaY);\n      let delta = deltaY;\n      // delta最大为10\n      if (absDelta > MAX_STEP) {\n        delta = MAX_STEP * sign;\n      }\n      let newZoom = appState.zoom.value - delta / 100;\n      newZoom +=\n        Math.log10(Math.max(1, appState.zoom.value)) *\n        -sign *\n        Math.min(1, absDelta / 20);\n      const nextZoom = getNormalizedZoom(newZoom);\n      Object.assign(appState, {\n        ...getStateForZoom(\n          {\n            viewportX: cursorPosition.current.cursorX,\n            viewportY: cursorPosition.current.cursorY,\n            nextZoom: nextZoom,\n          },\n          appState\n        ),\n      });\n      refresh();\n      reDrawAfterZoom();\n      return;\n    }\n    appState.scrollX = appState.scrollX - deltaX;\n    appState.scrollY = appState.scrollY - deltaY;\n\n    // 在滚动画布的过程中，只绘制底层的canvas\n    renderScene({\n      elements: scene.getElementsIncludingDeleted(),\n      isTransform: true,\n      appState: appState,\n      scale: window.devicePixelRatio,\n      canvas: staticCanvasRef.current,\n      svg: svgContainerRef.current,\n      renderConfig: {\n        selectionColor: \"#6965db\",\n        scrollX: appState.scrollX,\n        scrollY: appState.scrollY,\n        viewBackgroundColor: \"#ffffff\",\n        zoom: appState.zoom,\n        accelerate: willChangeRef.current\n      },\n    });\n  };\n\n  const handleCanvasPointerDown = (event) => {\n    if (gesture.pointers.size > 1) {\n      return;\n    }\n    if (!activeTool.type) {\n      updateGestureOnPointerDown(event);\n      return;\n    }\n    const pointerDownState = initialPointerDownState(event);\n    const element = createElement({\n      elementType: activeTool.type,\n      pointerDownState,\n      appState,\n    });\n    appState.draggingElement = element;\n    deleteElementCache(element);\n    scene.replaceAllElements([\n      ...scene.getElementsIncludingDeleted(),\n      appState.draggingElement,\n    ]);\n    const onPointerMove =\n      onPointerMoveFromCanvasPointerDownHandler(pointerDownState);\n    const onPointerUp =\n      onPointerUpFromCanvasPointerDownHandler(pointerDownState);\n    window.addEventListener(\"pointermove\", onPointerMove);\n    window.addEventListener(\"pointerup\", onPointerUp);\n    pointerDownState.eventListeners.onMove = onPointerMove;\n    pointerDownState.eventListeners.onUp = onPointerUp;\n  };\n\n  const onPointerMoveFromCanvasPointerDownHandler = (pointerDownState) =>\n    withBatchedUpdatesThrottled((event) => {\n      const pointerCoords = viewportCoordsToSceneCoords(event, appState);\n      pointerDownState.lastCoords.x = pointerCoords.x;\n      pointerDownState.lastCoords.y = pointerCoords.y;\n      if (activeTool.type === \"freedraw\") {\n        appState.draggingElement.points.push([\n          pointerCoords.x,\n          pointerCoords.y,\n        ]);\n      } else {\n        const pointerCoords = pointerDownState.lastCoords;\n        const originX = pointerDownState.origin.x;\n        const originY = pointerDownState.origin.y;\n        const x = pointerCoords.x;\n        const y = pointerCoords.y;\n        const width = distance(pointerDownState.origin.x, pointerCoords.x);\n        const height = distance(pointerDownState.origin.y, pointerCoords.y);\n        let newX = x < originX ? originX - width : originX;\n        let newY = y < originY ? originY - height : originY;\n        appState.draggingElement.x = newX;\n        appState.draggingElement.y = newY;\n        appState.draggingElement.width = width;\n        appState.draggingElement.height = height;\n      }\n      deleteElementCache(appState.draggingElement);\n      renderScene({\n        elements: scene.getElementsIncludingDeleted(),\n        appState: appState,\n        scale: window.devicePixelRatio,\n        canvas: staticCanvasRef.current,\n        svg: svgContainerRef.current,\n        renderConfig: {\n          selectionColor: \"#6965db\",\n          scrollX: appState.scrollX,\n          scrollY: appState.scrollY,\n          viewBackgroundColor: \"#ffffff\",\n          zoom: appState.zoom,\n          accelerate: willChangeRef.current\n        },\n      });\n    });\n\n  const onPointerUpFromCanvasPointerDownHandler =\n    (pointerDownState) => (event) => {\n      // deleteElementCache(appState.draggingElement);\n      removePointer(event);\n      // scene.replaceAllElements([\n      //   ...scene.getElementsIncludingDeleted(),\n      //   appState.draggingElement,\n      // ]);\n\n      // 鼠标抬起后，先清空顶层的cavans\n      const canvas = canvasRef.current;\n      const context = canvas.getContext(\"2d\");\n      context.clearRect(0, 0, canvas.width, canvas.height);\n      // 重绘底层canvas\n      renderScene({\n        elements: scene.getElementsIncludingDeleted(),\n        appState: appState,\n        scale: window.devicePixelRatio,\n        canvas: staticCanvasRef.current,\n        svg: svgContainerRef.current,\n        renderConfig: {\n          selectionColor: \"#6965db\",\n          scrollX: appState.scrollX,\n          scrollY: appState.scrollY,\n          viewBackgroundColor: \"#ffffff\",\n          zoom: appState.zoom,\n          accelerate: willChangeRef.current\n        },\n      });\n      window.removeEventListener(\n        \"pointermove\",\n        pointerDownState.eventListeners.onMove\n      );\n      window.removeEventListener(\n        \"pointerup\",\n        pointerDownState.eventListeners.onUp\n      );\n    };\n\n  const initialPointerDownState = (event) => {\n    const origin = viewportCoordsToSceneCoords(event, appState);\n    return {\n      origin,\n      lastCoords: { ...origin },\n      eventListeners: {\n        onMove: null,\n        onUp: null,\n        onKeyUp: null,\n        onKeyDown: null,\n      },\n    };\n  };\n\n  const handleCanvasDoubleClick = (event) => {\n    if (activeTool.type) return;\n    // 创建新的文本元素\n    textareaRef.current.startEditText(event);\n  };\n  return (\n    <div className=\"svg-base\" ref={canvasContainer}>\n      {/* <div className=\"refer\">\n        参照物\n      </div> */}\n      <div className=\"container wrap\">\n        <div className=\"svg-container\" ref={svgContainerRef}></div>\n        <canvas ref={staticCanvasRef} className=\"canvas\">\n          静态canvas\n        </canvas>\n        <canvas\n          ref={canvasRef}\n          className=\"canvas draw\"\n          onWheel={handleCanvasWheel}\n          onPointerDown={handleCanvasPointerDown}\n          onDoubleClick={handleCanvasDoubleClick}\n          onPointerCancel={removePointer}\n          onPointerMove={(event) => {\n            handleCanvasPointerMove(event, () => {\n              refresh();\n              reDrawAfterZoom();\n            });\n          }}\n        >\n          动态canvas\n        </canvas>\n        <LayerUI\n          activeTool={activeTool}\n          onZoomChange={(zoomVal) => {\n            if (appState.zoom.value === zoomVal) return;\n            Object.assign(appState, {\n              ...getStateForZoom(\n                {\n                  viewportX: appState.canvasWidth / 2 + appState.offsetLeft,\n                  viewportY: appState.canvasHeight / 2 + appState.offsetTop,\n                  nextZoom: zoomVal,\n                },\n                appState\n              ),\n            });\n            refresh();\n            reDrawAfterZoom();\n          }}\n          appState={{ ...appState }}\n          onActiveToolChange={(value) => {\n            setActiveTool(value);\n          }}\n        />\n        <TextArea ref={textareaRef} staticCanvasRef={staticCanvasRef} />\n      </div>\n      <div>\n        <span ref={rafRef}>FPS：--</span>\n        <span className=\"total\" id=\"canvas-total\"></span>\n        {/* <span className=\"willchange\">\n          <input\n            type=\"checkbox\"\n            checked={willChangeRef.current}\n            onChange={(e) => {\n              refresh();\n              willChangeRef.current = e.target.checked;\n            }}\n          />\n          开启硬件加速\n        </span> */}\n      </div>\n      <div className=\"row\">\n        <input\n          type=\"number\"\n          value={testObj.count}\n          onChange={(e) => setTestObj({ ...testObj, count: e.target.value })}\n        />\n        <select\n          value={testObj.type}\n          onChange={(e) => setTestObj({ ...testObj, type: e.target.value })}\n        >\n          <option value=\"freedraw\">freedraw</option>\n          <option value=\"rectangle\">rectangle</option>\n          <option value=\"text\">text</option>\n        </select>\n        <button\n          onClick={() => {\n            const elements = generateElements(\n              Number(testObj.count),\n              testObj.type,\n              appState\n            );\n            scene.replaceAllElements([\n              ...scene.getElementsIncludingDeleted(),\n              ...elements,\n            ]);\n            renderScene({\n              elements: scene.getElementsIncludingDeleted(),\n              appState: appState,\n              scale: window.devicePixelRatio,\n              canvas: staticCanvasRef.current,\n              svg: svgContainerRef.current,\n              renderConfig: {\n                selectionColor: \"#6965db\",\n                scrollX: appState.scrollX,\n                scrollY: appState.scrollY,\n                viewBackgroundColor: \"#ffffff\",\n                zoom: appState.zoom,\n                accelerate: willChangeRef.current\n              },\n            });\n          }}\n        >\n          生成\n        </button>\n        <button\n          onClick={() => {\n            setAnimate(!animate);\n            if (animateRef.current) {\n              cancelAnimationFrame(animateRef.current);\n            }\n            if (animate) return;\n            let diffTime = 100;\n            let lastDate = Date.now();\n            const tick = () => {\n              const currentDate = Date.now();\n              if (currentDate - lastDate >= diffTime) {\n                lastDate = currentDate;\n                const elements = animateElements(\n                  scene.getElementsIncludingDeleted(),\n                  appState\n                );\n                renderScene({\n                  elements: elements,\n                  appState: appState,\n                  scale: window.devicePixelRatio,\n                  canvas: staticCanvasRef.current,\n                  svg: svgContainerRef.current,\n                  renderConfig: {\n                    selectionColor: \"#6965db\",\n                    scrollX: appState.scrollX,\n                    scrollY: appState.scrollY,\n                    viewBackgroundColor: \"#ffffff\",\n                    zoom: appState.zoom,\n                    accelerate: willChangeRef.current\n                  },\n                });\n              }\n\n              animateRef.current = requestAnimationFrame(tick);\n            };\n            animateRef.current = requestAnimationFrame(tick);\n          }}\n        >\n          {animate ? \"停止动画\" : \"动画\"}\n        </button>\n      </div>\n      <div id=\"placeholder\"></div>\n    </div>\n  );\n});\n\nexport default Canvas;\n","import { getCommonBounds, distance } from \"./index\";\nexport const getCanvasSize = (elements, exportPadding) => {\n  const [minX, minY, maxX, maxY] = getCommonBounds(elements);\n  const width = distance(minX, maxX) + exportPadding * 2;\n  const height = distance(minY, maxY) + exportPadding + exportPadding;\n\n  return [minX, minY, width, height];\n};\nexport const canvasToDataURL = ({\n  renderScene,\n  isExport,\n  notUseCache,\n  elements,\n  appState,\n}) => {\n  const exportPadding = 10;\n  const [minX, minY, width, height] = getCanvasSize(elements, exportPadding);\n\n  const canvas = document.createElement(\"canvas\");\n  canvas.width = width * window.devicePixelRatio;\n  canvas.height = height * window.devicePixelRatio;\n  renderScene({\n    elements,\n    appState: {\n      ...appState,\n      scrollX: -minX + exportPadding,\n      scrollY: -minY + exportPadding,\n    },\n    scale: window.devicePixelRatio,\n    canvas: canvas,\n    renderConfig: {\n      selectionColor: \"#6965db\",\n      scrollX: -minX + exportPadding,\n      scrollY: -minY + exportPadding,\n      viewBackgroundColor: \"#ffffff\",\n      zoom: { value: 1 },\n      isExport,\n      notUseCache,\n    },\n  });\n\n  return canvas.toDataURL();\n};\nexport const exportPng = ({\n  renderScene,\n  isExport = true,\n  notUseCache = true,\n  elements,\n  appState,\n}) => {\n  const dataUrl = canvasToDataURL({\n    renderScene,\n    isExport,\n    notUseCache,\n    elements,\n    appState,\n  });\n  var a = document.createElement(\"a\");\n  a.href = dataUrl;\n  a.download = \"canvas.png\";\n  a.click();\n};\n","export const getCenter = (pointers) => {\n  const allCoords = Array.from(pointers.values());\n  return {\n    x: sum(allCoords, (coords) => coords.x) / allCoords.length,\n    y: sum(allCoords, (coords) => coords.y) / allCoords.length,\n  };\n};\n\nexport const getDistance = ([a, b]) => Math.hypot(a.x - b.x, a.y - b.y);\n\nconst sum = (array, mapper) =>\n  array.reduce((acc, item) => acc + mapper(item), 0);\n","import { unstable_batchedUpdates } from \"react-dom\";\n\nexport const sceneCoordsToViewportCoords = (\n  { sceneX, sceneY },\n  { offsetLeft, offsetTop, scrollX, scrollY }\n) => {\n  const x = sceneX + scrollX + offsetLeft;\n  const y = sceneY + scrollY + offsetTop;\n  return { x, y };\n};\nexport const viewportCoordsToSceneCoords = (\n  { clientX, clientY },\n  { zoom, offsetLeft, offsetTop, scrollX, scrollY }\n) => {\n  const zoomValue = zoom ? zoom.value : 1;\n  const x = (clientX - offsetLeft) / zoomValue - scrollX;\n  const y = (clientY - offsetTop) / zoomValue - scrollY;\n  return { x, y };\n};\n\n//rgb颜色随机\nexport const rgb = () => {\n  const r = Math.floor(Math.random() * 256);\n  const g = Math.floor(Math.random() * 256);\n  const b = Math.floor(Math.random() * 256);\n  return `rgb(${r},${g},${b})`;\n};\n\nexport const throttleRAF = (fn, opts) => {\n  let timerId = null;\n  let lastArgs = null;\n  let lastArgsTrailing = null;\n\n  const scheduleFunc = (args) => {\n    timerId = window.requestAnimationFrame(() => {\n      timerId = null;\n      fn(...args);\n      lastArgs = null;\n      if (lastArgsTrailing) {\n        lastArgs = lastArgsTrailing;\n        lastArgsTrailing = null;\n        scheduleFunc(lastArgs);\n      }\n    });\n  };\n\n  const ret = (...args) => {\n    if (process.env.NODE_ENV === \"test\") {\n      fn(...args);\n      return;\n    }\n    lastArgs = args;\n    if (timerId === null) {\n      scheduleFunc(lastArgs);\n    } else if (opts?.trailing) {\n      lastArgsTrailing = args;\n    }\n  };\n  ret.flush = () => {\n    if (timerId !== null) {\n      cancelAnimationFrame(timerId);\n      timerId = null;\n    }\n    if (lastArgs) {\n      fn(...(lastArgsTrailing || lastArgs));\n      lastArgs = lastArgsTrailing = null;\n    }\n  };\n  ret.cancel = () => {\n    lastArgs = lastArgsTrailing = null;\n    if (timerId !== null) {\n      cancelAnimationFrame(timerId);\n      timerId = null;\n    }\n  };\n  return ret;\n};\nexport const withBatchedUpdatesThrottled = (func) => {\n  return throttleRAF((event) => {\n    unstable_batchedUpdates(func, event);\n  });\n};\n\nexport const getBoundsFromPoints = (element) => {\n  let minX = Infinity;\n  let minY = Infinity;\n  let maxX = -Infinity;\n  let maxY = -Infinity;\n  let points = element.points;\n  if (element.type === \"freedraw\") {\n    points = element.points.map((p) => {\n      return [p[0] - element.x, p[1] - element.y];\n    });\n  }\n  for (const [x, y] of points) {\n    minX = Math.min(minX, x);\n    minY = Math.min(minY, y);\n    maxX = Math.max(maxX, x);\n    maxY = Math.max(maxY, y);\n  }\n\n  return [minX, minY, maxX, maxY];\n};\n\nexport const rotate = (x1, y1, x2, y2, angle) =>\n  // 𝑎′𝑥=(𝑎𝑥−𝑐𝑥)cos𝜃−(𝑎𝑦−𝑐𝑦)sin𝜃+𝑐𝑥\n  // 𝑎′𝑦=(𝑎𝑥−𝑐𝑥)sin𝜃+(𝑎𝑦−𝑐𝑦)cos𝜃+𝑐𝑦.\n  // https://math.stackexchange.com/questions/2204520/how-do-i-rotate-a-line-segment-in-a-specific-point-on-the-line\n  [\n    (x1 - x2) * Math.cos(angle) - (y1 - y2) * Math.sin(angle) + x2,\n    (x1 - x2) * Math.sin(angle) + (y1 - y2) * Math.cos(angle) + y2,\n  ];\n\nexport const getElementBounds = (element) => {\n  let bounds;\n\n  const [x1, y1, x2, y2, cx, cy] = getElementAbsoluteCoords(element);\n\n  if (element.type === \"freedraw\") {\n    const [minX, minY, maxX, maxY] = getBoundsFromPoints(element);\n\n    return [\n      minX + element.x,\n      minY + element.y,\n      maxX + element.x,\n      maxY + element.y,\n    ];\n  } else {\n    const [x11, y11] = rotate(x1, y1, cx, cy, element.angle);\n    const [x12, y12] = rotate(x1, y2, cx, cy, element.angle);\n    const [x22, y22] = rotate(x2, y2, cx, cy, element.angle);\n    const [x21, y21] = rotate(x2, y1, cx, cy, element.angle);\n    const minX = Math.min(x11, x12, x22, x21);\n    const minY = Math.min(y11, y12, y22, y21);\n    const maxX = Math.max(x11, x12, x22, x21);\n    const maxY = Math.max(y11, y12, y22, y21);\n    bounds = [minX, minY, maxX, maxY];\n  }\n\n  return bounds;\n};\nexport const getCommonBounds = (elements) => {\n  if (!elements.length) {\n    return [0, 0, 0, 0];\n  }\n\n  let minX = Infinity;\n  let maxX = -Infinity;\n  let minY = Infinity;\n  let maxY = -Infinity;\n\n  elements.forEach((element) => {\n    const [x1, y1, x2, y2] = getElementBounds(element);\n    minX = Math.min(minX, x1);\n    minY = Math.min(minY, y1);\n    maxX = Math.max(maxX, x2);\n    maxY = Math.max(maxY, y2);\n  });\n\n  return [minX, minY, maxX, maxY];\n};\nexport const getElementAbsoluteCoords = (element) => {\n  if (element.type === \"freedraw\") {\n    const [minX, minY, maxX, maxY] = getBoundsFromPoints(element);\n    const x1 = minX + element.x;\n    const y1 = minY + element.y;\n    const x2 = maxX + element.x;\n    const y2 = maxY + element.y;\n    return [x1, y1, x2, y2, (x1 + x2) / 2, (y1 + y2) / 2];\n  }\n  return [\n    element.x,\n    element.y,\n    element.x + element.width,\n    element.y + element.height,\n    element.x + element.width / 2,\n    element.y + element.height / 2,\n  ];\n};\n\nexport const distance = (x, y) => Math.abs(x - y);\n\nexport const getSizeFromPoints = (points) => {\n  const xs = points.map((point) => point[0]);\n  const ys = points.map((point) => point[1]);\n  return {\n    width: Math.max(...xs) - Math.min(...xs),\n    height: Math.max(...ys) - Math.min(...ys),\n  };\n};\n\nlet testIdBase = 0;\nexport const randomId = () => `id${testIdBase++}`;\nexport const randomInteger = () => Math.floor(Math.random() * 2 ** 31);\n\nexport const generateExcalidrawElements = () => {\n  const freeDrawElements =\n    JSON.parse(localStorage.getItem(\"free-draw-elements\")) || [];\n  const result = freeDrawElements.map((ele) => {\n    const points = ele.points.map((p) => {\n      return [p[0] - ele.x, p[1] - ele.y];\n    });\n    const { width, height } = getSizeFromPoints(points);\n    return {\n      id: randomId(),\n      type: \"freedraw\",\n      x: ele.x,\n      y: ele.y,\n      width: width,\n      height: height,\n      angle: 0,\n      strokeColor: ele.strokeStyle,\n      backgroundColor: \"transparent\",\n      fillStyle: \"hachure\",\n      strokeWidth: 1,\n      strokeStyle: \"solid\",\n      roughness: 1,\n      opacity: 100,\n      groupIds: [],\n      roundness: null,\n      seed: randomInteger(),\n      version: 1,\n      versionNonce: 0,\n      isDeleted: false,\n      boundElements: null,\n      updated: Date.now(),\n      link: null,\n      locked: false,\n      points: points,\n      pressures: [],\n      simulatePressure: true,\n      lastCommittedPoint: points[points.length - 1],\n    };\n  });\n  return result;\n};\n\n// for worker\n// window.__generateExcalidrawElements = generateExcalidrawElements;\n\nexport const getFontString = ({ fontSize, fontFamily }) => {\n  return `${fontSize}px ${fontFamily}, Segoe UI Emoji`;\n};\n","const MIN_ZOOM = 0.1;\n\nexport const getNormalizedZoom = (zoom) => {\n  return Math.max(MIN_ZOOM, Math.min(zoom, 30));\n};\n\nexport const getStateForZoom = (\n  { viewportX, viewportY, nextZoom },\n  appState\n) => {\n  const screenX = viewportX - appState.offsetLeft;\n  const screenY = viewportY - appState.offsetTop;\n  const currentZoom = appState.zoom.value;\n\n  return {\n    scrollX: appState.scrollX + screenX / nextZoom - screenX / currentZoom,\n    scrollY: appState.scrollY + screenY / nextZoom - screenY / currentZoom,\n    zoom: {\n      value: nextZoom,\n    },\n  };\n};\n"],"names":["svg","_minX","_minY","img","newElement","type","x","y","strokeColor","backgroundColor","fillStyle","strokeWidth","strokeStyle","width","height","angle","points","rest","id","randomId","isDeleted","createElement","elementType","pointerDownState","appState","origin","currentItemStrokeColor","currentItemBackgroundColor","currentItemFillStyle","currentItemStrokeWidth","rgb","newTextElement","opts","text","fontSize","fontFamily","textAlign","verticalAlign","originalText","getRandomValue","n","m","Number","Math","random","toFixed","count","element","elements","i","scrollX","canvasWidth","scrollY","canvasHeight","abs","pointsNum","push","length","elementCache","SVG_NS","renderScene","svgContainer","scale","renderConfig","isTransform","accelerate","constainerStyle","zoom","value","setAttribute","replace","getCanvasSize","minX","minY","document","createElementNS","style","position","background","appendChild","map","index","el","originChange","draggingElement","ceil","__x","__y","__width","__height","p","join","renderElementToSvg","base64","svg2img","src","left","top","xml","XMLSerializer","serializeToString","image64","btoa","gesture","pointers","Map","lastCenter","initialDistance","initialScale","useGesture","canvasRef","useEffect","canvas","current","onTouchEnd","event","touches","clear","addEventListener","removeEventListener","removePointer","delete","pointerId","updateGestureOnPointerDown","set","clientX","clientY","size","getCenter","getDistance","Array","from","values","handleCanvasPointerMove","callback","has","center","deltaX","deltaY","scaleFactor","nextZoom","getNormalizedZoom","zoomState","getStateForZoom","viewportX","viewportY","Object","assign","createIcon","d","mirror","focusable","role","viewBox","fill","RectangleIcon","stroke","rx","strokeLinecap","strokeLinejoin","FreedrawIcon","clipRule","ExportImageIcon","modifiedTablerIconProps","ZoomInIcon","ZoomOutIcon","Scene","JSON","parse","localStorage","getItem","this","nextElements","scene","SHAPES","icon","memo","activeTool","onActiveToolChange","className","styles","onClick","exportPng","getElementsIncludingDeleted","shape","isSelected","Scale","onZoomChange","zoomValue","LayerUI","Index","forwardRef","ref","staticCanvasRef","textareaRef","useRef","useState","textareaValue","setTextAreaValue","useImperativeHandle","startEditText","preventDefault","stopPropagation","viewportCoordsToSceneCoords","sceneX","sceneY","textarea","focus","offsetLeft","offsetTop","styleObj","font","getFontString","opacity","color","copyTextarea","getElementById","maxWidth","zIndex","onChange","e","target","parseFloat","innerText","copyTextWidth","getBoundingClientRect","slice","lines","split","splitResult","forEach","line","lastIdx","str","onBlur","offsetWidth","offsetHeight","replaceAllElements","window","devicePixelRatio","selectionColor","viewBackgroundColor","setTimeout","contentEditable","Canvas","canvasContainer","svgContainerRef","cursorPosition","rafRef","globalVarRef","flag","refreshFlag","setActiveTool","testObj","setTestObj","animate","setAnimate","willChangeRef","animateRef","refresh","setCanvasSize","wrap","handleWheel","passive","updateCurrentCursorPosition","cursorX","cursorY","onTapStart","frame","startTime","Date","now","loop","currentTime","fps","round","requestAnimationFrame","reDrawAfterZoom","zoomTimerId","clearTimeout","onPointerMoveFromCanvasPointerDownHandler","withBatchedUpdatesThrottled","pointerCoords","lastCoords","originX","originY","distance","newX","newY","onPointerUpFromCanvasPointerDownHandler","getContext","clearRect","eventListeners","onMove","onUp","initialPointerDownState","onKeyUp","onKeyDown","onWheel","metaKey","ctrlKey","sign","absDelta","delta","ZOOM_STEP","newZoom","log10","max","min","onPointerDown","onPointerMove","onPointerUp","onDoubleClick","onPointerCancel","zoomVal","generateElements","cancelAnimationFrame","lastDate","tick","currentDate","animateElements","exportPadding","getCommonBounds","maxX","maxY","isExport","notUseCache","dataUrl","toDataURL","canvasToDataURL","a","href","download","click","allCoords","sum","coords","b","hypot","array","mapper","reduce","acc","item","r","floor","g","func","fn","timerId","lastArgs","lastArgsTrailing","scheduleFunc","args","ret","trailing","flush","cancel","throttleRAF","unstable_batchedUpdates","getBoundsFromPoints","Infinity","rotate","x1","y1","x2","y2","cos","sin","getElementBounds","getElementAbsoluteCoords","cx","cy","x11","y11","x12","y12","x22","y22","x21","y21","testIdBase","screenX","screenY","currentZoom"],"sourceRoot":""}