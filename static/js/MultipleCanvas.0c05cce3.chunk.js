"use strict";(this.webpackChunkexcalidraw_app=this.webpackChunkexcalidraw_app||[]).push([[848],{5650:function(n,e,t){t.d(e,{Z:function(){return h}});var r=t(1413),i=t(4925),a=t(9439),o=t(4519),l=t(9149),c=t(9410),u=t(8106),s=t(1695),f=(t(9011),t(2556)),d=["node","inline","className","children"];var h=function(n){var e=n.src,t=(0,o.useState)(""),h=(0,a.Z)(t,2),v=h[0],m=h[1];return(0,o.useEffect)((function(){fetch(e).then((function(n){return n.text()})).then((function(n){m(n)}))}),[e]),(0,f.jsx)("div",{className:"markdown-body",children:(0,f.jsx)(l.D,{children:v,rehypePlugins:[s.Z],remarkPlugins:[c.Z],components:{code:function(n){n.node;var e=n.inline,t=n.className,a=n.children,o=(0,i.Z)(n,d),l=/language-(\w+)/.exec(t||"");return!e&&l?(0,f.jsx)(u.Z,(0,r.Z)({children:String(a).replace(/\n$/,""),language:l[1],className:"my-code",PreTag:"div"},o)):(0,f.jsx)("code",(0,r.Z)((0,r.Z)({className:t},o),{},{children:a}))}}})})}},7531:function(n,e,t){t.r(e),t.d(e,{default:function(){return k},elements:function(){return Z}});var r=t(1413),i=t(9439),a=t(4519),o=t(5204),l=t(5650),c=t(6818),u=t(3433),s=t(7762),f=t(4453),d=function(n){return function(n,e){var t=null,r=null,i=null,a=function e(a){t=window.requestAnimationFrame((function(){t=null,n.apply(void 0,(0,u.Z)(a)),r=null,i&&(r=i,i=null,e(r))}))},o=function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];r=o,null===t?a(r):null!==e&&void 0!==e&&e.trailing&&(i=o)};return o.flush=function(){null!==t&&(cancelAnimationFrame(t),t=null),r&&(n.apply(void 0,(0,u.Z)(i||r)),r=i=null)},o.cancel=function(){r=i=null,null!==t&&(cancelAnimationFrame(t),t=null)},o}((function(e){(0,f.unstable_batchedUpdates)(n,e)}))},h=function(n){var e=function(n){var e,t=1/0,r=1/0,a=-1/0,o=-1/0,l=(0,s.Z)(n);try{for(l.s();!(e=l.n()).done;){var c=(0,i.Z)(e.value,2),u=c[0],f=c[1];t=Math.min(t,u),r=Math.min(r,f),a=Math.max(a,u),o=Math.max(o,f)}}catch(d){l.e(d)}finally{l.f()}return[t,r,a,o]}(n.points),t=(0,i.Z)(e,4),r=t[0],a=t[1],o=t[2],l=t[3],c=r+n.x,u=a+n.y,f=o+n.x,d=l+n.y;return[c,u,f,d,(c+f)/2,(u+d)/2]},v=function(n,e){return Math.abs(n-e)},m=0;window.__generateExcalidrawElements=function(){return(JSON.parse(localStorage.getItem("free-draw-elements"))||[]).map((function(n){var e=n.points.map((function(e){return[e[0]-n.x,e[1]-n.y]})),t=function(n){var e=n.map((function(n){return n[0]})),t=n.map((function(n){return n[1]}));return{width:Math.max.apply(Math,(0,u.Z)(e))-Math.min.apply(Math,(0,u.Z)(e)),height:Math.max.apply(Math,(0,u.Z)(t))-Math.min.apply(Math,(0,u.Z)(t))}}(e),r=t.width,i=t.height;return{id:"id".concat(m++),type:"freedraw",x:n.x,y:n.y,width:r,height:i,angle:0,strokeColor:n.strokeStyle,backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",roughness:1,opacity:100,groupIds:[],roundness:null,seed:Math.floor(Math.random()*Math.pow(2,31)),version:1,versionNonce:0,isDeleted:!1,boundElements:null,updated:Date.now(),link:null,locked:!1,points:e,pressures:[],simulatePressure:!0,lastCommittedPoint:e[e.length-1]}}))};var p=new WeakMap,g=function(n){p.delete(n)},w=function(n,e){Z.forEach((function(t){var a=function(n){var e=p.get(n);if(e)return e;var t,a,o=document.createElement("canvas"),l=o.getContext("2d"),c=h((0,r.Z)((0,r.Z)({},n),{},{points:n.points.map((function(e){return[e[0]-n.x,e[1]-n.y]}))})),u=(0,i.Z)(c,4),s=u[0],f=u[1],d=u[2],m=u[3];return o.width=v(s,d)*window.devicePixelRatio+40,o.height=v(f,m)*window.devicePixelRatio+40,t=n.x>s?v(n.x,s)*window.devicePixelRatio:0,a=n.y>f?v(n.y,f)*window.devicePixelRatio:0,l.translate(t,a),l.save(),l.translate(20,20),l.scale(window.devicePixelRatio,window.devicePixelRatio),l.lineWidth=3,l.strokeStyle=n.strokeStyle,n.points.forEach((function(e,t){var r=(0,i.Z)(e,2),a=r[0],o=r[1];a-=n.x,o-=n.y,t?l.lineTo(a,o):l.moveTo(a,o)})),l.stroke(),l.restore(),p.set(n,o),o}(t),o=h((0,r.Z)((0,r.Z)({},t),{},{points:t.points.map((function(n){return[n[0]-t.x,n[1]-t.y]}))})),l=(0,i.Z)(o,4),c=l[0],u=l[1],s=l[2],f=l[3],d=((c+s)/2+e.scrollX)*window.devicePixelRatio,m=((u+f)/2+e.scrollY)*window.devicePixelRatio;n.save(),n.scale(1/window.devicePixelRatio,1/window.devicePixelRatio),n.translate(d,m),n.drawImage(a,-(s-c)/2*window.devicePixelRatio-20,-(f-u)/2*window.devicePixelRatio-20,a.width,a.height),n.restore()}))},x=function(n,e){var t=n.getContext("2d");t.clearRect(0,0,n.width,n.height),function(n,e){var t=e.draggingElement;n.save(),n.beginPath(),n.lineWidth=3,n.strokeStyle=t.strokeStyle,t.points.forEach((function(e,r){r?n.lineTo.apply(n,(0,u.Z)(e)):n.moveTo.apply(n,(0,u.Z)(t.points[0]))})),n.stroke(),n.restore()}(t,e)},y=function(n,e){var t=n.getContext("2d");t.clearRect(0,0,n.width,n.height),w(t,e),localStorage.setItem("free-draw-elements",JSON.stringify(Z))},M=t(2556),Z=JSON.parse(localStorage.getItem("free-draw-elements"))||[],E={offsetLeft:0,offsetTop:0,scrollX:0,scrollY:0,draggingElement:null},k=(0,a.memo)((function(){var n=(0,a.useRef)(null),e=(0,a.useRef)(null),u=(0,a.useRef)(null),s=(0,a.useState)(!1),f=(0,i.Z)(s,2),h=f[0],v=f[1];(0,a.useEffect)((function(){var t=function(n){var e=n.getContext("2d");n.width=i*window.devicePixelRatio,n.height=a*window.devicePixelRatio,e.scale(window.devicePixelRatio,window.devicePixelRatio)},r=n.current,i=r.offsetWidth,a=r.offsetHeight;t(r),t(u.current);var o=r.getBoundingClientRect(),l=o.x,c=o.y;E.offsetLeft=l,E.offsetTop=c,y(u.current,E);var s=e.current,f=function(n){n.preventDefault()};return s.addEventListener("wheel",f,{passive:!1}),function(){s.removeEventListener("wheel",f)}}),[]),(0,a.useEffect)((function(){t.e(399).then(t.bind(t,4399)).then((function(n){}))}),[]);var m=function(e){return d((function(e){var t=(0,o.dE)(e,E);E.draggingElement.points.push([t.x,t.y]),x(n.current,E)}))},p=function(e){return function(){g(E.draggingElement),Z.push(E.draggingElement),console.log("appState...",E),console.log("elements...",Z.map((function(n){return n.points.length})));var t=n.current;t.getContext("2d").clearRect(0,0,t.width,t.height),y(u.current,E),window.removeEventListener("pointermove",e.eventListeners.onMove),window.removeEventListener("pointerup",e.eventListeners.onUp)}};return(0,M.jsxs)("div",{className:"multiple-layer",children:[(0,M.jsxs)("div",{className:"container wrap",ref:e,children:[(0,M.jsx)("canvas",{ref:u,className:"canvas",children:"\u9759\u6001canvas"}),(0,M.jsx)("canvas",{ref:n,className:"canvas draw",onPointerDown:function(n){var e=(0,o.dE)(n,E),t={origin:e,lastCoords:(0,r.Z)({},e),eventListeners:{onMove:null,onUp:null}},i={x:t.origin.x,y:t.origin.y,points:[[t.origin.x,t.origin.y]],strokeColor:"#000000",backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:(0,o.B8)()};E.draggingElement=i,g(i);var a=m(t),l=p(t);window.addEventListener("pointermove",a),window.addEventListener("pointerup",l),t.eventListeners.onMove=a,t.eventListeners.onUp=l},children:"\u52a8\u6001canvas"}),(0,M.jsx)("button",{className:"btn clear",onClick:function(){localStorage.setItem("free-draw-elements",JSON.stringify([])),Z=[],y(u.current,E)},children:"\u6e05\u7a7alocalstorage"}),(0,M.jsx)("button",{className:"btn",onClick:function(){h||(v(!0),t.e(399).then(t.bind(t,4399)).then((function(n){var e=n.default;localStorage.setItem("free-draw-elements",JSON.stringify(e)),Z=e,y(u.current,E)})).finally((function(){v(!1)})))},children:"\u6781\u9650\u6d4b\u8bd5"})]}),(0,M.jsx)(l.Z,{src:c})]})}))},5204:function(n,e,t){t.d(e,{$9:function(){return u},B8:function(){return c},KP:function(){return h},Pi:function(){return d},TE:function(){return m},dE:function(){return l},kb:function(){return g},mO:function(){return w},qf:function(){return v}});var r=t(9439),i=t(7762),a=t(3433),o=t(4453),l=function(n,e){var t=n.clientX,r=n.clientY,i=e.zoom,a=e.offsetLeft,o=e.offsetTop,l=e.scrollX,c=e.scrollY,u=i?i.value:1;return{x:(t-a)/u-l,y:(r-o)/u-c}},c=function(){var n=Math.floor(256*Math.random()),e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random());return"rgb(".concat(n,",").concat(e,",").concat(t,")")},u=function(n){return function(n,e){var t=null,r=null,i=null,o=function e(o){t=window.requestAnimationFrame((function(){t=null,n.apply(void 0,(0,a.Z)(o)),r=null,i&&(r=i,i=null,e(r))}))},l=function(){for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];r=a,null===t?o(r):null!==e&&void 0!==e&&e.trailing&&(i=a)};return l.flush=function(){null!==t&&(cancelAnimationFrame(t),t=null),r&&(n.apply(void 0,(0,a.Z)(i||r)),r=i=null)},l.cancel=function(){r=i=null,null!==t&&(cancelAnimationFrame(t),t=null)},l}((function(e){(0,o.unstable_batchedUpdates)(n,e)}))},s=function(n){var e=1/0,t=1/0,a=-1/0,o=-1/0,l=n.points;"freedraw"===n.type&&(l=n.points.map((function(e){return[e[0]-n.x,e[1]-n.y]})));var c,u=(0,i.Z)(l);try{for(u.s();!(c=u.n()).done;){var s=(0,r.Z)(c.value,2),f=s[0],d=s[1];e=Math.min(e,f),t=Math.min(t,d),a=Math.max(a,f),o=Math.max(o,d)}}catch(h){u.e(h)}finally{u.f()}return[e,t,a,o]},f=function(n,e,t,r,i){return[(n-t)*Math.cos(i)-(e-r)*Math.sin(i)+t,(n-t)*Math.sin(i)+(e-r)*Math.cos(i)+r]},d=function(n){var e=v(n),t=(0,r.Z)(e,6),i=t[0],a=t[1],o=t[2],l=t[3],c=t[4],u=t[5];if("freedraw"===n.type){var d=s(n),h=(0,r.Z)(d,4),m=h[0],p=h[1],g=h[2],w=h[3];return[m+n.x,p+n.y,g+n.x,w+n.y]}var x=f(i,a,c,u,n.angle),y=(0,r.Z)(x,2),M=y[0],Z=y[1],E=f(i,l,c,u,n.angle),k=(0,r.Z)(E,2),P=k[0],S=k[1],R=f(o,l,c,u,n.angle),b=(0,r.Z)(R,2),N=b[0],C=b[1],L=f(o,a,c,u,n.angle),j=(0,r.Z)(L,2),T=j[0],A=j[1];return[Math.min(M,P,N,T),Math.min(Z,S,C,A),Math.max(M,P,N,T),Math.max(Z,S,C,A)]},h=function(n){if(!n.length)return[0,0,0,0];var e=1/0,t=-1/0,i=1/0,a=-1/0;return n.forEach((function(n){var o=d(n),l=(0,r.Z)(o,4),c=l[0],u=l[1],s=l[2],f=l[3];e=Math.min(e,c),i=Math.min(i,u),t=Math.max(t,s),a=Math.max(a,f)})),[e,i,t,a]},v=function(n){if("freedraw"===n.type){var e=s(n),t=(0,r.Z)(e,4),i=t[0],a=t[1],o=t[2],l=t[3],c=i+n.x,u=a+n.y,f=o+n.x,d=l+n.y;return[c,u,f,d,(c+f)/2,(u+d)/2]}return[n.x,n.y,n.x+n.width,n.y+n.height,n.x+n.width/2,n.y+n.height/2]},m=function(n,e){return Math.abs(n-e)},p=0,g=function(){return"id".concat(p++)},w=function(n){var e=n.fontSize,t=n.fontFamily;return"".concat(e,"px ").concat(t,", Segoe UI Emoji")}},6818:function(n,e,t){n.exports=t.p+"static/media/\u70b9\u7a00\u91ca.31d6cfe0d16ae931b73c.md"}}]);
//# sourceMappingURL=MultipleCanvas.0c05cce3.chunk.js.map