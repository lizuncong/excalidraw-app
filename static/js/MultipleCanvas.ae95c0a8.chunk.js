"use strict";(self.webpackChunkexcalidraw_app=self.webpackChunkexcalidraw_app||[]).push([[848],{1890:function(e,n,t){t.d(n,{Z:function(){return v}});var i=t(1413),r=t(4925),o=t(9439),a=t(2791),l=t(1350),c=t(1926),s=t(4209),u=t(6571),d=(t(3659),t(184)),f=["node","inline","className","children"];var v=function(e){var n=e.src,t=(0,a.useState)(""),v=(0,o.Z)(t,2),h=v[0],p=v[1];return(0,a.useEffect)((function(){fetch(n).then((function(e){return e.text()})).then((function(e){p(e)}))}),[n]),(0,d.jsx)("div",{className:"markdown-body",children:(0,d.jsx)(l.D,{children:h,rehypePlugins:[u.Z],remarkPlugins:[c.Z],components:{code:function(e){e.node;var n=e.inline,t=e.className,o=e.children,a=(0,r.Z)(e,f),l=/language-(\w+)/.exec(t||"");return!n&&l?(0,d.jsx)(s.Z,(0,i.Z)({children:String(o).replace(/\n$/,""),language:l[1],className:"my-code",PreTag:"div"},a)):(0,d.jsx)("code",(0,i.Z)((0,i.Z)({className:t},a),{},{children:o}))}}})})}},4546:function(e,n,t){t.r(n),t.d(n,{default:function(){return P},elements:function(){return M}});var i=t(1413),r=t(2791),o=t(84),a=t(1890),l=t(6818),c=t(3433),s=t(9439),u=t(7762),d=t(4164),f=function(e){return function(e,n){var t=null,i=null,r=null,o=function n(o){t=window.requestAnimationFrame((function(){t=null,e.apply(void 0,(0,c.Z)(o)),i=null,r&&(i=r,r=null,n(i))}))},a=function(){for(var e=arguments.length,a=new Array(e),l=0;l<e;l++)a[l]=arguments[l];i=a,null===t?o(i):null!==n&&void 0!==n&&n.trailing&&(r=a)};return a.flush=function(){null!==t&&(cancelAnimationFrame(t),t=null),i&&(e.apply(void 0,(0,c.Z)(r||i)),i=r=null)},a.cancel=function(){i=r=null,null!==t&&(cancelAnimationFrame(t),t=null)},a}((function(n){(0,d.unstable_batchedUpdates)(e,n)}))},v=function(e){var n=function(e){var n,t=1/0,i=1/0,r=-1/0,o=-1/0,a=(0,u.Z)(e);try{for(a.s();!(n=a.n()).done;){var l=(0,s.Z)(n.value,2),c=l[0],d=l[1];t=Math.min(t,c),i=Math.min(i,d),r=Math.max(r,c),o=Math.max(o,d)}}catch(f){a.e(f)}finally{a.f()}return[t,i,r,o]}(e.points),t=(0,s.Z)(n,4),i=t[0],r=t[1],o=t[2],a=t[3],l=i+e.x,c=r+e.y,d=o+e.x,f=a+e.y;return[l,c,d,f,(l+d)/2,(c+f)/2]},h=function(e,n){return Math.abs(e-n)},p=0;window.__generateExcalidrawElements=function(){return(JSON.parse(localStorage.getItem("free-draw-elements"))||[]).map((function(e){var n=e.points.map((function(n){return[n[0]-e.x,n[1]-e.y]})),t=function(e){var n=e.map((function(e){return e[0]})),t=e.map((function(e){return e[1]}));return{width:Math.max.apply(Math,(0,c.Z)(n))-Math.min.apply(Math,(0,c.Z)(n)),height:Math.max.apply(Math,(0,c.Z)(t))-Math.min.apply(Math,(0,c.Z)(t))}}(n),i=t.width,r=t.height;return{id:"id".concat(p++),type:"freedraw",x:e.x,y:e.y,width:i,height:r,angle:0,strokeColor:e.strokeStyle,backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",roughness:1,opacity:100,groupIds:[],roundness:null,seed:Math.floor(Math.random()*Math.pow(2,31)),version:1,versionNonce:0,isDeleted:!1,boundElements:null,updated:Date.now(),link:null,locked:!1,points:n,pressures:[],simulatePressure:!0,lastCommittedPoint:n[n.length-1]}}))};var w=new WeakMap,m=function(e){w.delete(e)},g=function(e,n){M.forEach((function(t){var r=function(e){var n=w.get(e);if(n)return n;var t,r,o=document.createElement("canvas"),a=o.getContext("2d"),l=v((0,i.Z)((0,i.Z)({},e),{},{points:e.points.map((function(n){return[n[0]-e.x,n[1]-e.y]}))})),c=(0,s.Z)(l,4),u=c[0],d=c[1],f=c[2],p=c[3];return o.width=h(u,f)*window.devicePixelRatio+40,o.height=h(d,p)*window.devicePixelRatio+40,t=e.x>u?h(e.x,u)*window.devicePixelRatio:0,r=e.y>d?h(e.y,d)*window.devicePixelRatio:0,a.translate(t,r),a.save(),a.translate(20,20),a.scale(window.devicePixelRatio,window.devicePixelRatio),a.lineWidth=3,a.strokeStyle=e.strokeStyle,e.points.forEach((function(n,t){var i=(0,s.Z)(n,2),r=i[0],o=i[1];r-=e.x,o-=e.y,t?a.lineTo(r,o):a.moveTo(r,o)})),a.stroke(),a.restore(),w.set(e,o),o}(t),o=v((0,i.Z)((0,i.Z)({},t),{},{points:t.points.map((function(e){return[e[0]-t.x,e[1]-t.y]}))})),a=(0,s.Z)(o,4),l=a[0],c=a[1],u=a[2],d=a[3],f=((l+u)/2+n.scrollX)*window.devicePixelRatio,p=((c+d)/2+n.scrollY)*window.devicePixelRatio;e.save(),e.scale(1/window.devicePixelRatio,1/window.devicePixelRatio),e.translate(f,p),e.drawImage(r,-(u-l)/2*window.devicePixelRatio-20,-(d-c)/2*window.devicePixelRatio-20,r.width,r.height),e.restore()}))},x=function(e,n){var t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),function(e,n){var t=n.draggingElement;e.save(),e.beginPath(),e.lineWidth=3,e.strokeStyle=t.strokeStyle,t.points.forEach((function(n,i){i?e.lineTo.apply(e,(0,c.Z)(n)):e.moveTo.apply(e,(0,c.Z)(t.points[0]))})),e.stroke(),e.restore()}(t,n)},y=function(e,n){var t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),g(t,n),localStorage.setItem("free-draw-elements",JSON.stringify(M))},Z=t(184),M=JSON.parse(localStorage.getItem("free-draw-elements"))||[],k={offsetLeft:0,offsetTop:0,scrollX:0,scrollY:0,draggingElement:null},P=(0,r.memo)((function(){var e=(0,r.useRef)(null),n=(0,r.useRef)(null),t=(0,r.useRef)(null);(0,r.useEffect)((function(){var i=function(e){var n=e.getContext("2d");e.width=o*window.devicePixelRatio,e.height=a*window.devicePixelRatio,n.scale(window.devicePixelRatio,window.devicePixelRatio)},r=e.current,o=r.offsetWidth,a=r.offsetHeight;i(r),i(t.current);var l=r.getBoundingClientRect(),c=l.x,s=l.y;k.offsetLeft=c,k.offsetTop=s,y(t.current,k);var u=n.current,d=function(e){e.preventDefault()};return u.addEventListener("wheel",d,{passive:!1}),function(){u.removeEventListener("wheel",d)}}),[]);var c=function(n){return f((function(n){var t=(0,o.d)(n,k);k.draggingElement.points.push([t.x,t.y]),x(e.current,k)}))},s=function(n){return function(){console.log("appState...",k),console.log("elements...",M.map((function(e){return e.points.length}))),m(k.draggingElement),M.push(k.draggingElement);var i=e.current;i.getContext("2d").clearRect(0,0,i.width,i.height),y(t.current,k),window.removeEventListener("pointermove",n.eventListeners.onMove),window.removeEventListener("pointerup",n.eventListeners.onUp)}};return(0,Z.jsxs)("div",{className:"multiple-layer",children:[(0,Z.jsxs)("div",{className:"container wrap",ref:n,children:[(0,Z.jsx)("canvas",{ref:t,className:"canvas",children:"\u9759\u6001canvas"}),(0,Z.jsx)("canvas",{ref:e,className:"canvas",onPointerDown:function(e){var n=(0,o.d)(e,k),t={origin:n,lastCoords:(0,i.Z)({},n),eventListeners:{onMove:null,onUp:null}},r={x:t.origin.x,y:t.origin.y,points:[[t.origin.x,t.origin.y]],strokeColor:"#000000",backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:(0,o.B)()};k.draggingElement=r,m(r);var a=c(t),l=s(t);window.addEventListener("pointermove",a),window.addEventListener("pointerup",l),t.eventListeners.onMove=a,t.eventListeners.onUp=l},children:"\u52a8\u6001canvas"})]}),(0,Z.jsx)(a.Z,{src:l})]})}))},84:function(e,n,t){t.d(n,{B:function(){return r},d:function(){return i}});var i=function(e,n){var t=e.clientX,i=e.clientY,r=n.offsetLeft,o=n.offsetTop;return{x:t-r-n.scrollX,y:i-o-n.scrollY}},r=function(){var e=Math.floor(256*Math.random()),n=Math.floor(256*Math.random()),t=Math.floor(256*Math.random());return"rgb(".concat(e,",").concat(n,",").concat(t,")")}},6818:function(e,n,t){e.exports=t.p+"static/media/\u70b9\u7a00\u91ca.31d6cfe0d16ae931b73c.md"}}]);
//# sourceMappingURL=MultipleCanvas.ae95c0a8.chunk.js.map