"use strict";(this.webpackChunkexcalidraw_app=this.webpackChunkexcalidraw_app||[]).push([[894],{6510:function(n,e,t){t.r(e),t.d(e,{default:function(){return m},elements:function(){return h}});var r=t(1413),o=t(4519),i=t(5204),a="index_undoRedo__mOw1J",u="index_canvas__s497j",l="index_container__JGkWk",c="index_btnRow__ReEOR",f=t(3433),s=function(n,e){var t,r=n.getContext("2d");r.clearRect(0,0,n.width,n.height),t=r,h.forEach((function(n){t.save(),t.beginPath(),t.lineWidth=3,t.strokeStyle=n.strokeStyle,n.points.forEach((function(e,r){r?t.lineTo.apply(t,(0,f.Z)(e)):t.moveTo.apply(t,(0,f.Z)(n.points[0]))})),t.stroke(),t.restore()})),localStorage.setItem("free-draw-elements",JSON.stringify(h))},d=t(2556),h=JSON.parse(localStorage.getItem("free-draw-elements"))||[],v={offsetLeft:0,offsetTop:0,scrollX:0,scrollY:0,draggingElement:null},m=(0,o.memo)((function(){var n=(0,o.useRef)(null),e=(0,o.useRef)(null);(0,o.useEffect)((function(){var t=n.current,r=t.getContext("2d"),o=t.offsetWidth,i=t.offsetHeight,a=t.offsetLeft,u=t.offsetTop;t.width=o*window.devicePixelRatio,t.height=i*window.devicePixelRatio,r.scale(window.devicePixelRatio,window.devicePixelRatio),v.offsetLeft=a,v.offsetTop=u,s(t,v);var l=e.current,c=function(n){n.preventDefault()};return l.addEventListener("wheel",c,{passive:!1}),function(){l.removeEventListener("wheel",c)}}),[]);var t=function(e){return function(e){var t=(0,i.dE)(e,v);v.draggingElement.points.push([t.x,t.y]),s(n.current,v)}},f=function(n){return function(){window.removeEventListener("pointermove",n.eventListeners.onMove),window.removeEventListener("pointerup",n.eventListeners.onUp)}};return(0,d.jsx)("div",{className:a,children:(0,d.jsxs)("div",{className:l,ref:e,children:[(0,d.jsx)("canvas",{ref:n,className:u,onPointerDown:function(n){var e=(0,i.dE)(n,v),o={origin:e,lastCoords:(0,r.Z)({},e),eventListeners:{onMove:null,onUp:null}},a={x:o.origin.x,y:o.origin.y,points:[[o.origin.x,o.origin.y]],strokeColor:"#000000",backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:(0,i.B8)()};v.draggingElement=a,h.push(a);var u=t(o),l=f(o);window.addEventListener("pointermove",u),window.addEventListener("pointerup",l),o.eventListeners.onMove=u,o.eventListeners.onUp=l},children:"\u7ed8\u5236canvas"}),(0,d.jsxs)("div",{className:c,children:[(0,d.jsx)("button",{children:"\u64a4\u9500"}),(0,d.jsx)("button",{children:"\u91cd\u505a"})]})]})})}))},5204:function(n,e,t){t.d(e,{$9:function(){return c},B8:function(){return l},KP:function(){return h},Pi:function(){return d},TE:function(){return m},dE:function(){return u},kb:function(){return x},mO:function(){return w},qf:function(){return v}});var r=t(9439),o=t(7762),i=t(3433),a=t(4453),u=function(n,e){var t=n.clientX,r=n.clientY,o=e.zoom,i=e.offsetLeft,a=e.offsetTop,u=e.scrollX,l=e.scrollY,c=o?o.value:1;return{x:(t-i)/c-u,y:(r-a)/c-l}},l=function(){var n=Math.floor(256*Math.random()),e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random());return"rgb(".concat(n,",").concat(e,",").concat(t,")")},c=function(n){return function(n,e){var t=null,r=null,o=null,a=function e(a){t=window.requestAnimationFrame((function(){t=null,n.apply(void 0,(0,i.Z)(a)),r=null,o&&(r=o,o=null,e(r))}))},u=function(){for(var n=arguments.length,i=new Array(n),u=0;u<n;u++)i[u]=arguments[u];r=i,null===t?a(r):null!==e&&void 0!==e&&e.trailing&&(o=i)};return u.flush=function(){null!==t&&(cancelAnimationFrame(t),t=null),r&&(n.apply(void 0,(0,i.Z)(o||r)),r=o=null)},u.cancel=function(){r=o=null,null!==t&&(cancelAnimationFrame(t),t=null)},u}((function(e){(0,a.unstable_batchedUpdates)(n,e)}))},f=function(n){var e=1/0,t=1/0,i=-1/0,a=-1/0,u=n.points;"freedraw"===n.type&&(u=n.points.map((function(e){return[e[0]-n.x,e[1]-n.y]})));var l,c=(0,o.Z)(u);try{for(c.s();!(l=c.n()).done;){var f=(0,r.Z)(l.value,2),s=f[0],d=f[1];e=Math.min(e,s),t=Math.min(t,d),i=Math.max(i,s),a=Math.max(a,d)}}catch(h){c.e(h)}finally{c.f()}return[e,t,i,a]},s=function(n,e,t,r,o){return[(n-t)*Math.cos(o)-(e-r)*Math.sin(o)+t,(n-t)*Math.sin(o)+(e-r)*Math.cos(o)+r]},d=function(n){var e=v(n),t=(0,r.Z)(e,6),o=t[0],i=t[1],a=t[2],u=t[3],l=t[4],c=t[5];if("freedraw"===n.type){var d=f(n),h=(0,r.Z)(d,4),m=h[0],p=h[1],x=h[2],w=h[3];return[m+n.x,p+n.y,x+n.x,w+n.y]}var g=s(o,i,l,c,n.angle),y=(0,r.Z)(g,2),M=y[0],E=y[1],L=s(o,u,l,c,n.angle),Z=(0,r.Z)(L,2),_=Z[0],k=Z[1],b=s(a,u,l,c,n.angle),R=(0,r.Z)(b,2),S=R[0],j=R[1],P=s(a,i,l,c,n.angle),C=(0,r.Z)(P,2),T=C[0],N=C[1];return[Math.min(M,_,S,T),Math.min(E,k,j,N),Math.max(M,_,S,T),Math.max(E,k,j,N)]},h=function(n){if(!n.length)return[0,0,0,0];var e=1/0,t=-1/0,o=1/0,i=-1/0;return n.forEach((function(n){var a=d(n),u=(0,r.Z)(a,4),l=u[0],c=u[1],f=u[2],s=u[3];e=Math.min(e,l),o=Math.min(o,c),t=Math.max(t,f),i=Math.max(i,s)})),[e,o,t,i]},v=function(n){if("freedraw"===n.type){var e=f(n),t=(0,r.Z)(e,4),o=t[0],i=t[1],a=t[2],u=t[3],l=o+n.x,c=i+n.y,s=a+n.x,d=u+n.y;return[l,c,s,d,(l+s)/2,(c+d)/2]}return[n.x,n.y,n.x+n.width,n.y+n.height,n.x+n.width/2,n.y+n.height/2]},m=function(n,e){return Math.abs(n-e)},p=0,x=function(){return"id".concat(p++)},w=function(n){var e=n.fontSize,t=n.fontFamily;return"".concat(e,"px ").concat(t,", Segoe UI Emoji")}}}]);
//# sourceMappingURL=UndoRedo.c3884c50.chunk.js.map