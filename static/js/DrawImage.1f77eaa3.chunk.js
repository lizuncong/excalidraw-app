"use strict";(self.webpackChunkexcalidraw_app=self.webpackChunkexcalidraw_app||[]).push([[536],{1890:function(e,n,t){t.d(n,{Z:function(){return v}});var i=t(1413),o=t(4925),r=t(9439),a=t(2791),l=t(1350),c=t(1926),s=t(4209),u=t(6571),d=(t(3659),t(184)),f=["node","inline","className","children"];var v=function(e){var n=e.src,t=(0,a.useState)(""),v=(0,r.Z)(t,2),h=v[0],m=v[1];return(0,a.useEffect)((function(){fetch(n).then((function(e){return e.text()})).then((function(e){m(e)}))}),[n]),(0,d.jsx)("div",{className:"markdown-body",children:(0,d.jsx)(l.D,{children:h,rehypePlugins:[u.Z],remarkPlugins:[c.Z],components:{code:function(e){e.node;var n=e.inline,t=e.className,r=e.children,a=(0,o.Z)(e,f),l=/language-(\w+)/.exec(t||"");return!n&&l?(0,d.jsx)(s.Z,(0,i.Z)({children:String(r).replace(/\n$/,""),language:l[1],className:"my-code",PreTag:"div"},a)):(0,d.jsx)("code",(0,i.Z)((0,i.Z)({className:t},a),{},{children:r}))}}})})}},2206:function(e,n,t){t.r(n),t.d(n,{default:function(){return x},elements:function(){return p}});var i=t(1413),o=t(2791),r=t(84),a=t(1890),l=t(6818),c=t(9439),s=t(7762),u=t(3433),d=t(4164),f=function(e){return function(e,n){var t=null,i=null,o=null,r=function n(r){t=window.requestAnimationFrame((function(){t=null,e.apply(void 0,(0,u.Z)(r)),i=null,o&&(i=o,o=null,n(i))}))},a=function(){for(var e=arguments.length,a=new Array(e),l=0;l<e;l++)a[l]=arguments[l];i=a,null===t?r(i):null!==n&&void 0!==n&&n.trailing&&(o=a)};return a.flush=function(){null!==t&&(cancelAnimationFrame(t),t=null),i&&(e.apply(void 0,(0,u.Z)(o||i)),i=o=null)},a.cancel=function(){i=o=null,null!==t&&(cancelAnimationFrame(t),t=null)},a}((function(n){(0,d.unstable_batchedUpdates)(e,n)}))},v=null,h=function(e,n){p.forEach((function(n){var t=document.createElement("canvas"),i=t.getContext("2d"),o=function(e){var n,t=1/0,i=1/0,o=-1/0,r=-1/0,a=(0,s.Z)(e);try{for(a.s();!(n=a.n()).done;){var l=(0,c.Z)(n.value,2),u=l[0],d=l[1];t=Math.min(t,u),i=Math.min(i,d),o=Math.max(o,u),r=Math.max(r,d)}}catch(f){a.e(f)}finally{a.f()}return[t,i,o,r]}(n.points),r=(0,c.Z)(o,4),a=r[0],l=r[1],u=r[2],d=r[3],f=document.getElementById("offscreen");v&&f.removeChild(v),v=t,f.appendChild(v),console.log(u-a,d-l),t.width=(u-a)*window.devicePixelRatio,t.height=(d-l)*window.devicePixelRatio,i.save(),i.beginPath(),i.scale(window.devicePixelRatio,window.devicePixelRatio),n.points.forEach((function(e,n){var t=(0,c.Z)(e,2),o=t[0],r=t[1];n?i.lineTo(o-a,r-l):i.moveTo(o-a,r-l)})),i.stroke(),i.restore(),e.save(),i.drawImage(t,-(u-a)/2*window.devicePixelRatio,-(d-l)/2*window.devicePixelRatio,t.width,t.height),e.restore()}))},m=function(e,n){var t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),h(t),localStorage.setItem("free-draw-elements",JSON.stringify(p))},w=t(184),p=JSON.parse(localStorage.getItem("free-draw-elements"))||[],g={offsetLeft:0,offsetTop:0,scrollX:0,scrollY:0,draggingElement:null},x=(0,o.memo)((function(){var e=(0,o.useRef)(null),n=(0,o.useRef)(null);(0,o.useEffect)((function(){var t=e.current,i=t.getContext("2d"),o=t.offsetWidth,r=t.offsetHeight,a=t.offsetLeft,l=t.offsetTop;t.width=o*window.devicePixelRatio,t.height=r*window.devicePixelRatio,i.scale(window.devicePixelRatio,window.devicePixelRatio),g.offsetLeft=a,g.offsetTop=l,m(t,g);var c=n.current,s=function(e){e.preventDefault()};return c.addEventListener("wheel",s,{passive:!1}),function(){c.removeEventListener("wheel",s)}}),[]);var t=function(n){return f((function(n){var t=(0,r.d)(n,g);g.draggingElement.points.push([t.x,t.y]),m(e.current,g)}))},c=function(e){return function(){console.log("appState...",g),console.log("elements...",p.map((function(e){return e.points.length}))),window.removeEventListener("pointermove",e.eventListeners.onMove),window.removeEventListener("pointerup",e.eventListeners.onUp)}};return(0,w.jsxs)("div",{className:"free-draw",children:[(0,w.jsx)("div",{className:"container",ref:n,children:(0,w.jsx)("canvas",{ref:e,className:"canvas",onPointerDown:function(e){var n=(0,r.d)(e,g),o={origin:n,lastCoords:(0,i.Z)({},n),eventListeners:{onMove:null,onUp:null}},a={x:o.origin.x,y:o.origin.y,points:[],strokeColor:"#000000",backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid"};g.draggingElement=a,p.push(a);var l=t(o),s=c(o);window.addEventListener("pointermove",l),window.addEventListener("pointerup",s),o.eventListeners.onMove=l,o.eventListeners.onUp=s},children:"\u7ed8\u5236canvas"})}),(0,w.jsx)("div",{id:"offscreen"}),(0,w.jsx)(a.Z,{src:l})]})}))},84:function(e,n,t){t.d(n,{d:function(){return i}});var i=function(e,n){var t=e.clientX,i=e.clientY,o=n.offsetLeft,r=n.offsetTop;return{x:t-o-n.scrollX,y:i-r-n.scrollY}}},6818:function(e,n,t){e.exports=t.p+"static/media/\u70b9\u7a00\u91ca.31d6cfe0d16ae931b73c.md"}}]);
//# sourceMappingURL=DrawImage.1f77eaa3.chunk.js.map