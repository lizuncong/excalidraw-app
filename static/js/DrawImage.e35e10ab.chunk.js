"use strict";(self.webpackChunkexcalidraw_app=self.webpackChunkexcalidraw_app||[]).push([[536],{1890:function(e,n,t){t.d(n,{Z:function(){return h}});var i=t(1413),o=t(4925),r=t(9439),a=t(2791),l=t(1350),c=t(1926),s=t(4209),u=t(6571),d=(t(3659),t(184)),f=["node","inline","className","children"];var h=function(e){var n=e.src,t=(0,a.useState)(""),h=(0,r.Z)(t,2),v=h[0],p=h[1];return(0,a.useEffect)((function(){fetch(n).then((function(e){return e.text()})).then((function(e){p(e)}))}),[n]),(0,d.jsx)("div",{className:"markdown-body",children:(0,d.jsx)(l.D,{children:v,rehypePlugins:[u.Z],remarkPlugins:[c.Z],components:{code:function(e){e.node;var n=e.inline,t=e.className,r=e.children,a=(0,o.Z)(e,f),l=/language-(\w+)/.exec(t||"");return!n&&l?(0,d.jsx)(s.Z,(0,i.Z)({children:String(r).replace(/\n$/,""),language:l[1],className:"my-code",PreTag:"div"},a)):(0,d.jsx)("code",(0,i.Z)((0,i.Z)({className:t},a),{},{children:r}))}}})})}},9905:function(e,n,t){t.r(n),t.d(n,{default:function(){return m},elements:function(){return p}});var i=t(1413),o=t(2791),r=t(84),a=t(1890),l=t(6818),c=t(9439),s=t(8943),u=new WeakMap,d=function(e){u.delete(e)},f=function(e,n){p.forEach((function(t){var o=function(e){var n=u.get(e);if(n)return n;var t,o,r=document.createElement("canvas"),a=r.getContext("2d"),l=(0,s.qf)((0,i.Z)((0,i.Z)({},e),{},{points:e.points.map((function(n){return[n[0]-e.x,n[1]-e.y]}))})),d=(0,c.Z)(l,4),f=d[0],h=d[1],v=d[2],p=d[3];return r.width=(0,s.TE)(f,v)*window.devicePixelRatio+40,r.height=(0,s.TE)(h,p)*window.devicePixelRatio+40,t=e.x>f?(0,s.TE)(e.x,f)*window.devicePixelRatio:0,o=e.y>h?(0,s.TE)(e.y,h)*window.devicePixelRatio:0,a.translate(t,o),a.save(),a.translate(20,20),a.scale(window.devicePixelRatio,window.devicePixelRatio),a.lineWidth=3,a.strokeStyle=e.strokeStyle,e.points.forEach((function(n,t){var i=(0,c.Z)(n,2),o=i[0],r=i[1];o-=e.x,r-=e.y,t?a.lineTo(o,r):a.moveTo(o,r)})),a.stroke(),a.restore(),u.set(e,r),r}(t),r=(0,s.qf)((0,i.Z)((0,i.Z)({},t),{},{points:t.points.map((function(e){return[e[0]-t.x,e[1]-t.y]}))})),a=(0,c.Z)(r,4),l=a[0],d=a[1],f=a[2],h=a[3];l=Math.floor(l),f=Math.ceil(f),d=Math.floor(d),h=Math.ceil(h);var v=((l+f)/2+n.scrollX)*window.devicePixelRatio,p=((d+h)/2+n.scrollY)*window.devicePixelRatio;e.save(),e.scale(1/window.devicePixelRatio,1/window.devicePixelRatio),e.translate(v,p),e.drawImage(o,-(f-l)/2*window.devicePixelRatio-20,-(h-d)/2*window.devicePixelRatio-20,o.width,o.height),e.restore()}))},h=function(e,n){var t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),f(t,n),localStorage.setItem("free-draw-elements",JSON.stringify(p))},v=t(184),p=JSON.parse(localStorage.getItem("free-draw-elements"))||[],w={offsetLeft:0,offsetTop:0,scrollX:0,scrollY:0,draggingElement:null},m=(0,o.memo)((function(){var e=(0,o.useRef)(null),n=(0,o.useRef)(null);(0,o.useEffect)((function(){var t=e.current,i=t.getContext("2d"),o=t.offsetWidth,r=t.offsetHeight,a=t.offsetLeft,l=t.offsetTop;t.width=o*window.devicePixelRatio,t.height=r*window.devicePixelRatio,i.scale(window.devicePixelRatio,window.devicePixelRatio),w.offsetLeft=a,w.offsetTop=l,h(t,w);var c=n.current,s=function(e){e.preventDefault()};return c.addEventListener("wheel",s,{passive:!1}),function(){c.removeEventListener("wheel",s)}}),[]);var t=function(n){return(0,s.$9)((function(n){var t=(0,r.d)(n,w);w.draggingElement.points.push([t.x,t.y]),d(w.draggingElement),h(e.current,w)}))},c=function(e){return function(){console.log("appState...",w),console.log("elements...",p.map((function(e){return e.points.length}))),window.removeEventListener("pointermove",e.eventListeners.onMove),window.removeEventListener("pointerup",e.eventListeners.onUp)}};return(0,v.jsxs)("div",{className:"draw-image",children:[(0,v.jsx)("div",{className:"container",ref:n,children:(0,v.jsx)("canvas",{ref:e,className:"canvas",onPointerDown:function(e){var n=(0,r.d)(e,w),o={origin:n,lastCoords:(0,i.Z)({},n),eventListeners:{onMove:null,onUp:null}},a={x:o.origin.x,y:o.origin.y,points:[[o.origin.x,o.origin.y]],strokeColor:"#000000",backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:(0,r.B)()};w.draggingElement=a,d(a),p.push(a);var l=t(o),s=c(o);window.addEventListener("pointermove",l),window.addEventListener("pointerup",s),o.eventListeners.onMove=l,o.eventListeners.onUp=s},children:"\u7ed8\u5236canvas"})}),(0,v.jsx)(a.Z,{src:l})]})}))},8943:function(e,n,t){t.d(n,{$9:function(){return l},TE:function(){return s},eu:function(){return d},qf:function(){return c}});var i=t(9439),o=t(7762),r=t(3433),a=t(4164),l=function(e){return function(e,n){var t=null,i=null,o=null,a=function n(a){t=window.requestAnimationFrame((function(){t=null,e.apply(void 0,(0,r.Z)(a)),i=null,o&&(i=o,o=null,n(i))}))},l=function(){for(var e=arguments.length,r=new Array(e),l=0;l<e;l++)r[l]=arguments[l];i=r,null===t?a(i):null!==n&&void 0!==n&&n.trailing&&(o=r)};return l.flush=function(){null!==t&&(cancelAnimationFrame(t),t=null),i&&(e.apply(void 0,(0,r.Z)(o||i)),i=o=null)},l.cancel=function(){i=o=null,null!==t&&(cancelAnimationFrame(t),t=null)},l}((function(n){(0,a.unstable_batchedUpdates)(e,n)}))},c=function(e){var n=function(e){var n,t=1/0,r=1/0,a=-1/0,l=-1/0,c=(0,o.Z)(e);try{for(c.s();!(n=c.n()).done;){var s=(0,i.Z)(n.value,2),u=s[0],d=s[1];t=Math.min(t,u),r=Math.min(r,d),a=Math.max(a,u),l=Math.max(l,d)}}catch(f){c.e(f)}finally{c.f()}return[t,r,a,l]}(e.points),t=(0,i.Z)(n,4),r=t[0],a=t[1],l=t[2],c=t[3],s=r+e.x,u=a+e.y,d=l+e.x,f=c+e.y;return[s,u,d,f,(s+d)/2,(u+f)/2]},s=function(e,n){return Math.abs(e-n)},u=0,d=function(){return(JSON.parse(localStorage.getItem("free-draw-elements"))||[]).map((function(e){var n=e.points.map((function(n){return[n[0]-e.x,n[1]-e.y]})),t=function(e){var n=e.map((function(e){return e[0]})),t=e.map((function(e){return e[1]}));return{width:Math.max.apply(Math,(0,r.Z)(n))-Math.min.apply(Math,(0,r.Z)(n)),height:Math.max.apply(Math,(0,r.Z)(t))-Math.min.apply(Math,(0,r.Z)(t))}}(n),i=t.width,o=t.height;return{id:"id".concat(u++),type:"freedraw",x:e.x,y:e.y,width:i,height:o,angle:0,strokeColor:e.strokeStyle,backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",roughness:1,opacity:100,groupIds:[],roundness:null,seed:Math.floor(Math.random()*Math.pow(2,31)),version:1,versionNonce:0,isDeleted:!1,boundElements:null,updated:Date.now(),link:null,locked:!1,points:n,pressures:[],simulatePressure:!0,lastCommittedPoint:n[n.length-1]}}))};window.__generateExcalidrawElements=d},84:function(e,n,t){t.d(n,{B:function(){return o},d:function(){return i}});var i=function(e,n){var t=e.clientX,i=e.clientY,o=n.offsetLeft,r=n.offsetTop;return{x:t-o-n.scrollX,y:i-r-n.scrollY}},o=function(){var e=Math.floor(256*Math.random()),n=Math.floor(256*Math.random()),t=Math.floor(256*Math.random());return"rgb(".concat(e,",").concat(n,",").concat(t,")")}},6818:function(e,n,t){e.exports=t.p+"static/media/\u70b9\u7a00\u91ca.31d6cfe0d16ae931b73c.md"}}]);
//# sourceMappingURL=DrawImage.e35e10ab.chunk.js.map