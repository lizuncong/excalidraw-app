{"version":3,"file":"static/js/Canvas.ba03b97a.chunk.js","mappings":"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","sources":["pages/canvas/renderer.js","pages/canvas/index.jsx"],"sourcesContent":["export const drawSelection = (context, { scrollX, scrollY }) => {\n  context.save();\n  context.translate(scrollX, scrollY);\n  context.fillStyle = \"rgba(0, 0, 200, 0.04)\";\n\n  context.fillRect(0, 0, 200, 200);\n  context.lineWidth = 1;\n  context.strokeStyle = \"rgb(105, 101, 219)\";\n  context.strokeRect(0, 0, 200, 200);\n\n  context.restore();\n};\n\nexport const drawAxis = (ctx, { scrollX, scrollY }) => {\n  ctx.save();\n\n  const rectH = 30; // 纵轴刻度间距\n  const rectW = 30; // 横轴刻度间距\n  const tickLength = 15; // 刻度线长度\n  const canvas = ctx.canvas;\n  ctx.translate(scrollX, scrollY);\n  ctx.beginPath();\n  ctx.lineWidth = 2;\n  for (let i = 0; i < canvas.width / rectH; i++) {\n    // 绘制纵轴刻度\n    ctx.moveTo(0, i * rectH);\n    ctx.lineTo(tickLength, i * rectH);\n    ctx.font = \"20px Arial\";\n    ctx.fillText(i, 0, i * rectH);\n    // 绘制横轴刻度\n    ctx.moveTo(i * rectW, 0);\n    ctx.lineTo(i * rectW, tickLength);\n    ctx.font = \"20px Arial\";\n    ctx.fillText(i, i * rectW, 8);\n  }\n  ctx.stroke();\n  // ctx.closePath();\n\n  ctx.restore();\n};\n\nexport const renderCanvas = (ctx, renderConfig) => {\n  const canvas = ctx.canvas;\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n  drawAxis(ctx, renderConfig);\n  drawSelection(ctx, renderConfig);\n};\n","import React, { memo, useRef, useEffect } from \"react\";\n// import { viewportCoordsToSceneCoords } from \"./util\";\nimport { renderCanvas } from \"./renderer\";\nimport \"./index.less\";\nconst Canvas = memo(() => {\n  const canvasRef = useRef(null);\n  const canvasContainer = useRef(null);\n  const canvasStateRef = useRef({\n    scrollX: 0,\n    scrollY: 0,\n    offsetLeft: 0,\n    offsetTop: 0,\n  });\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n    const { offsetWidth, offsetHeight, offsetLeft, offsetTop } = canvas;\n\n    canvas.width = offsetWidth * window.devicePixelRatio;\n    canvas.height = offsetHeight * window.devicePixelRatio;\n    canvasStateRef.current.offsetLeft = offsetLeft;\n    canvasStateRef.current.offsetTop = offsetTop;\n    renderCanvas(ctx, canvasStateRef.current);\n  }, []);\n  useEffect(() => {\n    const wrap = canvasContainer.current;\n    const handleWheel = (e) => {\n      e.preventDefault();\n    };\n    // 防止双指滑动时切换页面\n    wrap.addEventListener(\"wheel\", handleWheel, {\n      passive: false,\n    });\n    return () => {\n      wrap.removeEventListener(\"wheel\", handleWheel);\n    };\n  }, []);\n  const handleCanvasWheel = (event) => {\n    const { deltaX, deltaY } = event;\n    canvasStateRef.current.scrollX = canvasStateRef.current.scrollX - deltaX;\n    canvasStateRef.current.scrollY = canvasStateRef.current.scrollY - deltaY;\n\n    renderCanvas(canvasRef.current.getContext(\"2d\"), canvasStateRef.current);\n\n    console.log(\n      \"wheel\",\n      canvasStateRef.current.scrollX,\n      canvasStateRef.current.scrollY\n    );\n  };\n  const handleWindowPointerMove = (event) => {\n    console.log(\"handleWindowPointerMove=========\", event.target);\n  };\n  const handleCanvasPointerDown = (event) => {\n    // const pointerDownState = this.initialPointerDownState(event);\n    console.log(\"pointer down===\", event);\n    window.addEventListener(\"pointermove\", handleWindowPointerMove);\n  };\n\n  // const initialPointerDownState = (event) => {\n  //   const origin = viewportCoordsToSceneCoords(\n  //     { clientX: event.clientX, clientY: event.clientY },\n  //     canvasStateRef.current\n  //   );\n  // };\n\n  return (\n    <div ref={canvasContainer}>\n      <canvas\n        onWheel={handleCanvasWheel}\n        onPointerDown={handleCanvasPointerDown}\n        onPointerUp={(e) => {\n          window.removeEventListener(\"pointermove\", handleWindowPointerMove);\n        }}\n        ref={canvasRef}\n        className=\"canvas\"\n      >\n        绘制canvas\n      </canvas>\n    </div>\n  );\n});\n\nexport default Canvas;\n"],"names":["renderCanvas","ctx","renderConfig","canvas","clearRect","width","height","scrollX","scrollY","save","translate","beginPath","lineWidth","i","moveTo","lineTo","font","fillText","stroke","restore","drawAxis","context","fillStyle","fillRect","strokeStyle","strokeRect","drawSelection","Canvas","memo","canvasRef","useRef","canvasContainer","canvasStateRef","offsetLeft","offsetTop","useEffect","current","getContext","offsetWidth","offsetHeight","window","devicePixelRatio","wrap","handleWheel","e","preventDefault","addEventListener","passive","removeEventListener","handleWindowPointerMove","event","console","log","target","ref","onWheel","deltaX","deltaY","onPointerDown","onPointerUp","className"],"sourceRoot":""}