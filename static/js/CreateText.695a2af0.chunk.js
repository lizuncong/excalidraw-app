"use strict";(self.webpackChunkexcalidraw_app=self.webpackChunkexcalidraw_app||[]).push([[465],{1890:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(1413),i=n(4925),a=n(9439),o=n(2791),l=n(1350),c=n(1926),s=n(4209),u=n(6571),d=(n(3659),n(184)),f=["node","inline","className","children"];var h=function(e){var t=e.src,n=(0,o.useState)(""),h=(0,a.Z)(n,2),g=h[0],v=h[1];return(0,o.useEffect)((function(){fetch(t).then((function(e){return e.text()})).then((function(e){v(e)}))}),[t]),(0,d.jsx)("div",{className:"markdown-body",children:(0,d.jsx)(l.D,{children:g,rehypePlugins:[u.Z],remarkPlugins:[c.Z],components:{code:function(e){e.node;var t=e.inline,n=e.className,a=e.children,o=(0,i.Z)(e,f),l=/language-(\w+)/.exec(n||"");return!t&&l?(0,d.jsx)(s.Z,(0,r.Z)({children:String(a).replace(/\n$/,""),language:l[1],className:"my-code",PreTag:"div"},o)):(0,d.jsx)("code",(0,r.Z)((0,r.Z)({className:n},o),{},{children:a}))}}})})}},9136:function(e,t,n){n.r(t),n.d(t,{default:function(){return w},elements:function(){return m}});var r=n(2791),i=n(84),a=n(1890),o=n(6818),l=n(9439),c=n(1413),s=n(4925),u=["x","y","strokeColor","backgroundColor","fillStyle","strokeWidth","strokeStyle","roughness","opacity","width","height","angle"],d=function(e){var t=function(e){return e.replace(/\t/g,"        ").replace(/\r?\n|\r/g,"\n")}(e.text);return(0,c.Z)((0,c.Z)({},function(e,t){var n=t.x,r=t.y,a=t.strokeColor,o=t.backgroundColor,l=t.fillStyle,c=t.strokeWidth,d=t.strokeStyle,f=t.roughness,h=t.opacity,g=t.width,v=void 0===g?0:g,x=t.height,p=void 0===x?0:x,m=t.angle,y=void 0===m?0:m;return(0,s.Z)(t,u),{id:(0,i.kb)(),type:e,x:n,y:r,width:v,height:p,angle:y,strokeColor:a,backgroundColor:o,fillStyle:l,strokeWidth:c,strokeStyle:d,roughness:f,opacity:h}}("text",e)),{},{text:t,fontSize:e.fontSize,fontFamily:e.fontFamily,textAlign:e.textAlign,verticalAlign:e.verticalAlign,containerId:e.containerId||null,originalText:t})},f=function(e){var t=e.fontSize,n=e.fontFamily;return"".concat(t,"px ").concat(n,", Segoe UI Emoji")},h="text-elements",g=new WeakMap,v=function(e,t){m.forEach((function(n){var r=function(e){var t=g.get(e);if(t)return t;var n=document.createElement("canvas"),r=n.getContext("2d");n.width=e.width*window.devicePixelRatio+40,n.height=e.height*window.devicePixelRatio+40,r.save(),r.translate(20,20),r.scale(window.devicePixelRatio,window.devicePixelRatio),r.font=f(e),r.fillStyle=e.strokeColor,r.textAlign=e.textAlign;var i=e.text.split("\n"),a=i.length?e.height/i.length-1:18;r.textBaseline="bottom";for(var o=0;o<i.length;o++)r.fillText(i[o],0,(o+1)*a);return r.restore(),g.set(e,n),n}(n),a=(0,i.qf)(n),o=(0,l.Z)(a,4),c=o[0],s=o[1],u=o[2],d=o[3],h=((c+u)/2+t.scrollX)*window.devicePixelRatio,v=((s+d)/2+t.scrollY)*window.devicePixelRatio;e.save(),e.scale(1/window.devicePixelRatio,1/window.devicePixelRatio),e.translate(h,v),console.log(),e.drawImage(r,-(u-c)/2*window.devicePixelRatio-20,-(d-s)/2*window.devicePixelRatio-20,r.width,r.height),e.restore()}))},x=function(e,t){var n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),v(n,t),localStorage.setItem(h,JSON.stringify(m))},p=n(184),m=JSON.parse(localStorage.getItem(h))||[],y={offsetLeft:0,offsetTop:0,scrollX:0,scrollY:0,canvasWidth:0,canvasHeight:0,draggingElement:null},w=(0,r.memo)((function(){var e=(0,r.useRef)(null),t=(0,r.useRef)(null),n=(0,r.useRef)(null),l=(0,r.useRef)(null);(0,r.useEffect)((function(){var r=function(e){var t=e.getContext("2d");e.width=a*window.devicePixelRatio,e.height=o*window.devicePixelRatio,t.scale(window.devicePixelRatio,window.devicePixelRatio)},i=e.current,a=i.offsetWidth,o=i.offsetHeight;r(i),r(n.current);var l=i.getBoundingClientRect(),c=l.x,s=l.y;y.offsetLeft=c,y.offsetTop=s,y.canvasWidth=a,y.canvasHeight=o,x(n.current,y);var u=t.current,d=function(e){e.preventDefault()};return u.addEventListener("wheel",d,{passive:!1}),function(){u.removeEventListener("wheel",d)}}),[]);return(0,p.jsxs)("div",{className:"create-text",children:[(0,p.jsxs)("div",{className:"container wrap",ref:t,children:[(0,p.jsx)("canvas",{ref:n,className:"canvas",children:"\u9759\u6001canvas"}),(0,p.jsx)("canvas",{ref:e,className:"canvas draw",onDoubleClick:function(t){t.preventDefault(),t.stopPropagation();var r=(0,i.dE)(t,y),a=r.x,o=r.y,c=d({x:a,y:o,strokeColor:(0,i.B8)(),backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",text:"",fontSize:20,fontFamily:"Virgil",textAlign:"left",verticalAlign:"top"});y.draggingElement=c,e.current.style.cursor="";var s=l.current;s.value=c.text,s.tabIndex=0,s.focus();var u={font:f(c),left:"".concat(a,"px"),top:"".concat(o,"px"),opacity:1,color:c.strokeColor,fontSize:c.fontSize};Object.assign(s.style,u);var h=document.getElementById("copyText");Object.assign(h.style,u);var v=y.canvasWidth-a;s.style.width="".concat(v,"px");var p=function(e){var t=s.value;h.innerText=t,s.style.height=s.scrollHeight+"px",h.offsetWidth>v&&(h.innerText=t.slice(0,t.length-1)+"\n"+t.slice(t.length-1),s.value=h.innerText),c.text=s.value};s.addEventListener("blur",(function e(t){c.text&&(c.width=h.offsetWidth,c.height=h.offsetHeight,function(e){g.delete(e)}(y.draggingElement),m.push(y.draggingElement),x(n.current,y),setTimeout((function(){h.innerText=""}),200)),s.innerText="",Object.assign(s.style,{left:"0px",top:"0px",width:0,opacity:0}),s.removeEventListener("blur",e),s.removeEventListener("input",p)})),s.addEventListener("input",p)},children:"\u52a8\u6001canvas"}),(0,p.jsx)("textarea",{className:"textarea",ref:l})]}),(0,p.jsx)("div",{id:"offscreen"}),(0,p.jsx)(a.Z,{src:o}),(0,p.jsx)("div",{style:{background:"grey"},id:"copyText",contentEditable:!0,className:"textarea textarea_copy"})]})}))},84:function(e,t,n){n.d(t,{$9:function(){return s},B8:function(){return c},KP:function(){return f},TE:function(){return g},dE:function(){return l},kb:function(){return x},qf:function(){return h}});var r=n(9439),i=n(7762),a=n(3433),o=n(4164),l=function(e,t){var n=e.clientX,r=e.clientY,i=t.offsetLeft,a=t.offsetTop;return{x:n-i-t.scrollX,y:r-a-t.scrollY}},c=function(){var e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random()),n=Math.floor(256*Math.random());return"rgb(".concat(e,",").concat(t,",").concat(n,")")},s=function(e){return function(e,t){var n=null,r=null,i=null,o=function t(o){n=window.requestAnimationFrame((function(){n=null,e.apply(void 0,(0,a.Z)(o)),r=null,i&&(r=i,i=null,t(r))}))},l=function(){for(var e=arguments.length,a=new Array(e),l=0;l<e;l++)a[l]=arguments[l];r=a,null===n?o(r):null!==t&&void 0!==t&&t.trailing&&(i=a)};return l.flush=function(){null!==n&&(cancelAnimationFrame(n),n=null),r&&(e.apply(void 0,(0,a.Z)(i||r)),r=i=null)},l.cancel=function(){r=i=null,null!==n&&(cancelAnimationFrame(n),n=null)},l}((function(t){(0,o.unstable_batchedUpdates)(e,t)}))},u=function(e){var t=1/0,n=1/0,a=-1/0,o=-1/0,l=e.points;"freedraw"===e.type&&(l=e.points.map((function(t){return[t[0]-e.x,t[1]-e.y]})));var c,s=(0,i.Z)(l);try{for(s.s();!(c=s.n()).done;){var u=(0,r.Z)(c.value,2),d=u[0],f=u[1];t=Math.min(t,d),n=Math.min(n,f),a=Math.max(a,d),o=Math.max(o,f)}}catch(h){s.e(h)}finally{s.f()}return[t,n,a,o]},d=function(e,t,n,r,i){return[(e-n)*Math.cos(i)-(t-r)*Math.sin(i)+n,(e-n)*Math.sin(i)+(t-r)*Math.cos(i)+r]},f=function(e){if(!e.length)return[0,0,0,0];var t=1/0,n=-1/0,i=1/0,a=-1/0;return e.forEach((function(e){var o=function(e){var t=h(e),n=(0,r.Z)(t,6),i=n[0],a=n[1],o=n[2],l=n[3],c=n[4],s=n[5];if("freedraw"===e.type){var f=u(e),g=(0,r.Z)(f,4),v=g[0],x=g[1],p=g[2],m=g[3];return[v+e.x,x+e.y,p+e.x,m+e.y]}var y=d(i,a,c,s,e.angle),w=(0,r.Z)(y,2),k=w[0],M=w[1],Z=d(i,l,c,s,e.angle),S=(0,r.Z)(Z,2),b=S[0],E=S[1],P=d(o,l,c,s,e.angle),C=(0,r.Z)(P,2),R=C[0],j=C[1],N=d(o,a,c,s,e.angle),T=(0,r.Z)(N,2),A=T[0],W=T[1];return[Math.min(k,b,R,A),Math.min(M,E,j,W),Math.max(k,b,R,A),Math.max(M,E,j,W)]}(e),l=(0,r.Z)(o,4),c=l[0],s=l[1],f=l[2],g=l[3];t=Math.min(t,c),i=Math.min(i,s),n=Math.max(n,f),a=Math.max(a,g)})),[t,i,n,a]},h=function(e){if("freedraw"===e.type){var t=u(e),n=(0,r.Z)(t,4),i=n[0],a=n[1],o=n[2],l=n[3],c=i+e.x,s=a+e.y,d=o+e.x,f=l+e.y;return[c,s,d,f,(c+d)/2,(s+f)/2]}return[e.x,e.y,e.x+e.width,e.y+e.height,e.x+e.width/2,e.y+e.height/2]},g=function(e,t){return Math.abs(e-t)},v=0,x=function(){return"id".concat(v++)};window.__generateExcalidrawElements=function(){return(JSON.parse(localStorage.getItem("free-draw-elements"))||[]).map((function(e){var t=e.points.map((function(t){return[t[0]-e.x,t[1]-e.y]})),n=function(e){var t=e.map((function(e){return e[0]})),n=e.map((function(e){return e[1]}));return{width:Math.max.apply(Math,(0,a.Z)(t))-Math.min.apply(Math,(0,a.Z)(t)),height:Math.max.apply(Math,(0,a.Z)(n))-Math.min.apply(Math,(0,a.Z)(n))}}(t),r=n.width,i=n.height;return{id:x(),type:"freedraw",x:e.x,y:e.y,width:r,height:i,angle:0,strokeColor:e.strokeStyle,backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",roughness:1,opacity:100,groupIds:[],roundness:null,seed:Math.floor(Math.random()*Math.pow(2,31)),version:1,versionNonce:0,isDeleted:!1,boundElements:null,updated:Date.now(),link:null,locked:!1,points:t,pressures:[],simulatePressure:!0,lastCommittedPoint:t[t.length-1]}}))}},6818:function(e,t,n){e.exports=n.p+"static/media/\u70b9\u7a00\u91ca.31d6cfe0d16ae931b73c.md"}}]);
//# sourceMappingURL=CreateText.695a2af0.chunk.js.map