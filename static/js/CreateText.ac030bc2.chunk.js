"use strict";(this.webpackChunkexcalidraw_app=this.webpackChunkexcalidraw_app||[]).push([[465],{45650:function(e,t,n){n.d(t,{Z:function(){return h}});var i=n(1413),a=n(44925),r=n(29439),o=n(4519),l=n(19149),c=n(49410),u=n(88106),s=n(1695),f=(n(99011),n(2556)),d=["node","inline","className","children"];var h=function(e){var t=e.src,n=(0,o.useState)(""),h=(0,r.Z)(n,2),g=h[0],x=h[1];return(0,o.useEffect)((function(){fetch(t).then((function(e){return e.text()})).then((function(e){x(e)}))}),[t]),(0,f.jsx)("div",{className:"markdown-body",children:(0,f.jsx)(l.D,{children:g,rehypePlugins:[s.Z],remarkPlugins:[c.Z],components:{code:function(e){e.node;var t=e.inline,n=e.className,r=e.children,o=(0,a.Z)(e,d),l=/language-(\w+)/.exec(n||"");return!t&&l?(0,f.jsx)(u.Z,(0,i.Z)({children:String(r).replace(/\n$/,""),language:l[1],className:"my-code",PreTag:"div"},o)):(0,f.jsx)("code",(0,i.Z)((0,i.Z)({className:n},o),{},{children:r}))}}})})}},82487:function(e,t,n){n.r(t),n.d(t,{default:function(){return w},elements:function(){return p}});var i=n(29439),a=n(4519),r=n(45204),o=n(45650),l=n(36818),c=n(1413),u=n(44925),s=["x","y","strokeColor","backgroundColor","fillStyle","strokeWidth","strokeStyle","roughness","opacity","width","height","angle"],f=function(e){var t=function(e){return e.replace(/\t/g,"        ").replace(/\r?\n|\r/g,"\n")}(e.text);return(0,c.Z)((0,c.Z)({},function(e,t){var n=t.x,i=t.y,a=t.strokeColor,o=t.backgroundColor,l=t.fillStyle,c=t.strokeWidth,f=t.strokeStyle,d=t.roughness,h=t.opacity,g=t.width,x=void 0===g?0:g,v=t.height,m=void 0===v?0:v,p=t.angle,y=void 0===p?0:p;return(0,u.Z)(t,s),{id:(0,r.kb)(),type:e,x:n,y:i,width:x,height:m,angle:y,strokeColor:a,backgroundColor:o,fillStyle:l,strokeWidth:c,strokeStyle:f,roughness:d,opacity:h}}("text",e)),{},{text:t,fontSize:e.fontSize,fontFamily:e.fontFamily,textAlign:e.textAlign,verticalAlign:e.verticalAlign,containerId:e.containerId||null,originalText:t})},d=function(e){var t=e.fontSize,n=e.fontFamily;return"".concat(t,"px ").concat(n,", Segoe UI Emoji")},h="text-elements",g=new WeakMap,x=function(e,t){p.forEach((function(n){var a=function(e){var t=g.get(e);if(t)return t;var n=document.createElement("canvas"),i=n.getContext("2d");n.width=e.width*window.devicePixelRatio+40,n.height=e.height*window.devicePixelRatio+40,i.save(),i.translate(20,20),i.scale(window.devicePixelRatio,window.devicePixelRatio),i.font=d(e),i.fillStyle=e.strokeColor,i.textAlign=e.textAlign;var a=e.text.split("\n"),r=a.length?e.height/a.length:18;i.textBaseline="bottom";for(var o=0;o<a.length;o++)i.fillText(a[o],0,(o+1)*r);return i.restore(),g.set(e,n),n}(n),o=(0,r.qf)(n),l=(0,i.Z)(o,4),c=l[0],u=l[1],s=l[2],f=l[3],h=((c+s)/2+t.scrollX)*window.devicePixelRatio,x=((u+f)/2+t.scrollY)*window.devicePixelRatio;e.save(),e.scale(1/window.devicePixelRatio,1/window.devicePixelRatio),e.translate(h,x),e.drawImage(a,-(s-c)/2*window.devicePixelRatio-20,-(f-u)/2*window.devicePixelRatio-20,a.width,a.height),e.restore()}))},v=function(e,t){var n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),x(n,t),localStorage.setItem(h,JSON.stringify(p))},m=n(2556),p=JSON.parse(localStorage.getItem(h))||[],y={offsetLeft:0,offsetTop:0,scrollX:0,scrollY:0,canvasWidth:0,canvasHeight:0,draggingElement:null},w=(0,a.memo)((function(){var e=(0,a.useRef)(null),t=(0,a.useRef)(null),n=(0,a.useRef)(null),c=(0,a.useRef)(null),u=(0,a.useState)(""),s=(0,i.Z)(u,2),h=s[0],x=s[1];(0,a.useEffect)((function(){var i=function(e){var t=e.getContext("2d");e.width=r*window.devicePixelRatio,e.height=o*window.devicePixelRatio,t.scale(window.devicePixelRatio,window.devicePixelRatio)},a=e.current,r=a.offsetWidth,o=a.offsetHeight;i(a),i(n.current);var l=a.getBoundingClientRect(),c=l.x,u=l.y;y.offsetLeft=c,y.offsetTop=u,y.canvasWidth=r,y.canvasHeight=o,v(n.current,y);var s=t.current,f=function(e){e.preventDefault()};return s.addEventListener("wheel",f,{passive:!1}),function(){s.removeEventListener("wheel",f)}}),[]);return(0,m.jsxs)("div",{className:"create-text",children:[(0,m.jsxs)("div",{className:"container wrap",ref:t,children:[(0,m.jsx)("canvas",{ref:n,className:"canvas",children:"\u9759\u6001canvas"}),(0,m.jsx)("canvas",{ref:e,className:"canvas draw",onDoubleClick:function(e){e.preventDefault(),e.stopPropagation();var t=(0,r.dE)(e,y),n=t.x,i=t.y,a=f({x:n,y:i,strokeColor:(0,r.B8)(),backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",text:"",fontSize:20,fontFamily:"Virgil",textAlign:"left",verticalAlign:"top"});y.draggingElement=a;var o=c.current;o.focus();var l={font:d(a),left:"".concat(n,"px"),top:"".concat(i,"px"),opacity:1,color:a.strokeColor,fontSize:a.fontSize};Object.assign(o.style,l);var u=document.getElementById("copyText");Object.assign(u.style,l);var s=y.canvasWidth-n;o.style.maxWidth="".concat(s,"px"),o.style.width="".concat(a.fontSize,"px"),o.style.height="".concat(1.2*a.fontSize,"px")},children:"\u52a8\u6001canvas"}),(0,m.jsx)("textarea",{onChange:function(e){var t=e.target.value,n=c.current,i=parseFloat(n.style.maxWidth),a=document.getElementById("copyText");a.innerText=t;var r=a.getBoundingClientRect().width;if(r>i)if(r-i<30)t=a.innerText=t.slice(0,t.length-1)+"\n"+t.slice(t.length-1);else{var o=t.split("\n"),l=[];o.forEach((function(e){if(a.innerText=e,a.getBoundingClientRect().width<=i)l.push(e);else for(var t=0,n=1;n<e.length;n++){var r=e.slice(t,n);a.innerText=r,a.getBoundingClientRect().width>i?(l.push(e.slice(t,n-1)),t=n-1):n===e.length-1&&l.push(e.slice(t,n))}})),t=l.join("\n"),a.innerText=t}x(t);var u=a.getBoundingClientRect(),s=u.width,f=u.height;n.style.width="".concat(s+30,"px"),n.style.height="".concat(f,"px"),y.draggingElement.text=t},onBlur:function(){var e=y.draggingElement,t=c.current,i=document.getElementById("copyText");e.text&&(e.width=i.offsetWidth,e.height=i.offsetHeight,function(e){g.delete(e)}(y.draggingElement),p.push(y.draggingElement),v(n.current,y),setTimeout((function(){i.innerText="",x("")}),200)),Object.assign(t.style,{left:"0px",top:"0px",width:"20px",height:"30px",opacity:0})},value:h,className:"textarea",ref:c})]}),(0,m.jsx)("div",{id:"offscreen"}),(0,m.jsx)(o.Z,{src:l}),(0,m.jsx)("div",{style:{background:"grey"},id:"copyText",contentEditable:!0,className:"textarea textarea_copy"})]})}))},45204:function(e,t,n){n.d(t,{$9:function(){return u},B8:function(){return c},KP:function(){return h},Pi:function(){return d},TE:function(){return x},dE:function(){return l},kb:function(){return m},mO:function(){return p},qf:function(){return g}});var i=n(29439),a=n(37762),r=n(93433),o=n(84453),l=function(e,t){var n=e.clientX,i=e.clientY,a=t.zoom,r=t.offsetLeft,o=t.offsetTop,l=t.scrollX,c=t.scrollY,u=a?a.value:1;return{x:(n-r)/u-l,y:(i-o)/u-c}},c=function(){var e=Math.floor(256*Math.random()),t=Math.floor(256*Math.random()),n=Math.floor(256*Math.random());return"rgb(".concat(e,",").concat(t,",").concat(n,")")},u=function(e){return function(e,t){var n=null,i=null,a=null,o=function t(o){n=window.requestAnimationFrame((function(){n=null,e.apply(void 0,(0,r.Z)(o)),i=null,a&&(i=a,a=null,t(i))}))},l=function(){for(var e=arguments.length,r=new Array(e),l=0;l<e;l++)r[l]=arguments[l];i=r,null===n?o(i):null!==t&&void 0!==t&&t.trailing&&(a=r)};return l.flush=function(){null!==n&&(cancelAnimationFrame(n),n=null),i&&(e.apply(void 0,(0,r.Z)(a||i)),i=a=null)},l.cancel=function(){i=a=null,null!==n&&(cancelAnimationFrame(n),n=null)},l}((function(t){(0,o.unstable_batchedUpdates)(e,t)}))},s=function(e){var t=1/0,n=1/0,r=-1/0,o=-1/0,l=e.points;"freedraw"===e.type&&(l=e.points.map((function(t){return[t[0]-e.x,t[1]-e.y]})));var c,u=(0,a.Z)(l);try{for(u.s();!(c=u.n()).done;){var s=(0,i.Z)(c.value,2),f=s[0],d=s[1];t=Math.min(t,f),n=Math.min(n,d),r=Math.max(r,f),o=Math.max(o,d)}}catch(h){u.e(h)}finally{u.f()}return[t,n,r,o]},f=function(e,t,n,i,a){return[(e-n)*Math.cos(a)-(t-i)*Math.sin(a)+n,(e-n)*Math.sin(a)+(t-i)*Math.cos(a)+i]},d=function(e){var t=g(e),n=(0,i.Z)(t,6),a=n[0],r=n[1],o=n[2],l=n[3],c=n[4],u=n[5];if("freedraw"===e.type){var d=s(e),h=(0,i.Z)(d,4),x=h[0],v=h[1],m=h[2],p=h[3];return[x+e.x,v+e.y,m+e.x,p+e.y]}var y=f(a,r,c,u,e.angle),w=(0,i.Z)(y,2),k=w[0],S=w[1],Z=f(a,l,c,u,e.angle),M=(0,i.Z)(Z,2),R=M[0],E=M[1],C=f(o,l,c,u,e.angle),b=(0,i.Z)(C,2),P=b[0],j=b[1],T=f(o,r,c,u,e.angle),N=(0,i.Z)(T,2),A=N[0],B=N[1];return[Math.min(k,R,P,A),Math.min(S,E,j,B),Math.max(k,R,P,A),Math.max(S,E,j,B)]},h=function(e){if(!e.length)return[0,0,0,0];var t=1/0,n=-1/0,a=1/0,r=-1/0;return e.forEach((function(e){var o=d(e),l=(0,i.Z)(o,4),c=l[0],u=l[1],s=l[2],f=l[3];t=Math.min(t,c),a=Math.min(a,u),n=Math.max(n,s),r=Math.max(r,f)})),[t,a,n,r]},g=function(e){if("freedraw"===e.type){var t=s(e),n=(0,i.Z)(t,4),a=n[0],r=n[1],o=n[2],l=n[3],c=a+e.x,u=r+e.y,f=o+e.x,d=l+e.y;return[c,u,f,d,(c+f)/2,(u+d)/2]}return[e.x,e.y,e.x+e.width,e.y+e.height,e.x+e.width/2,e.y+e.height/2]},x=function(e,t){return Math.abs(e-t)},v=0,m=function(){return"id".concat(v++)},p=function(e){var t=e.fontSize,n=e.fontFamily;return"".concat(t,"px ").concat(n,", Segoe UI Emoji")}},36818:function(e,t,n){e.exports=n.p+"static/media/\u70b9\u7a00\u91ca.31d6cfe0d16ae931b73c.md"}}]);
//# sourceMappingURL=CreateText.ac030bc2.chunk.js.map