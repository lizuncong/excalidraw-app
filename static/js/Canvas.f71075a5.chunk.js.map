{"version":3,"file":"static/js/Canvas.f71075a5.chunk.js","mappings":"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","sources":["pages/canvas/util.js","pages/canvas/element/newElement.js","pages/canvas/renderer/renderElement.js","pages/canvas/renderer/renderScene.js","webpack://excalidraw-app/./src/pages/canvas/components/tools/index.module.less?8991","pages/canvas/components/icons/index.jsx","util/export.js","pages/canvas/scene/scene.js","pages/canvas/components/tools/index.jsx","webpack://excalidraw-app/./src/pages/canvas/components/scale/index.module.less?3a8b","pages/canvas/components/scale/index.jsx","webpack://excalidraw-app/./src/pages/canvas/components/layer-ui/index.module.less?8d4d","pages/canvas/components/layer-ui/index.jsx","webpack://excalidraw-app/./src/pages/canvas/components/textarea/index.module.less?82b0","pages/canvas/components/textarea/index.jsx","pages/canvas/index.jsx","util/index.js"],"sourcesContent":["export const viewportCoordsToSceneCoords = (\n  { clientX, clientY },\n  { offsetLeft, offsetTop, scrollX, scrollY }\n) => {\n  const x = clientX - offsetLeft - scrollX;\n  const y = clientY - offsetTop - scrollY;\n  return { x, y };\n};\n\nexport const distance = (x, y) => Math.abs(x - y);\nlet testIdBase = 0;\n\nexport const randomId = () => `id${testIdBase++}`;\n","import { randomId } from \"../util\";\nimport { rgb } from \"@/util\";\n\nexport const newElement = ({\n  type,\n  x,\n  y,\n  strokeColor,\n  backgroundColor,\n  fillStyle,\n  strokeWidth = 3,\n  strokeStyle,\n  width = 0,\n  height = 0,\n  angle = 0,\n  points = [],\n  ...rest\n}) => {\n  return {\n    id: randomId(),\n    type,\n    x,\n    y,\n    width,\n    height,\n    strokeColor,\n    backgroundColor,\n    fillStyle,\n    strokeWidth,\n    strokeStyle,\n    angle,\n    isDeleted: false,\n    points,\n    ...rest,\n  };\n};\n\nexport const createElement = ({ elementType, pointerDownState, appState }) => {\n  let element;\n  if (elementType === \"freedraw\") {\n    element = newElement({\n      type: elementType,\n      x: pointerDownState.origin.x,\n      y: pointerDownState.origin.y,\n      points: [[pointerDownState.origin.x, pointerDownState.origin.y]],\n      strokeColor: appState.currentItemStrokeColor,\n      backgroundColor: appState.currentItemBackgroundColor,\n      fillStyle: appState.currentItemFillStyle,\n      strokeWidth: appState.currentItemStrokeWidth,\n      strokeStyle: rgb(),\n    });\n  } else {\n    element = newElement({\n      type: elementType,\n      x: pointerDownState.origin.x,\n      y: pointerDownState.origin.y,\n      strokeColor: appState.currentItemStrokeColor,\n      backgroundColor: appState.currentItemBackgroundColor,\n      fillStyle: appState.currentItemFillStyle,\n      strokeWidth: appState.currentItemStrokeWidth,\n      strokeStyle: rgb(),\n    });\n  }\n\n  return element;\n};\n\nexport const newTextElement = (opts) => {\n  const textElement = newElement({\n    type: \"text\",\n    text: opts.text,\n    fontSize: opts.fontSize,\n    fontFamily: opts.fontFamily,\n    textAlign: opts.textAlign,\n    verticalAlign: opts.verticalAlign,\n    originalText: opts.text,\n    ...opts,\n  });\n\n  return textElement;\n};\n","import { getElementAbsoluteCoords, distance, getFontString } from \"@/util\";\nexport const renderElement = (element, context, renderConfig, appState) => {\n  const elementWithCanvas = generateElementWithCanvas(element, renderConfig);\n  drawElementFromCanvas(elementWithCanvas, context, renderConfig);\n};\n\nconst elementWithCanvasCache = new WeakMap();\n\nexport const deleteElementCache = (element) => {\n  elementWithCanvasCache.delete(element);\n};\n\nconst generateElementWithCanvas = (element, renderConfig) => {\n  const zoom = renderConfig.zoom || 1;\n  const prevElementWithCanvas = elementWithCanvasCache.get(element);\n  if (prevElementWithCanvas) {\n    return prevElementWithCanvas;\n  }\n  const elementWithCanvas = generateElementCanvas(element, zoom, renderConfig);\n\n  elementWithCanvasCache.set(element, elementWithCanvas);\n\n  return elementWithCanvas;\n};\nlet rightContainer = document.getElementById(\"placeholder\");\nlet previewCanvas = null;\nconst generateElementCanvas = (element, zoom, renderConfig) => {\n  const canvas = document.createElement(\"canvas\");\n  const context = canvas.getContext(\"2d\");\n  const padding = getCanvasPadding(element);\n  if (!rightContainer) {\n    rightContainer = document.getElementById(\"placeholder\");\n  }\n  if (previewCanvas) {\n    // rightContainer.removeChild(previewCanvas);\n  }\n  previewCanvas = canvas;\n  // rightContainer.appendChild(previewCanvas);\n\n  let canvasOffsetX = 0;\n  let canvasOffsetY = 0;\n  if (element.type === \"freedraw\") {\n    let [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\n    let canvasOffsetX = 0;\n    let canvasOffsetY = 0;\n    canvas.width = distance(x1, x2) * window.devicePixelRatio + padding * 2;\n    canvas.height = distance(y1, y2) * window.devicePixelRatio + padding * 2;\n    canvasOffsetX =\n      element.x > x1 ? distance(element.x, x1) * window.devicePixelRatio : 0;\n\n    canvasOffsetY =\n      element.y > y1 ? distance(element.y, y1) * window.devicePixelRatio : 0;\n    context.translate(canvasOffsetX, canvasOffsetY);\n  } else {\n    canvas.width =\n      element.width * window.devicePixelRatio * zoom + padding * zoom * 2;\n    canvas.height =\n      element.height * window.devicePixelRatio * zoom + padding * zoom * 2;\n  }\n\n  context.save();\n  context.translate(padding * zoom, padding * zoom);\n\n  context.scale(window.devicePixelRatio * zoom, window.devicePixelRatio * zoom);\n\n  drawElementOnCanvas(element, context, renderConfig);\n  context.restore();\n\n  return {\n    element,\n    canvas,\n    theme: renderConfig.theme,\n    canvasZoom: zoom,\n    canvasOffsetX,\n    canvasOffsetY,\n  };\n};\n\nconst drawElementOnCanvas = (element, context, renderConfig) => {\n  context.globalAlpha = element.opacity / 100;\n  switch (element.type) {\n    case \"rectangle\": {\n      context.lineJoin = \"round\";\n      context.lineCap = \"round\";\n      context.lineWidth = element.strokeWidth;\n      context.strokeStyle = element.strokeStyle;\n      context.strokeRect(0, 0, element.width, element.height);\n      break;\n    }\n    case \"text\": {\n      context.font = getFontString(element);\n      context.fillStyle = element.strokeColor;\n      context.textAlign = element.textAlign;\n      const lines = element.text.split(\"\\n\");\n      const lineHeight = lines.length ? element.height / lines.length : 18;\n      context.textBaseline = \"bottom\";\n      for (let index = 0; index < lines.length; index++) {\n        context.fillText(lines[index], 0, (index + 1) * lineHeight);\n      }\n      break;\n    }\n    case \"freedraw\": {\n      context.save();\n      context.lineWidth = element.strokeWidth;\n      context.strokeStyle = element.strokeStyle;\n      element.points.forEach((point, index) => {\n        let [x, y] = point;\n        x = x - element.x;\n        y = y - element.y;\n        if (!index) {\n          context.moveTo(x, y);\n        } else {\n          context.lineTo(x, y);\n        }\n      });\n\n      context.stroke();\n\n      context.restore();\n      break;\n    }\n    default: {\n    }\n  }\n  context.globalAlpha = 1;\n};\n\nconst getCanvasPadding = (element) =>\n  element.type === \"freedraw\" ? element.strokeWidth * 12 : 20;\n\nconst drawElementFromCanvas = (elementWithCanvas, context, renderConfig) => {\n  const element = elementWithCanvas.element;\n  const padding = getCanvasPadding(element);\n  let [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\n  if (element.type === \"freedraw\") {\n    [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\n  }\n  const cx = ((x1 + x2) / 2 + renderConfig.scrollX) * window.devicePixelRatio;\n  const cy = ((y1 + y2) / 2 + renderConfig.scrollY) * window.devicePixelRatio;\n  context.save();\n  context.scale(1 / window.devicePixelRatio, 1 / window.devicePixelRatio);\n  context.translate(cx, cy);\n\n  context.drawImage(\n    elementWithCanvas.canvas,\n    (-(x2 - x1) / 2) * window.devicePixelRatio -\n      (padding * elementWithCanvas.canvasZoom) / elementWithCanvas.canvasZoom,\n    (-(y2 - y1) / 2) * window.devicePixelRatio -\n      (padding * elementWithCanvas.canvasZoom) / elementWithCanvas.canvasZoom,\n    elementWithCanvas.canvas.width / elementWithCanvas.canvasZoom,\n    elementWithCanvas.canvas.height / elementWithCanvas.canvasZoom\n  );\n\n  context.restore();\n\n  // Clear the nested element we appended to the DOM\n};\n","import { renderElement } from \"./renderElement\";\n\n\nexport const drawAxis = (ctx, { scrollX, scrollY }) => {\n  ctx.save();\n  const rectH = 100; // 纵轴刻度间距\n  const rectW = 100; // 横轴刻度间距\n  const tickLength = 8; // 刻度线长度\n  const canvas = ctx.canvas;\n  ctx.strokeStyle = \"red\";\n  ctx.fillStyle = \"red\";\n  // 绘制横轴和纵轴刻度\n  ctx.beginPath();\n  ctx.lineWidth = 2;\n  ctx.textBaseline = \"middle\";\n  ctx.save();\n  ctx.translate(0, scrollY);\n  for (let i = 0; i < scrollY / rectH; i++) {\n    // 绘制纵轴刻度\n    ctx.moveTo(0, -i * rectH);\n    ctx.lineTo(tickLength, -i * rectH);\n    ctx.font = \"10px Arial\";\n    ctx.fillText(-i, 0, -i * rectH + 10);\n  }\n  for (let i = 1; i < (canvas.height - scrollY) / rectH; i++) {\n    // 绘制纵轴刻度\n    ctx.moveTo(0, i * rectH);\n    ctx.lineTo(tickLength, i * rectH);\n    ctx.font = \"10px Arial\";\n    ctx.fillText(i, 0, i * rectH + 10);\n  }\n  ctx.restore();\n  ctx.save();\n  ctx.translate(scrollX, 0);\n\n  for (let i = 0; i < scrollX / rectW; i++) {\n    // 绘制横轴刻度\n    ctx.moveTo(-i * rectW, 0);\n    ctx.lineTo(-i * rectW, tickLength);\n    ctx.font = \"10px Arial\";\n    ctx.fillText(-i, -i * rectW + 5, 5);\n  }\n  for (let i = 1; i < (canvas.width - scrollX) / rectW; i++) {\n    // 绘制横轴刻度\n    ctx.moveTo(i * rectW, 0);\n    ctx.lineTo(i * rectW, tickLength);\n    ctx.font = \"10px Arial\";\n    ctx.fillText(i, i * rectW + 5, 5);\n  }\n  ctx.restore();\n  ctx.stroke();\n\n  ctx.restore();\n};\n\nexport const renderScene = ({\n  elements,\n  appState,\n  scale,\n  canvas,\n  renderConfig,\n}) => {\n  const context = canvas.getContext(\"2d\");\n\n  context.save();\n  context.scale(scale, scale);\n\n  const normalizedCanvasWidth = canvas.width / scale;\n  const normalizedCanvasHeight = canvas.height / scale;\n  context.clearRect(0, 0, normalizedCanvasWidth, normalizedCanvasHeight);\n\n  // Apply zoom\n  context.save();\n  context.scale(renderConfig.zoom, renderConfig.zoom);\n  drawAxis(context, renderConfig);\n\n  // render element\n  elements.forEach((element) => {\n    renderElement(element, context, renderConfig, appState);\n  });\n  // Reset zoom\n  context.restore();\n\n  context.restore();\n  localStorage.setItem(\"elements\", JSON.stringify(elements));\n  localStorage.setItem(\"appState\", JSON.stringify(appState));\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"tools\":\"index_tools__ZQUTr\",\"item\":\"index_item__JCc41\",\"selected\":\"index_selected__uL6n6\"};","export const createIcon = (d, opts) => {\n  const {\n    width = 512,\n    height = width,\n    mirror,\n    style,\n    ...rest\n  } = typeof opts === \"number\" ? { width: opts } : opts;\n  return (\n    <svg\n      aria-hidden=\"true\"\n      focusable=\"false\"\n      role=\"img\"\n      viewBox={`0 0 ${width} ${height}`}\n      style={style}\n      {...rest}\n    >\n      {typeof d === \"string\" ? <path fill=\"currentColor\" d={d} /> : d}\n    </svg>\n  );\n};\n\nconst tablerIconProps = {\n  width: 24,\n  height: 24,\n  fill: \"none\",\n  strokeWidth: 2,\n  stroke: \"currentColor\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n};\nexport const RectangleIcon = createIcon(\n  <g strokeWidth=\"1.5\">\n    <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" />\n    <rect x=\"4\" y=\"4\" width=\"16\" height=\"16\" rx=\"2\"></rect>\n  </g>,\n  {\n    width: 24,\n    height: 24,\n    fill: \"none\",\n    strokeWidth: 2,\n    stroke: \"currentColor\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n  }\n);\n\nexport const FreedrawIcon = createIcon(\n  <g strokeWidth=\"1.25\">\n    <path\n      clipRule=\"evenodd\"\n      d=\"m7.643 15.69 7.774-7.773a2.357 2.357 0 1 0-3.334-3.334L4.31 12.357a3.333 3.333 0 0 0-.977 2.357v1.953h1.953c.884 0 1.732-.352 2.357-.977Z\"\n    />\n    <path d=\"m11.25 5.417 3.333 3.333\" />\n  </g>,\n  {\n    width: 20,\n    height: 20,\n    fill: \"none\",\n    stroke: \"currentColor\",\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n  }\n);\n\nexport const ExportImageIcon = createIcon(\n  <g strokeWidth=\"1.25\">\n    <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path>\n    <path d=\"M15 8h.01\"></path>\n    <path d=\"M12 20h-5a3 3 0 0 1 -3 -3v-10a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v5\"></path>\n    <path d=\"M4 15l4 -4c.928 -.893 2.072 -.893 3 0l4 4\"></path>\n    <path d=\"M14 14l1 -1c.617 -.593 1.328 -.793 2.009 -.598\"></path>\n    <path d=\"M19 16v6\"></path>\n    <path d=\"M22 19l-3 3l-3 -3\"></path>\n  </g>,\n  tablerIconProps\n);\n\nconst modifiedTablerIconProps = {\n  width: 20,\n  height: 20,\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n};\nexport const ZoomInIcon = createIcon(\n  <path strokeWidth=\"1.25\" d=\"M10 4.167v11.666M4.167 10h11.666\" />,\n  modifiedTablerIconProps\n);\n\nexport const ZoomOutIcon = createIcon(\n  <path d=\"M5 10h10\" strokeWidth=\"1.25\" />,\n  modifiedTablerIconProps\n);\n","import { getCommonBounds, distance } from \"./index\";\nimport { renderScene } from '@/pages/canvas/renderer/renderScene'\nconst getCanvasSize = (elements, exportPadding) => {\n  const [minX, minY, maxX, maxY] = getCommonBounds(elements);\n  const width = distance(minX, maxX) + exportPadding * 2;\n  const height = distance(minY, maxY) + exportPadding + exportPadding;\n\n  return [minX, minY, width, height];\n};\nexport const exportPng = ({ elements, appState }) => {\n  const exportPadding = 10;\n  const [minX, minY, width, height] = getCanvasSize(elements, exportPadding);\n\n  console.log(\"export...\", minX, minY, width, height);\n  const canvas = document.createElement(\"canvas\");\n  canvas.width = width * window.devicePixelRatio;\n  canvas.height = height * window.devicePixelRatio;\n  // const context = canvas.getContext(\"2d\");\n  // context.scale(window.devicePixelRatio, window.devicePixelRatio);\n\n  renderScene({\n    elements,\n    appState: {\n      ...appState,\n      scrollX: -minX + exportPadding,\n      scrollY: -minY + exportPadding,\n    },\n    scale: window.devicePixelRatio,\n    canvas: canvas,\n    renderConfig: {\n      selectionColor: \"#6965db\",\n      scrollX: -minX + exportPadding,\n      scrollY: -minY + exportPadding,\n      viewBackgroundColor: \"#ffffff\",\n      zoom: 1,\n    },\n  });\n  console.log(\"导出\", elements);\n  var a = document.createElement(\"a\");\n  a.href = canvas.toDataURL();\n  a.download = \"canvas.png\";\n  a.click();\n};\n","class Scene {\n  constructor() {\n    const elements = JSON.parse(localStorage.getItem('elements'))\n    this.elements = elements || [];\n  }\n  getElementsIncludingDeleted() {\n    return this.elements;\n  }\n  replaceAllElements(nextElements) {\n    this.elements = nextElements;\n  }\n}\n\nexport const scene = new Scene();\n\nexport default Scene;\n","import React, { memo } from \"react\";\nimport styles from \"./index.module.less\";\nimport { RectangleIcon, FreedrawIcon, ExportImageIcon } from \"../icons\";\nimport { exportPng } from \"@/util/export\";\nimport { scene } from \"../../scene/scene\";\nimport { appState } from \"../../index\";\n\nconst SHAPES = [\n  {\n    type: \"rectangle\",\n    icon: RectangleIcon,\n  },\n  {\n    type: \"freedraw\",\n    icon: FreedrawIcon,\n  },\n];\nconst Index = memo(({ activeTool, onActiveToolChange }) => {\n  return (\n    <div className={styles.tools}>\n      <span\n        className={[styles.item].join(\" \")}\n        onClick={() => {\n          exportPng({\n            elements: scene.getElementsIncludingDeleted(),\n            appState,\n          });\n        }}\n      >\n        {ExportImageIcon}\n      </span>\n      {SHAPES.map((shape) => (\n        <span\n          key={shape.type}\n          className={[\n            styles.item,\n            activeTool.type === shape.type && styles.selected,\n          ].join(\" \")}\n          onClick={() => onActiveToolChange({ type: shape.type })}\n        >\n          {shape.icon}\n        </span>\n      ))}\n    </div>\n  );\n});\n\nexport default Index;\n","// extracted by mini-css-extract-plugin\nexport default {\"scale\":\"index_scale__7GBXS\",\"item\":\"index_item__EjyQO\",\"value\":\"index_value__oZ-q0\"};","import React, { memo } from \"react\";\nimport { ZoomInIcon, ZoomOutIcon } from \"../icons\";\nimport styles from \"./index.module.less\";\n\nconst Scale = memo(() => {\n  return (\n    <div className={styles.scale}>\n      <span className={[styles.item].join(\" \")} onClick={() => {}}>\n        {ZoomOutIcon}\n      </span>\n      <span className={styles.value}>\n        100%\n      </span>\n      <span className={[styles.item].join(\" \")} onClick={() => {}}>\n        {ZoomInIcon}\n      </span>\n    </div>\n  );\n});\n\nexport default Scale;\n","// extracted by mini-css-extract-plugin\nexport default {\"layer\":\"index_layer__JlGve\"};","import React, { memo } from \"react\";\nimport Tools from \"../tools\";\nimport Scale from \"../scale\";\nimport styles from \"./index.module.less\";\nconst LayerUI = memo(({ activeTool, onActiveToolChange }) => {\n  return (\n    <div className={styles.layer}>\n      <Scale />\n      <Tools activeTool={activeTool} onActiveToolChange={onActiveToolChange} />\n    </div>\n  );\n});\n\nexport default LayerUI;\n","// extracted by mini-css-extract-plugin\nexport default {\"textarea\":\"index_textarea__b45r1\",\"textarea_copy\":\"index_textarea_copy__REiTG\"};","import React, {\n  memo,\n  useState,\n  useRef,\n  forwardRef,\n  useImperativeHandle,\n} from \"react\";\nimport { deleteElementCache } from \"../../renderer/renderElement\";\nimport { viewportCoordsToSceneCoords, rgb, getFontString } from \"@/util\";\nimport { newTextElement } from \"../../element/newElement\";\nimport { scene } from \"../../scene/scene\";\nimport { renderScene } from \"../../renderer/renderScene\";\nimport { appState } from \"../../index\";\nimport styles from \"./index.module.less\";\n\nconst Index = forwardRef(({ staticCanvasRef }, ref) => {\n  const textareaRef = useRef(null);\n  const [textareaValue, setTextAreaValue] = useState(\"\");\n  useImperativeHandle(ref, () => ({\n    startEditText: (event) => {\n      event.preventDefault();\n      event.stopPropagation();\n      let { x: sceneX, y: sceneY } = viewportCoordsToSceneCoords(\n        event,\n        appState\n      );\n      const element = newTextElement({\n        x: sceneX,\n        y: sceneY,\n        strokeColor: rgb(),\n        backgroundColor: \"transparent\",\n        fillStyle: \"hachure\",\n        strokeWidth: 1,\n        strokeStyle: \"solid\",\n        text: \"\",\n        fontSize: 20,\n        fontFamily: \"Virgil\", // Helvetica Cascadia\n        textAlign: \"left\",\n        verticalAlign: \"top\",\n      });\n      appState.draggingElement = element;\n      const textarea = textareaRef.current;\n      textarea.focus();\n      const left = event.clientX - appState.offsetLeft;\n      const top = event.clientY - appState.offsetTop;\n      const styleObj = {\n        font: getFontString(element),\n        left: `${left}px`,\n        top: `${top}px`,\n        opacity: 1,\n        color: element.strokeColor,\n        fontSize: element.fontSize,\n      };\n      Object.assign(textarea.style, styleObj);\n      const copyTextarea = document.getElementById(\"copyText\");\n      Object.assign(copyTextarea.style, styleObj);\n      // 输入框限制最大宽度，防止输入的文字超出画布宽度\n      const maxWidth = appState.canvasWidth - left;\n      // textarea.style.maxWidth = `${maxWidth}px`;\n      // textarea.style.width = `${element.fontSize}px`;\n      // textarea.style.height = `${element.fontSize * 1.2}px`;\n      Object.assign(textarea.style, {\n        zIndex: 1,\n        maxWidth: `${maxWidth}px`,\n        width: `${element.fontSize}px`,\n        height: `${element.fontSize * 1.2}px`,\n      });\n    },\n  }));\n  return (\n    <>\n      <textarea\n        onChange={(e) => {\n          let text = e.target.value;\n          // console.log(\"tex5....\", text, text.length);\n          const textarea = textareaRef.current;\n          const maxWidth = parseFloat(textarea.style.maxWidth);\n\n          const copyTextarea = document.getElementById(\"copyText\");\n          copyTextarea.innerText = text;\n          const copyTextWidth = copyTextarea.getBoundingClientRect().width;\n          if (copyTextWidth > maxWidth) {\n            // 正常输入的情况下，两者的差值不会太大，只有粘贴进来的文本才会导致\n            // copy text宽度突然增大\n            if (copyTextWidth - maxWidth < 30) {\n              console.log(\"正常的输入\");\n              text = copyTextarea.innerText =\n                text.slice(0, text.length - 1) +\n                \"\\n\" +\n                text.slice(text.length - 1);\n            } else {\n              console.log(\"粘贴进来的文本\");\n              let lines = text.split(\"\\n\");\n              const splitResult = [];\n              lines.forEach((line) => {\n                copyTextarea.innerText = line;\n                const copyTextWidth =\n                  copyTextarea.getBoundingClientRect().width;\n                if (copyTextWidth <= maxWidth) {\n                  splitResult.push(line);\n                } else {\n                  let lastIdx = 0;\n                  for (let i = 1; i < line.length; i++) {\n                    const str = line.slice(lastIdx, i);\n                    copyTextarea.innerText = str;\n                    const copyTextWidth =\n                      copyTextarea.getBoundingClientRect().width;\n                    if (copyTextWidth > maxWidth) {\n                      splitResult.push(line.slice(lastIdx, i - 1));\n                      lastIdx = i - 1;\n                    } else if (i === line.length - 1) {\n                      splitResult.push(line.slice(lastIdx, i));\n                    }\n                  }\n                }\n              });\n              console.log(\"splitResult..\", splitResult);\n              text = splitResult.join(\"\\n\");\n              copyTextarea.innerText = text;\n            }\n          }\n\n          setTextAreaValue(text);\n          const { width, height } = copyTextarea.getBoundingClientRect();\n          textarea.style.width = `${width + 30}px`;\n          textarea.style.height = `${height}px`;\n\n          appState.draggingElement.text = text;\n        }}\n        onBlur={() => {\n          const element = appState.draggingElement;\n          const textarea = textareaRef.current;\n          const copyTextarea = document.getElementById(\"copyText\");\n          if (element.text) {\n            element.width = copyTextarea.offsetWidth;\n            element.height = copyTextarea.offsetHeight;\n            deleteElementCache(appState.draggingElement);\n            scene.replaceAllElements([\n              ...scene.getElementsIncludingDeleted(),\n              appState.draggingElement,\n            ]);\n            renderScene({\n              elements: scene.getElementsIncludingDeleted(),\n              appState: appState,\n              scale: window.devicePixelRatio,\n              canvas: staticCanvasRef.current,\n              renderConfig: {\n                selectionColor: \"#6965db\",\n                scrollX: appState.scrollX,\n                scrollY: appState.scrollY,\n                viewBackgroundColor: \"#ffffff\",\n                zoom: 1,\n              },\n            });\n            setTimeout(() => {\n              copyTextarea.innerText = \"\";\n              setTextAreaValue(\"\");\n            }, 200);\n          }\n          Object.assign(textarea.style, {\n            left: `0px`,\n            top: `0px`,\n            zIndex: -1,\n            opacity: 0,\n          });\n        }}\n        value={textareaValue}\n        className={styles.textarea}\n        ref={textareaRef}\n      ></textarea>\n      <div\n        style={{ background: \"grey\" }}\n        id=\"copyText\"\n        contentEditable={true}\n        className={[styles.textarea, styles.textarea_copy].join(\" \")}\n      ></div>\n    </>\n  );\n});\n\nexport default memo(Index);\n","import React, { memo, useRef, useEffect, useState } from \"react\";\nimport { viewportCoordsToSceneCoords, distance } from \"./util\";\nimport { withBatchedUpdatesThrottled } from \"@/util\";\nimport { createElement } from \"./element/newElement\";\nimport { renderScene } from \"./renderer/renderScene\";\nimport { deleteElementCache } from \"./renderer/renderElement\";\nimport LayerUI from \"./components/layer-ui\";\nimport TextArea from \"./components/textarea\";\nimport { scene } from \"./scene/scene\";\nimport \"./index.less\";\nconst temp = JSON.parse(localStorage.getItem(\"appState\"));\nexport let appState = temp || {\n  scrollX: 0,\n  scrollY: 0,\n  offsetLeft: 0,\n  offsetTop: 0,\n  draggingElement: null,\n  canvasWidth: 0,\n  canvasHeight: 0,\n};\nconst Canvas = memo(() => {\n  const canvasRef = useRef(null);\n  const canvasContainer = useRef(null);\n  const staticCanvasRef = useRef(null);\n  const textareaRef = useRef(null);\n  const rafRef = useRef(null);\n  const [activeTool, setActiveTool] = useState({ type: \"\" });\n  useEffect(() => {\n    const setCanvasSize = (canvas) => {\n      canvas.width = offsetWidth * window.devicePixelRatio;\n      canvas.height = offsetHeight * window.devicePixelRatio;\n    };\n\n    // canvas分辨率矫正\n    const canvas = canvasRef.current;\n    const { offsetWidth, offsetHeight } = canvas;\n    setCanvasSize(canvas);\n    setCanvasSize(staticCanvasRef.current);\n\n    const { x, y } = canvas.getBoundingClientRect();\n    appState.offsetLeft = x;\n    appState.offsetTop = y;\n    appState.canvasWidth = offsetWidth;\n    appState.canvasHeight = offsetHeight;\n\n    // 绘制静态canvas\n    renderScene({\n      elements: scene.getElementsIncludingDeleted(),\n      appState: appState,\n      scale: window.devicePixelRatio,\n      canvas: staticCanvasRef.current,\n      renderConfig: {\n        selectionColor: \"#6965db\",\n        scrollX: appState.scrollX,\n        scrollY: appState.scrollY,\n        viewBackgroundColor: \"#ffffff\",\n        zoom: 1,\n      },\n    });\n  }, []);\n  useEffect(() => {\n    const wrap = canvasContainer.current;\n    const handleWheel = (e) => {\n      e.preventDefault();\n    };\n    // 防止双指滑动时切换页面\n    wrap.addEventListener(\"wheel\", handleWheel, {\n      passive: false,\n    });\n    return () => {\n      wrap.removeEventListener(\"wheel\", handleWheel);\n    };\n  }, []);\n  useEffect(() => {\n    let frame = 0;\n    let startTime = Date.now();\n\n    const loop = () => {\n      const currentTime = Date.now();\n      frame++;\n\n      if (currentTime > 1000 + startTime) {\n        const fps = Math.round((frame * 1000) / (currentTime - startTime));\n        rafRef.current.innerText = `FPS：${fps}`;\n        frame = 0;\n        startTime = currentTime;\n      }\n\n      requestAnimationFrame(loop);\n    };\n\n    loop();\n  }, []);\n  const handleCanvasWheel = (event) => {\n    const { deltaX, deltaY } = event;\n    appState.scrollX = appState.scrollX - deltaX;\n    appState.scrollY = appState.scrollY - deltaY;\n\n    // 在滚动画布的过程中，只绘制底层的canvas\n    renderScene({\n      elements: scene.getElementsIncludingDeleted(),\n      appState: appState,\n      scale: window.devicePixelRatio,\n      canvas: staticCanvasRef.current,\n      renderConfig: {\n        selectionColor: \"#6965db\",\n        scrollX: appState.scrollX,\n        scrollY: appState.scrollY,\n        viewBackgroundColor: \"#ffffff\",\n        zoom: 1,\n      },\n    });\n  };\n\n  const handleCanvasPointerDown = (event) => {\n    if (!activeTool.type) return;\n    const pointerDownState = initialPointerDownState(event);\n    const element = createElement({\n      elementType: activeTool.type,\n      pointerDownState,\n      appState,\n    });\n    appState.draggingElement = element;\n    deleteElementCache(element);\n    const onPointerMove =\n      onPointerMoveFromCanvasPointerDownHandler(pointerDownState);\n    const onPointerUp =\n      onPointerUpFromCanvasPointerDownHandler(pointerDownState);\n    window.addEventListener(\"pointermove\", onPointerMove);\n    window.addEventListener(\"pointerup\", onPointerUp);\n    pointerDownState.eventListeners.onMove = onPointerMove;\n    pointerDownState.eventListeners.onUp = onPointerUp;\n  };\n\n  const onPointerMoveFromCanvasPointerDownHandler = (pointerDownState) =>\n    withBatchedUpdatesThrottled((event) => {\n      const pointerCoords = viewportCoordsToSceneCoords(event, appState);\n      pointerDownState.lastCoords.x = pointerCoords.x;\n      pointerDownState.lastCoords.y = pointerCoords.y;\n      if (activeTool.type === \"freedraw\") {\n        appState.draggingElement.points.push([\n          pointerCoords.x,\n          pointerCoords.y,\n        ]);\n      } else {\n        const pointerCoords = pointerDownState.lastCoords;\n        const originX = pointerDownState.origin.x;\n        const originY = pointerDownState.origin.y;\n        const x = pointerCoords.x;\n        const y = pointerCoords.y;\n        const width = distance(pointerDownState.origin.x, pointerCoords.x);\n        const height = distance(pointerDownState.origin.y, pointerCoords.y);\n        let newX = x < originX ? originX - width : originX;\n        let newY = y < originY ? originY - height : originY;\n        appState.draggingElement.x = newX;\n        appState.draggingElement.y = newY;\n        appState.draggingElement.width = width;\n        appState.draggingElement.height = height;\n      }\n      deleteElementCache(appState.draggingElement);\n      // 在移动过程中，先在顶层canvas绘制\n      renderScene({\n        elements: [appState.draggingElement],\n        appState: appState,\n        scale: window.devicePixelRatio,\n        canvas: canvasRef.current,\n        renderConfig: {\n          selectionColor: \"#6965db\",\n          scrollX: appState.scrollX,\n          scrollY: appState.scrollY,\n          viewBackgroundColor: \"#ffffff\",\n          zoom: 1,\n        },\n      });\n    });\n\n  const onPointerUpFromCanvasPointerDownHandler =\n    (pointerDownState) => (event) => {\n      // deleteElementCache(appState.draggingElement);\n      scene.replaceAllElements([\n        ...scene.getElementsIncludingDeleted(),\n        appState.draggingElement,\n      ]);\n      console.log(\"pointer up appState...\", appState);\n\n      // 鼠标抬起后，先清空顶层的cavans\n      const canvas = canvasRef.current;\n      const context = canvas.getContext(\"2d\");\n      context.clearRect(0, 0, canvas.width, canvas.height);\n      // 重绘底层canvas\n      renderScene({\n        elements: scene.getElementsIncludingDeleted(),\n        appState: appState,\n        scale: window.devicePixelRatio,\n        canvas: staticCanvasRef.current,\n        renderConfig: {\n          selectionColor: \"#6965db\",\n          scrollX: appState.scrollX,\n          scrollY: appState.scrollY,\n          viewBackgroundColor: \"#ffffff\",\n          zoom: 1,\n        },\n      });\n      window.removeEventListener(\n        \"pointermove\",\n        pointerDownState.eventListeners.onMove\n      );\n      window.removeEventListener(\n        \"pointerup\",\n        pointerDownState.eventListeners.onUp\n      );\n    };\n\n  const initialPointerDownState = (event) => {\n    const origin = viewportCoordsToSceneCoords(event, appState);\n    return {\n      origin,\n      lastCoords: { ...origin },\n      eventListeners: {\n        onMove: null,\n        onUp: null,\n        onKeyUp: null,\n        onKeyDown: null,\n      },\n    };\n  };\n\n  const handleCanvasDoubleClick = (event) => {\n    // 创建新的文本元素\n    textareaRef.current.startEditText(event);\n  };\n  return (\n    <div ref={canvasContainer}>\n      {/* <div className=\"refer\">\n        参照物\n      </div> */}\n      <div className=\"container wrap\">\n        <canvas ref={staticCanvasRef} className=\"canvas\">\n          静态canvas\n        </canvas>\n        <canvas\n          ref={canvasRef}\n          className=\"canvas draw\"\n          onWheel={handleCanvasWheel}\n          onPointerDown={handleCanvasPointerDown}\n          onDoubleClick={handleCanvasDoubleClick}\n        >\n          动态canvas\n        </canvas>\n        <LayerUI\n          activeTool={activeTool}\n          onActiveToolChange={(value) => {\n            setActiveTool(value);\n          }}\n        />\n        <TextArea ref={textareaRef} staticCanvasRef={staticCanvasRef} />\n      </div>\n      <div ref={rafRef}>FPS：--</div>\n      <div id=\"placeholder\"></div>\n    </div>\n  );\n});\n\nexport default Canvas;\n","import { unstable_batchedUpdates } from \"react-dom\";\n\nexport const sceneCoordsToViewportCoords = (\n  { sceneX, sceneY },\n  { offsetLeft, offsetTop, scrollX, scrollY }\n) => {\n  const x = sceneX + scrollX + offsetLeft;\n  const y = sceneY + scrollY + offsetTop;\n  return { x, y };\n};\nexport const viewportCoordsToSceneCoords = (\n  { clientX, clientY },\n  { offsetLeft, offsetTop, scrollX, scrollY }\n) => {\n  const x = clientX - offsetLeft - scrollX;\n  const y = clientY - offsetTop - scrollY;\n  return { x, y };\n};\n\n//rgb颜色随机\nexport const rgb = () => {\n  const r = Math.floor(Math.random() * 256);\n  const g = Math.floor(Math.random() * 256);\n  const b = Math.floor(Math.random() * 256);\n  return `rgb(${r},${g},${b})`;\n};\n\nexport const throttleRAF = (fn, opts) => {\n  let timerId = null;\n  let lastArgs = null;\n  let lastArgsTrailing = null;\n\n  const scheduleFunc = (args) => {\n    timerId = window.requestAnimationFrame(() => {\n      timerId = null;\n      fn(...args);\n      lastArgs = null;\n      if (lastArgsTrailing) {\n        lastArgs = lastArgsTrailing;\n        lastArgsTrailing = null;\n        scheduleFunc(lastArgs);\n      }\n    });\n  };\n\n  const ret = (...args) => {\n    if (process.env.NODE_ENV === \"test\") {\n      fn(...args);\n      return;\n    }\n    lastArgs = args;\n    if (timerId === null) {\n      scheduleFunc(lastArgs);\n    } else if (opts?.trailing) {\n      lastArgsTrailing = args;\n    }\n  };\n  ret.flush = () => {\n    if (timerId !== null) {\n      cancelAnimationFrame(timerId);\n      timerId = null;\n    }\n    if (lastArgs) {\n      fn(...(lastArgsTrailing || lastArgs));\n      lastArgs = lastArgsTrailing = null;\n    }\n  };\n  ret.cancel = () => {\n    lastArgs = lastArgsTrailing = null;\n    if (timerId !== null) {\n      cancelAnimationFrame(timerId);\n      timerId = null;\n    }\n  };\n  return ret;\n};\nexport const withBatchedUpdatesThrottled = (func) => {\n  return throttleRAF((event) => {\n    unstable_batchedUpdates(func, event);\n  });\n};\n\nexport const getBoundsFromPoints = (element) => {\n  let minX = Infinity;\n  let minY = Infinity;\n  let maxX = -Infinity;\n  let maxY = -Infinity;\n  let points = element.points;\n  if (element.type === \"freedraw\") {\n    points = element.points.map((p) => {\n      return [p[0] - element.x, p[1] - element.y];\n    });\n  }\n  for (const [x, y] of points) {\n    minX = Math.min(minX, x);\n    minY = Math.min(minY, y);\n    maxX = Math.max(maxX, x);\n    maxY = Math.max(maxY, y);\n  }\n\n  return [minX, minY, maxX, maxY];\n};\n\nexport const rotate = (x1, y1, x2, y2, angle) =>\n  // 𝑎′𝑥=(𝑎𝑥−𝑐𝑥)cos𝜃−(𝑎𝑦−𝑐𝑦)sin𝜃+𝑐𝑥\n  // 𝑎′𝑦=(𝑎𝑥−𝑐𝑥)sin𝜃+(𝑎𝑦−𝑐𝑦)cos𝜃+𝑐𝑦.\n  // https://math.stackexchange.com/questions/2204520/how-do-i-rotate-a-line-segment-in-a-specific-point-on-the-line\n  [\n    (x1 - x2) * Math.cos(angle) - (y1 - y2) * Math.sin(angle) + x2,\n    (x1 - x2) * Math.sin(angle) + (y1 - y2) * Math.cos(angle) + y2,\n  ];\n\nexport const getElementBounds = (element) => {\n  let bounds;\n\n  const [x1, y1, x2, y2, cx, cy] = getElementAbsoluteCoords(element);\n\n  if (element.type === \"freedraw\") {\n    const [minX, minY, maxX, maxY] = getBoundsFromPoints(element);\n\n    return [\n      minX + element.x,\n      minY + element.y,\n      maxX + element.x,\n      maxY + element.y,\n    ];\n  } else {\n    const [x11, y11] = rotate(x1, y1, cx, cy, element.angle);\n    const [x12, y12] = rotate(x1, y2, cx, cy, element.angle);\n    const [x22, y22] = rotate(x2, y2, cx, cy, element.angle);\n    const [x21, y21] = rotate(x2, y1, cx, cy, element.angle);\n    const minX = Math.min(x11, x12, x22, x21);\n    const minY = Math.min(y11, y12, y22, y21);\n    const maxX = Math.max(x11, x12, x22, x21);\n    const maxY = Math.max(y11, y12, y22, y21);\n    bounds = [minX, minY, maxX, maxY];\n  }\n\n  return bounds;\n};\nexport const getCommonBounds = (elements) => {\n  if (!elements.length) {\n    return [0, 0, 0, 0];\n  }\n\n  let minX = Infinity;\n  let maxX = -Infinity;\n  let minY = Infinity;\n  let maxY = -Infinity;\n\n  elements.forEach((element) => {\n    const [x1, y1, x2, y2] = getElementBounds(element);\n    minX = Math.min(minX, x1);\n    minY = Math.min(minY, y1);\n    maxX = Math.max(maxX, x2);\n    maxY = Math.max(maxY, y2);\n  });\n\n  return [minX, minY, maxX, maxY];\n};\nexport const getElementAbsoluteCoords = (element) => {\n  if (element.type === \"freedraw\") {\n    const [minX, minY, maxX, maxY] = getBoundsFromPoints(element);\n    const x1 = minX + element.x;\n    const y1 = minY + element.y;\n    const x2 = maxX + element.x;\n    const y2 = maxY + element.y;\n    return [x1, y1, x2, y2, (x1 + x2) / 2, (y1 + y2) / 2];\n  }\n  return [\n    element.x,\n    element.y,\n    element.x + element.width,\n    element.y + element.height,\n    element.x + element.width / 2,\n    element.y + element.height / 2,\n  ];\n};\n\nexport const distance = (x, y) => Math.abs(x - y);\n\nexport const getSizeFromPoints = (points) => {\n  const xs = points.map((point) => point[0]);\n  const ys = points.map((point) => point[1]);\n  return {\n    width: Math.max(...xs) - Math.min(...xs),\n    height: Math.max(...ys) - Math.min(...ys),\n  };\n};\n\nlet testIdBase = 0;\nexport const randomId = () => `id${testIdBase++}`;\nexport const randomInteger = () => Math.floor(Math.random() * 2 ** 31);\n\nexport const generateExcalidrawElements = () => {\n  const freeDrawElements =\n    JSON.parse(localStorage.getItem(\"free-draw-elements\")) || [];\n  const result = freeDrawElements.map((ele) => {\n    const points = ele.points.map((p) => {\n      return [p[0] - ele.x, p[1] - ele.y];\n    });\n    const { width, height } = getSizeFromPoints(points);\n    return {\n      id: randomId(),\n      type: \"freedraw\",\n      x: ele.x,\n      y: ele.y,\n      width: width,\n      height: height,\n      angle: 0,\n      strokeColor: ele.strokeStyle,\n      backgroundColor: \"transparent\",\n      fillStyle: \"hachure\",\n      strokeWidth: 1,\n      strokeStyle: \"solid\",\n      roughness: 1,\n      opacity: 100,\n      groupIds: [],\n      roundness: null,\n      seed: randomInteger(),\n      version: 1,\n      versionNonce: 0,\n      isDeleted: false,\n      boundElements: null,\n      updated: Date.now(),\n      link: null,\n      locked: false,\n      points: points,\n      pressures: [],\n      simulatePressure: true,\n      lastCommittedPoint: points[points.length - 1],\n    };\n  });\n  return result;\n};\n\nwindow.__generateExcalidrawElements = generateExcalidrawElements;\n\nexport const getFontString = ({ fontSize, fontFamily }) => {\n  return `${fontSize}px ${fontFamily}, Segoe UI Emoji`;\n};\n"],"names":["viewportCoordsToSceneCoords","clientX","clientY","offsetLeft","offsetTop","x","scrollX","y","scrollY","distance","Math","abs","testIdBase","newElement","type","strokeColor","backgroundColor","fillStyle","strokeWidth","strokeStyle","width","height","angle","points","rest","id","isDeleted","elementWithCanvasCache","WeakMap","deleteElementCache","element","delete","generateElementWithCanvas","renderConfig","zoom","prevElementWithCanvas","get","elementWithCanvas","generateElementCanvas","set","rightContainer","document","getElementById","canvas","createElement","context","getContext","padding","getCanvasPadding","canvasOffsetX","canvasOffsetY","getElementAbsoluteCoords","x1","y1","x2","y2","window","devicePixelRatio","translate","save","scale","drawElementOnCanvas","restore","theme","canvasZoom","globalAlpha","opacity","lineJoin","lineCap","lineWidth","strokeRect","font","getFontString","textAlign","lines","text","split","lineHeight","length","textBaseline","index","fillText","forEach","point","lineTo","moveTo","stroke","drawElementFromCanvas","cx","cy","drawImage","renderScene","elements","appState","normalizedCanvasWidth","normalizedCanvasHeight","clearRect","ctx","rectH","rectW","beginPath","i","drawAxis","renderElement","localStorage","setItem","JSON","stringify","createIcon","d","opts","style","mirror","focusable","role","viewBox","fill","RectangleIcon","rx","strokeLinecap","strokeLinejoin","FreedrawIcon","clipRule","ExportImageIcon","modifiedTablerIconProps","ZoomInIcon","ZoomOutIcon","exportPng","exportPadding","getCommonBounds","minX","minY","maxX","maxY","getCanvasSize","console","log","selectionColor","viewBackgroundColor","a","href","toDataURL","download","click","Scene","parse","getItem","this","nextElements","scene","SHAPES","icon","memo","activeTool","onActiveToolChange","className","styles","join","onClick","getElementsIncludingDeleted","map","shape","Index","forwardRef","ref","staticCanvasRef","textareaRef","useRef","useState","textareaValue","setTextAreaValue","useImperativeHandle","startEditText","event","preventDefault","stopPropagation","sceneX","sceneY","rgb","fontSize","fontFamily","verticalAlign","originalText","draggingElement","textarea","current","focus","left","top","styleObj","color","Object","assign","copyTextarea","maxWidth","canvasWidth","zIndex","onChange","e","target","value","parseFloat","innerText","copyTextWidth","getBoundingClientRect","slice","splitResult","line","push","lastIdx","str","onBlur","offsetWidth","offsetHeight","replaceAllElements","setTimeout","background","contentEditable","canvasHeight","Canvas","canvasRef","canvasContainer","rafRef","setActiveTool","useEffect","setCanvasSize","wrap","handleWheel","addEventListener","passive","removeEventListener","frame","startTime","Date","now","loop","currentTime","fps","round","requestAnimationFrame","onPointerMoveFromCanvasPointerDownHandler","pointerDownState","withBatchedUpdatesThrottled","pointerCoords","lastCoords","originX","origin","originY","newX","newY","onPointerUpFromCanvasPointerDownHandler","eventListeners","onMove","onUp","initialPointerDownState","onKeyUp","onKeyDown","onWheel","deltaX","deltaY","onPointerDown","elementType","currentItemStrokeColor","currentItemBackgroundColor","currentItemFillStyle","currentItemStrokeWidth","onPointerMove","onPointerUp","onDoubleClick","r","floor","random","g","b","func","fn","timerId","lastArgs","lastArgsTrailing","scheduleFunc","args","ret","trailing","flush","cancelAnimationFrame","cancel","throttleRAF","unstable_batchedUpdates","getBoundsFromPoints","Infinity","p","min","max","rotate","cos","sin","x11","y11","x12","y12","x22","y22","x21","y21","getElementBounds","randomId","__generateExcalidrawElements","ele","xs","ys","getSizeFromPoints","roughness","groupIds","roundness","seed","version","versionNonce","boundElements","updated","link","locked","pressures","simulatePressure","lastCommittedPoint"],"sourceRoot":""}